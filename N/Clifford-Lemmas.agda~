{-# OPTIONS --safe #-}
{-# OPTIONS --termination-depth=20 #-}

open import Level using (0‚Ñì)

open import Relation.Binary using (Rel)
open import Relation.Binary.Definitions using (DecidableEquality)
open import Relation.Binary.Morphism.Definitions using (Homomorphic‚ÇÇ)
open import Relation.Binary.PropositionalEquality using (_‚â°_ ; inspect ; setoid ; module ‚â°-Reasoning ; _‚â¢_) renaming ([_] to [_]')
import Relation.Binary.Reasoning.Setoid as SR
import Relation.Binary.PropositionalEquality as Eq
open import Relation.Nullary.Decidable using (yes ; no)


open import Function using (_‚àò_ ; id)
open import Function.Definitions using (Injective)

open import Data.Product using (_√ó_ ; _,_ ; proj‚ÇÅ ; proj‚ÇÇ ; map‚ÇÅ ; ‚àÉ)
open import Data.Product.Relation.Binary.Pointwise.NonDependent as PW using (‚â°√ó‚â°‚áí‚â° ; Pointwise ; ‚â°‚áí‚â°√ó‚â°)
open import Data.Nat hiding (_^_ ; _+_ ; _*_ ; _%_ ; _/_)
open import Data.Nat.DivMod
open import Agda.Builtin.Nat using ()
import Data.Nat as Nat
open import Data.Fin hiding (_+_ ; _-_)
open import Data.Bool
open import Data.List hiding ([_])


open import Data.Maybe
open import Data.Sum using (_‚äé_ ; inj‚ÇÅ ; inj‚ÇÇ ; [_,_])
open import Data.Unit using (‚ä§ ; tt)
open import Data.Empty using (‚ä• ; ‚ä•-elim)

open import Word.Base as WB hiding (wfoldl ; _* ; _^'_)
open import Word.Properties
import Presentation.Base as PB
import Presentation.Properties as PP
open PP using (NFProperty ; NFProperty')
import Presentation.CosetNF as CA
import Presentation.Reidemeister-Schreier as RS
module RSF = RS.Star-Injective-Full.Reidemeister-Schreier-Full
open import Presentation.Tactics

open import Presentation.Construct.Base hiding (_*_)
import Presentation.Construct.Properties.SemiDirectProduct2 as SDP2
import Presentation.Construct.Properties.DirectProduct as DP
import Presentation.Groups.Cyclic as Cyclic


open import Data.Fin.Properties as FP using (suc-injective ; to‚Ñï-inject‚ÇÅ ; to‚Ñï-from‚Ñï)
import Data.Nat.Properties as NP
open import Presentation.GroupLike
open import Data.Nat.Primality
open import Data.Nat.Coprimality hiding (sym)
open import Data.Nat.GCD
open B√©zout
open import Data.Empty
open import Algebra.Properties.Group
open import Zp.ModularArithmetic
open import Zp.Fermats-little-theorem

module N.Clifford-Mod-Scalar
  (p-2 : ‚Ñï)
  (p-prime : Prime (suc (suc p-2)))
  (let open PrimeModulus' p-2 p-prime)
  (g*@(g , g‚â†0) : ‚Ñ§* ‚Çö)
  (g-gen : ‚àÄ ((x , _) : ‚Ñ§* ‚Çö) -> ‚àÉ \ (k : ‚Ñ§ ‚Çö-‚ÇÅ) -> x ‚â° g ^‚Ä≤ to‚Ñï k )
  where


pattern auto = Eq.refl
pattern ‚ÇÄ = zero
pattern ‚ÇÅ = suc ‚ÇÄ
pattern ‚ÇÇ = suc ‚ÇÅ
pattern ‚ÇÉ = suc ‚ÇÇ
pattern ‚ÇÑ = suc ‚ÇÉ

pattern ‚ÇÅ‚Çä n = suc n
pattern ‚ÇÇ‚Çä n = suc (suc n)
pattern ‚ÇÉ‚Çä n = suc (‚ÇÇ‚Çä n)
pattern ‚ÇÑ‚Çä n = suc (‚ÇÉ‚Çä n)

open Primitive-Root-Modp' g* g-gen

module Symplectic-Simplified where

open import N.Symplectic p-2 p-prime as NSym
open Symplectic hiding (_QRel,_===_)

module Clifford-Relations where

  Z : ‚àÄ {n} -> Word (Gen (‚ÇÅ‚Çä n))
  Z = HH ‚Ä¢ S ‚Ä¢ HH ‚Ä¢ S‚Åª¬π
  
  X : ‚àÄ {n} -> Word (Gen (‚ÇÅ‚Çä n))
  X = H ‚Ä¢ S ‚Ä¢ HH ‚Ä¢ S‚Åª¬π ‚Ä¢ H

  ùë† : ‚àÄ {n} -> Word (Gen (‚ÇÅ‚Çä n))
  ùë† = HH ‚Ä¢ S ^ p-1 ‚Ä¢ HH ‚Ä¢ S ^ 2

  Z^ : ‚Ñ§ ‚Çö ->  ‚àÄ {n} -> Word (Gen (‚ÇÅ‚Çä n))
  Z^ k = Z ^ to‚Ñï k

  X^ : ‚Ñ§ ‚Çö ->  ‚àÄ {n} -> Word (Gen (‚ÇÅ‚Çä n))
  X^ k = X ^ to‚Ñï k

  M‚Çã‚ÇÅ : ‚àÄ {n} -> Word (Gen (‚ÇÅ‚Çä n))
  M‚Çã‚ÇÅ = M -'‚ÇÅ

  Mg :  ‚àÄ {n} -> Word (Gen (‚ÇÅ‚Çä n))
  Mg = M g‚Ä≤

  Mg^ : ‚Ñ§ ‚Çö ->  ‚àÄ {n} -> Word (Gen (‚ÇÅ‚Çä n))
  Mg^ k = Mg ^ to‚Ñï k




  infix 4 _QRel,_===_
  data _QRel,_===_ : (n : ‚Ñï) ‚Üí WRel (Gen n) where
  
    order-S :           ‚àÄ {n} ‚Üí (‚ÇÅ‚Çä n) QRel,  S ^ p === Œµ
    order-H :           ‚àÄ {n} ‚Üí (‚ÇÅ‚Çä n) QRel,  H ^ 2 === M‚Çã‚ÇÅ
    M-power : ‚àÄ {n} (k : ‚Ñ§ ‚Çö) ‚Üí (‚ÇÅ‚Çä n) QRel,  Mg^ k === M (g^ k)
    semi-MS :           ‚àÄ {n} ‚Üí (‚ÇÅ‚Çä n) QRel,  Mg ‚Ä¢ S === S^ (g * g) ‚Ä¢ Mg
    comm-HHSHHS :       ‚àÄ {n} ‚Üí (‚ÇÅ‚Çä n) QRel,  H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S === S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H

    semi-M‚ÜëCZ :         ‚àÄ {n} ‚Üí (‚ÇÇ‚Çä n) QRel,  Mg ‚Üë ‚Ä¢ CZ === CZ^ g ‚Ä¢ Mg ‚Üë
    semi-M‚ÜìCZ :         ‚àÄ {n} ‚Üí (‚ÇÇ‚Çä n) QRel,  Mg ‚Üì ‚Ä¢ CZ === CZ^ g ‚Ä¢ Mg ‚Üì

    order-CZ :          ‚àÄ {n} ‚Üí (‚ÇÇ‚Çä n) QRel,  CZ ^ p === Œµ

    comm-CZ-S‚Üì :        ‚àÄ {n} ‚Üí (‚ÇÇ‚Çä n) QRel,  CZ ‚Ä¢ S ‚Üì === S ‚Üì ‚Ä¢ CZ
    comm-CZ-S‚Üë :        ‚àÄ {n} ‚Üí (‚ÇÇ‚Çä n) QRel,  CZ ‚Ä¢ S ‚Üë === S ‚Üë ‚Ä¢ CZ

    selinger-c10 :      ‚àÄ {n} ‚Üí (‚ÇÇ‚Çä n) QRel,  CZ ‚Ä¢ H ‚Üë ‚Ä¢ CZ === S ‚Üë ^ 2 ‚Ä¢ H ‚Üë ‚Ä¢ S ‚Üë ^ 2 ‚Ä¢ CZ ‚Ä¢ H ‚Üë ‚Ä¢ S ‚Üë ^ 2 ‚Ä¢ S ‚Üì ^ 2 ‚Ä¢ X ‚Üë ^ 2 ‚Ä¢ Z ‚Üë ^ 2
    selinger-c11 :      ‚àÄ {n} ‚Üí (‚ÇÇ‚Çä n) QRel,  CZ ‚Ä¢ H ‚Üì ‚Ä¢ CZ === S ‚Üì ^ 2 ‚Ä¢ H ‚Üì ‚Ä¢ S ‚Üì ^ 2 ‚Ä¢ CZ ‚Ä¢ H ‚Üì ‚Ä¢ S ‚Üì ^ 2 ‚Ä¢ S ‚Üë ^ 2 ‚Ä¢ X ‚Üì ^ 2 ‚Ä¢ Z ‚Üì ^ 2

    selinger-c12 :      ‚àÄ {n} ‚Üí (‚ÇÉ‚Çä n) QRel,  CZ ‚Üë ‚Ä¢ CZ === CZ ‚Ä¢ CZ ‚Üë
    selinger-c13 :      ‚àÄ {n} ‚Üí (‚ÇÉ‚Çä n) QRel,  ‚ä§‚ä• ‚Üë ‚Ä¢ CZ ‚Üì ‚Ä¢ ‚ä•‚ä§ ‚Üë === ‚ä•‚ä§ ‚Üì ‚Ä¢ CZ ‚Üë ‚Ä¢ ‚ä§‚ä• ‚Üì
    
    selinger-c14 :      ‚àÄ {n} ‚Üí (‚ÇÉ‚Çä n) QRel,  (‚ä§‚ä• ‚Üë ‚Ä¢ CZ ‚Üì) ^ 3 === Œµ
    selinger-c15 :      ‚àÄ {n} ‚Üí (‚ÇÉ‚Çä n) QRel,  (‚ä•‚ä§ ‚Üì ‚Ä¢ CZ ‚Üë) ^ 3 === Œµ

    comm-H :         ‚àÄ {n}{x} ‚Üí (‚ÇÇ‚Çä n) QRel,  [ x ‚Ü• ] ∑ ‚Ä¢ H === H ‚Ä¢ [ x ‚Ü• ] ∑
    comm-S :         ‚àÄ {n}{x} ‚Üí (‚ÇÇ‚Çä n) QRel,  [ x ‚Ü• ] ∑ ‚Ä¢ S === S ‚Ä¢ [ x ‚Ü• ] ∑
    comm-CZ :        ‚àÄ {n}{x} ‚Üí (‚ÇÉ‚Çä n) QRel,  [ x ‚Ü• ‚Ü• ] ∑ ‚Ä¢ CZ === CZ ‚Ä¢ [ x ‚Ü• ‚Ü• ] ∑
    
    cong‚Üë :         ‚àÄ {n w v} ‚Üí      n QRel,  w === v ‚Üí
                                -------------------------       
                                (‚ÇÅ‚Çä n) QRel,  w ‚Üë === v ‚Üë


module Lemmas-Clifford where

  open Clifford-Relations
  
  lemma-cong‚Üë : ‚àÄ {n} w v ‚Üí
    let open PB (n QRel,_===_) using (_‚âà_) in
    let open PB ((suc n) QRel,_===_) renaming (_‚âà_ to _‚âà‚Üë_) using () in
    w ‚âà v ‚Üí w ‚Üë ‚âà‚Üë v ‚Üë
  lemma-cong‚Üë {n} w v PB.refl = PB.refl
  lemma-cong‚Üë {n} w v (PB.sym eq) = PB.sym (lemma-cong‚Üë v w eq)
  lemma-cong‚Üë {n} w v (PB.trans eq eq‚ÇÅ) = PB.trans (lemma-cong‚Üë _ _ eq) (lemma-cong‚Üë _ _ eq‚ÇÅ)
  lemma-cong‚Üë {n} w v (PB.cong eq eq‚ÇÅ) = PB.cong (lemma-cong‚Üë _ _ eq) (lemma-cong‚Üë _ _ eq‚ÇÅ)
  lemma-cong‚Üë {n} w v PB.assoc = PB.assoc
  lemma-cong‚Üë {n} w v PB.left-unit = PB.left-unit
  lemma-cong‚Üë {n} w v PB.right-unit = PB.right-unit
  lemma-cong‚Üë {n} w v (PB.axiom x) = PB.axiom (cong‚Üë x)


  lemma-^-‚Üë : ‚àÄ {n} (w : Word (Gen n)) k ‚Üí w ‚Üë ^ k ‚â° (w ^ k) ‚Üë
  lemma-^-‚Üë w ‚ÇÄ = auto
  lemma-^-‚Üë w ‚ÇÅ = auto
  lemma-^-‚Üë w (‚ÇÇ‚Çä k) = begin
    (w ‚Üë) ‚Ä¢ (w ‚Üë) ^ ‚ÇÅ‚Çä k ‚â°‚ü® Eq.cong ((w ‚Üë) ‚Ä¢_) (lemma-^-‚Üë w (suc k)) ‚ü©
    (w ‚Üë) ‚Ä¢ (w ^ ‚ÇÅ‚Çä k) ‚Üë ‚â°‚ü® auto ‚ü©
    ((w ‚Ä¢ w ^ ‚ÇÅ‚Çä k) ‚Üë) ‚àé
    where open ‚â°-Reasoning


  lemma-cong‚Üì-S^ : ‚àÄ {n} k -> let open PB ((‚ÇÇ‚Çä n) QRel,_===_) renaming (_‚âà_ to _‚âà‚Üì_) using () in
    (S ^ k) ‚Üì ‚âà‚Üì S ^ k
  lemma-cong‚Üì-S^ {n} ‚ÇÄ = PB.refl
  lemma-cong‚Üì-S^ {n} ‚ÇÅ = PB.refl
  lemma-cong‚Üì-S^ {n} (‚ÇÇ‚Çä k) = PB.cong PB.refl (lemma-cong‚Üì-S^ {n} (‚ÇÅ‚Çä k))

  lemma-cong‚Üë-S^ : ‚àÄ {n} k -> let open PB ((‚ÇÇ‚Çä n) QRel,_===_) renaming (_‚âà_ to _‚âà‚Üë_) using () in
    (S ^ k) ‚Üë ‚âà‚Üë S ‚Üë ^ k
  lemma-cong‚Üë-S^ {n} ‚ÇÄ = PB.refl
  lemma-cong‚Üë-S^ {n} ‚ÇÅ = PB.refl
  lemma-cong‚Üë-S^ {n} (‚ÇÇ‚Çä k) = PB.cong PB.refl (lemma-cong‚Üë-S^ {n} (‚ÇÅ‚Çä k))


  lemma-cong‚Üì-S‚Üì^ : ‚àÄ {n} k -> let open PB ((‚ÇÉ‚Çä n) QRel,_===_) renaming (_‚âà_ to _‚âà‚Üì_) using () in
    (S ‚Üì ^ k) ‚Üì ‚âà‚Üì S ‚Üì ^ k
  lemma-cong‚Üì-S‚Üì^ {n} ‚ÇÄ = PB.refl
  lemma-cong‚Üì-S‚Üì^ {n} ‚ÇÅ = PB.refl
  lemma-cong‚Üì-S‚Üì^ {n} (‚ÇÇ‚Çä k) = PB.cong PB.refl (lemma-cong‚Üì-S‚Üì^ {n} (‚ÇÅ‚Çä k))

  lemma-cong‚Üì-S‚Üë^ : ‚àÄ {n} k -> let open PB ((‚ÇÉ‚Çä n) QRel,_===_) renaming (_‚âà_ to _‚âà‚Üì_) using () in
    ((S ‚Üë) ^ k) ‚Üì ‚âà‚Üì (S ‚Üë) ^ k
  lemma-cong‚Üì-S‚Üë^ {n} ‚ÇÄ = PB.refl
  lemma-cong‚Üì-S‚Üë^ {n} ‚ÇÅ = PB.refl
  lemma-cong‚Üì-S‚Üë^ {n} (‚ÇÇ‚Çä k) = PB.cong PB.refl (lemma-cong‚Üì-S‚Üë^ {n} (‚ÇÅ‚Çä k))


  lemma-cong‚Üì-S^‚Üì : ‚àÄ {n} k -> let open PB ((‚ÇÉ‚Çä n) QRel,_===_) renaming (_‚âà_ to _‚âà‚Üì_) using () in
    (S ^ k) ‚Üì ‚Üì ‚âà‚Üì (S ^ k) ‚Üì
  lemma-cong‚Üì-S^‚Üì {n} ‚ÇÄ = PB.refl
  lemma-cong‚Üì-S^‚Üì {n} ‚ÇÅ = PB.refl
  lemma-cong‚Üì-S^‚Üì {n} (‚ÇÇ‚Çä k) = PB.cong PB.refl (lemma-cong‚Üì-S^‚Üì {n} (‚ÇÅ‚Çä k))

  lemma-cong‚Üì-S^‚Üë : ‚àÄ {n} k -> let open PB ((‚ÇÉ‚Çä n) QRel,_===_) renaming (_‚âà_ to _‚âà‚Üì_) using () in
    (S ^ k) ‚Üë ‚Üì ‚âà‚Üì (S ^ k) ‚Üë
  lemma-cong‚Üì-S^‚Üë {n} ‚ÇÄ = PB.refl
  lemma-cong‚Üì-S^‚Üë {n} ‚ÇÅ = PB.refl
  lemma-cong‚Üì-S^‚Üë {n} (‚ÇÇ‚Çä k) = PB.cong PB.refl (lemma-cong‚Üì-S^‚Üë {n} (‚ÇÅ‚Çä k))

  lemma-cong‚Üì-H^ : ‚àÄ {n} k -> let open PB ((‚ÇÇ‚Çä n) QRel,_===_) renaming (_‚âà_ to _‚âà‚Üì_) using () in
    (H ^ k) ‚Üì ‚âà‚Üì H ^ k
  lemma-cong‚Üì-H^ {n} ‚ÇÄ = PB.refl
  lemma-cong‚Üì-H^ {n} ‚ÇÅ = PB.refl
  lemma-cong‚Üì-H^ {n} (‚ÇÇ‚Çä k) = PB.cong PB.refl (lemma-cong‚Üì-H^ {n} (‚ÇÅ‚Çä k))

  lemma-cong‚Üì-CZ^ : ‚àÄ {n} k -> let open PB ((‚ÇÉ‚Çä n) QRel,_===_) renaming (_‚âà_ to _‚âà‚Üì_) using () in
    (CZ ^ k) ‚Üì ‚âà‚Üì CZ ^ k
  lemma-cong‚Üì-CZ^ {n} ‚ÇÄ = PB.refl
  lemma-cong‚Üì-CZ^ {n} ‚ÇÅ = PB.refl
  lemma-cong‚Üì-CZ^ {n} (‚ÇÇ‚Çä k) = PB.cong PB.refl (lemma-cong‚Üì-CZ^ {n} (‚ÇÅ‚Çä k))

  lemma-‚Üë‚Üì : ‚àÄ {n} (w : Word (Gen n)) ‚Üí w ‚Üë ‚Üì ‚â° w ‚Üì ‚Üë
  lemma-‚Üë‚Üì [ x ] ∑ = auto
  lemma-‚Üë‚Üì Œµ = auto
  lemma-‚Üë‚Üì (w ‚Ä¢ w‚ÇÅ) = Eq.cong‚ÇÇ _‚Ä¢_ (lemma-‚Üë‚Üì w) (lemma-‚Üë‚Üì w‚ÇÅ)

  lemma-‚Üë^ : ‚àÄ {n} k (w : Word (Gen n)) ‚Üí (w ^ k) ‚Üë ‚â° w ‚Üë ^ k
  lemma-‚Üë^ {n} ‚ÇÄ w = auto
  lemma-‚Üë^ {n} ‚ÇÅ w = auto
  lemma-‚Üë^ {n} (‚ÇÇ‚Çä k) w = Eq.cong‚ÇÇ _‚Ä¢_ auto (lemma-‚Üë^ {n} (‚ÇÅ‚Çä k) w)


  lemma-‚Üì^ : ‚àÄ {n} k (w : Word (Gen n)) ‚Üí (w ^ k) ‚Üì ‚â° w ‚Üì ^ k
  lemma-‚Üì^ {n} ‚ÇÄ w = auto
  lemma-‚Üì^ {n} ‚ÇÅ w = auto
  lemma-‚Üì^ {n} (‚ÇÇ‚Çä k) w = Eq.cong‚ÇÇ _‚Ä¢_ auto (lemma-‚Üì^ {n} (‚ÇÅ‚Çä k) w)

  lemma-M‚Üì : ‚àÄ {n} x -> let open PB ((‚ÇÇ‚Çä n) QRel,_===_) renaming (_‚âà_ to _‚âà‚Üì_) using () in
    M x ‚Üì ‚âà‚Üì M x
  lemma-M‚Üì {n} x' = begin
    (S^ x ‚Ä¢ H ‚Ä¢ S^ x‚Åª¬π ‚Ä¢ H ‚Ä¢ S^ x ‚Ä¢ H) ‚Üì ‚âà‚ü® cong (refl' (lemma-‚Üì^ (to‚Ñï x) S)) (cright cong (refl' (lemma-‚Üì^ (to‚Ñï x‚Åª¬π) S)) (cright (cleft refl' (lemma-‚Üì^ (to‚Ñï x) S)))) ‚ü©
    M x' ‚àé
    where
    open PB ((‚ÇÇ‚Çä n) QRel,_===_) renaming (_‚âà_ to _‚âà‚Üì_)
    open PP ((‚ÇÇ‚Çä n) QRel,_===_)
    open SR word-setoid
    x = x' .proj‚ÇÅ
    x‚Åª¬π = ((x' ‚Åª¬π) .proj‚ÇÅ )
    
  lemma-M‚Üë‚Üì : ‚àÄ {n} x -> let open PB ((‚ÇÉ‚Çä n) QRel,_===_) renaming (_‚âà_ to _‚âà‚Üì_) using () in
    M x ‚Üë ‚Üì ‚âà‚Üì M x ‚Üë
  lemma-M‚Üë‚Üì {n} x' = begin
    ((M x' ‚Üë) ‚Üì) ‚â°‚ü® lemma-‚Üë‚Üì (M x') ‚ü©
    ((M x' ‚Üì) ‚Üë) ‚âà‚ü® lemma-cong‚Üë _ _ (lemma-M‚Üì x') ‚ü©
    (M x' ‚Üë) ‚àé
    where
    open PB ((‚ÇÉ‚Çä n) QRel,_===_) renaming (_‚âà_ to _‚âà‚Üì_)
    open PP ((‚ÇÉ‚Çä n) QRel,_===_)
    open SR word-setoid



  lemma-M‚Üì‚Üì : ‚àÄ {n} x -> let open PB ((‚ÇÉ‚Çä n) QRel,_===_) renaming (_‚âà_ to _‚âà‚Üì_) using () in
    M x ‚Üì ‚Üì ‚âà‚Üì M x ‚Üì
  lemma-M‚Üì‚Üì {n} x' = begin
    (S^ x ‚Ä¢ H ‚Ä¢ S^ x‚Åª¬π ‚Ä¢ H ‚Ä¢ S^ x ‚Ä¢ H) ‚Üì ‚Üì ‚â°‚ü® auto ‚ü©
    (S^ x ‚Üì ‚Ä¢ H ‚Ä¢ S^ x‚Åª¬π ‚Üì ‚Ä¢ H ‚Ä¢ S^ x ‚Üì ‚Ä¢ H) ‚Üì ‚â°‚ü® Eq.cong‚ÇÇ (\ xx yy -> (xx ‚Ä¢ H ‚Ä¢ yy ‚Ä¢ H ‚Ä¢ S^ x ‚Üì ‚Ä¢ H) ‚Üì) (lemma-‚Üì^ (to‚Ñï x) S) (lemma-‚Üì^ (to‚Ñï x‚Åª¬π) S) ‚ü©
    (S^ x ‚Ä¢ H ‚Ä¢ S^ x‚Åª¬π ‚Ä¢ H ‚Ä¢ S^ x ‚Üì ‚Ä¢ H) ‚Üì ‚â°‚ü® Eq.cong (\ xx -> (S^ x ‚Ä¢ H ‚Ä¢ S^ x‚Åª¬π ‚Ä¢ H ‚Ä¢ xx ‚Ä¢ H) ‚Üì) (lemma-‚Üì^ (to‚Ñï x) S) ‚ü©
    (S^ x ‚Ä¢ H ‚Ä¢ S^ x‚Åª¬π ‚Ä¢ H ‚Ä¢ S^ x ‚Ä¢ H) ‚Üì ‚â°‚ü® auto ‚ü©
    M x' ‚Üì ‚àé
    where
    open PB ((‚ÇÉ‚Çä n) QRel,_===_) renaming (_‚âà_ to _‚âà‚Üì_)
    open PP ((‚ÇÉ‚Çä n) QRel,_===_)
    open SR word-setoid
    x = x' .proj‚ÇÅ
    x‚Åª¬π = ((x' ‚Åª¬π) .proj‚ÇÅ )


  lemma-comm-S-w‚Üë : ‚àÄ {n} w ‚Üí let open PB ((‚ÇÇ‚Çä n) QRel,_===_) in
    
    S ‚Ä¢ w ‚Üë ‚âà w ‚Üë ‚Ä¢ S
    
  lemma-comm-S-w‚Üë {n} [ x ] ∑ = sym (axiom comm-S)
    where
    open PB ((‚ÇÇ‚Çä n) QRel,_===_)
  lemma-comm-S-w‚Üë {n} Œµ = trans right-unit (sym left-unit)
    where
    open PB ((‚ÇÇ‚Çä n) QRel,_===_)
  lemma-comm-S-w‚Üë {n} (w ‚Ä¢ w‚ÇÅ) = begin
    S ‚Ä¢ ((w ‚Ä¢ w‚ÇÅ) ‚Üë) ‚âà‚ü® refl ‚ü©
    S ‚Ä¢ (w ‚Üë ‚Ä¢ w‚ÇÅ ‚Üë) ‚âà‚ü® sym assoc ‚ü©
    (S ‚Ä¢ w ‚Üë) ‚Ä¢ w‚ÇÅ ‚Üë ‚âà‚ü® cong (lemma-comm-S-w‚Üë w) refl ‚ü©
    (w ‚Üë ‚Ä¢ S) ‚Ä¢ w‚ÇÅ ‚Üë ‚âà‚ü® assoc ‚ü©
    w ‚Üë ‚Ä¢ S ‚Ä¢ w‚ÇÅ ‚Üë ‚âà‚ü® cong refl (lemma-comm-S-w‚Üë w‚ÇÅ) ‚ü©
    w ‚Üë ‚Ä¢ w‚ÇÅ ‚Üë ‚Ä¢ S ‚âà‚ü® sym assoc ‚ü©
    ((w ‚Ä¢ w‚ÇÅ) ‚Üë) ‚Ä¢ S ‚àé
    where
    open PB ((‚ÇÇ‚Çä n) QRel,_===_)
    open PP ((‚ÇÇ‚Çä n) QRel,_===_)
    open SR word-setoid

  lemma-comm-S·µè-w‚Üë : ‚àÄ {n} k w ‚Üí let open PB ((‚ÇÇ‚Çä n) QRel,_===_) in
    
    S ^ k ‚Ä¢ w ‚Üë ‚âà w ‚Üë ‚Ä¢ S ^ k
    
  lemma-comm-S·µè-w‚Üë {n} ‚ÇÄ w = trans left-unit (sym right-unit)
    where
    open PB ((‚ÇÇ‚Çä n) QRel,_===_)
  lemma-comm-S·µè-w‚Üë {n} ‚ÇÅ w = lemma-comm-S-w‚Üë w
    where
    open PB ((‚ÇÇ‚Çä n) QRel,_===_)
  lemma-comm-S·µè-w‚Üë {n} (‚ÇÇ‚Çä k) w = begin
    (S ‚Ä¢ S ^ ‚ÇÅ‚Çä k) ‚Ä¢ (w ‚Üë) ‚âà‚ü® assoc ‚ü©
    S ‚Ä¢ S ^ ‚ÇÅ‚Çä k ‚Ä¢ (w ‚Üë) ‚âà‚ü® cong refl (lemma-comm-S·µè-w‚Üë (‚ÇÅ‚Çä k) w) ‚ü©
    S ‚Ä¢ (w ‚Üë) ‚Ä¢ S ^ ‚ÇÅ‚Çä k ‚âà‚ü® sym assoc ‚ü©
    (S ‚Ä¢ w ‚Üë) ‚Ä¢ S ^ ‚ÇÅ‚Çä k ‚âà‚ü® cong (lemma-comm-S-w‚Üë w) refl ‚ü©
    (w ‚Üë ‚Ä¢ S) ‚Ä¢ S ^ ‚ÇÅ‚Çä k ‚âà‚ü® assoc ‚ü©
    (w ‚Üë) ‚Ä¢ S ‚Ä¢ S ^ ‚ÇÅ‚Çä k ‚àé
    where
    open PB ((‚ÇÇ‚Çä n) QRel,_===_)
    open PP ((‚ÇÇ‚Çä n) QRel,_===_)
    open SR word-setoid


  lemma-comm-H-w‚Üë : ‚àÄ {n} w ‚Üí let open PB ((‚ÇÇ‚Çä n) QRel,_===_) in
    
    H ‚Ä¢ w ‚Üë ‚âà w ‚Üë ‚Ä¢ H
    
  lemma-comm-H-w‚Üë {n} [ x ] ∑ = sym (axiom comm-H)
    where
    open PB ((‚ÇÇ‚Çä n) QRel,_===_)
  lemma-comm-H-w‚Üë {n} Œµ = trans right-unit (sym left-unit)
    where
    open PB ((‚ÇÇ‚Çä n) QRel,_===_)
  lemma-comm-H-w‚Üë {n} (w ‚Ä¢ w‚ÇÅ) = begin
    H ‚Ä¢ ((w ‚Ä¢ w‚ÇÅ) ‚Üë) ‚âà‚ü® refl ‚ü©
    H ‚Ä¢ (w ‚Üë ‚Ä¢ w‚ÇÅ ‚Üë) ‚âà‚ü® sym assoc ‚ü©
    (H ‚Ä¢ w ‚Üë) ‚Ä¢ w‚ÇÅ ‚Üë ‚âà‚ü® cong (lemma-comm-H-w‚Üë w) refl ‚ü©
    (w ‚Üë ‚Ä¢ H) ‚Ä¢ w‚ÇÅ ‚Üë ‚âà‚ü® assoc ‚ü©
    w ‚Üë ‚Ä¢ H ‚Ä¢ w‚ÇÅ ‚Üë ‚âà‚ü® cong refl (lemma-comm-H-w‚Üë w‚ÇÅ) ‚ü©
    w ‚Üë ‚Ä¢ w‚ÇÅ ‚Üë ‚Ä¢ H ‚âà‚ü® sym assoc ‚ü©
    ((w ‚Ä¢ w‚ÇÅ) ‚Üë) ‚Ä¢ H ‚àé
    where
    open PB ((‚ÇÇ‚Çä n) QRel,_===_)
    open PP ((‚ÇÇ‚Çä n) QRel,_===_)
    open SR word-setoid


  lemma-comm-H·µè-w‚Üë : ‚àÄ {n} k w ‚Üí let open PB ((‚ÇÇ‚Çä n) QRel,_===_) in
    
    H ^ k ‚Ä¢ w ‚Üë ‚âà w ‚Üë ‚Ä¢ H ^ k
    
  lemma-comm-H·µè-w‚Üë {n} ‚ÇÄ w = trans left-unit (sym right-unit)
    where
    open PB ((‚ÇÇ‚Çä n) QRel,_===_)
  lemma-comm-H·µè-w‚Üë {n} ‚ÇÅ w = lemma-comm-H-w‚Üë w
    where
    open PB ((‚ÇÇ‚Çä n) QRel,_===_)
  lemma-comm-H·µè-w‚Üë {n} (‚ÇÇ‚Çä k) w = begin
    (H ‚Ä¢ H ^ ‚ÇÅ‚Çä k) ‚Ä¢ (w ‚Üë) ‚âà‚ü® assoc ‚ü©
    H ‚Ä¢ H ^ ‚ÇÅ‚Çä k ‚Ä¢ (w ‚Üë) ‚âà‚ü® cong refl (lemma-comm-H·µè-w‚Üë (‚ÇÅ‚Çä k) w) ‚ü©
    H ‚Ä¢ (w ‚Üë) ‚Ä¢ H ^ ‚ÇÅ‚Çä k ‚âà‚ü® sym assoc ‚ü©
    (H ‚Ä¢ w ‚Üë) ‚Ä¢ H ^ ‚ÇÅ‚Çä k ‚âà‚ü® cong (lemma-comm-H-w‚Üë w) refl ‚ü©
    (w ‚Üë ‚Ä¢ H) ‚Ä¢ H ^ ‚ÇÅ‚Çä k ‚âà‚ü® assoc ‚ü©
    (w ‚Üë) ‚Ä¢ H ‚Ä¢ H ^ ‚ÇÅ‚Çä k ‚àé
    where
    open PB ((‚ÇÇ‚Çä n) QRel,_===_)
    open PP ((‚ÇÇ‚Çä n) QRel,_===_)
    open SR word-setoid


  lemma-comm-CZ-w‚Üë : ‚àÄ {n} w ‚Üí let open PB ((‚ÇÉ‚Çä n) QRel,_===_) in
    
    CZ ‚Ä¢ w ‚Üë ‚Üë ‚âà w ‚Üë ‚Üë ‚Ä¢ CZ
    
  lemma-comm-CZ-w‚Üë {n} [ x ] ∑ = sym (axiom comm-CZ)
    where
    open PB ((‚ÇÉ‚Çä n) QRel,_===_)
  lemma-comm-CZ-w‚Üë {n} Œµ = trans right-unit (sym left-unit)
    where
    open PB ((‚ÇÉ‚Çä n) QRel,_===_)
  lemma-comm-CZ-w‚Üë {n} (w ‚Ä¢ w‚ÇÅ) = begin
    CZ ‚Ä¢ ((w ‚Ä¢ w‚ÇÅ) ‚Üë ‚Üë) ‚âà‚ü® refl ‚ü©
    CZ ‚Ä¢ (w ‚Üë ‚Üë ‚Ä¢ w‚ÇÅ ‚Üë ‚Üë) ‚âà‚ü® sym assoc ‚ü©
    (CZ ‚Ä¢ w ‚Üë ‚Üë) ‚Ä¢ w‚ÇÅ ‚Üë ‚Üë ‚âà‚ü® cong (lemma-comm-CZ-w‚Üë w) refl ‚ü©
    (w ‚Üë ‚Üë ‚Ä¢ CZ) ‚Ä¢ w‚ÇÅ ‚Üë ‚Üë ‚âà‚ü® assoc ‚ü©
    w ‚Üë ‚Üë ‚Ä¢ CZ ‚Ä¢ w‚ÇÅ ‚Üë ‚Üë ‚âà‚ü® cong refl (lemma-comm-CZ-w‚Üë w‚ÇÅ) ‚ü©
    w ‚Üë ‚Üë ‚Ä¢ w‚ÇÅ ‚Üë ‚Üë ‚Ä¢ CZ ‚âà‚ü® sym assoc ‚ü©
    ((w ‚Ä¢ w‚ÇÅ) ‚Üë ‚Üë) ‚Ä¢ CZ ‚àé
    where
    open PB ((‚ÇÉ‚Çä n) QRel,_===_)
    open PP ((‚ÇÉ‚Çä n) QRel,_===_)
    open SR word-setoid

  aux-MM : ‚àÄ {n} -> let open PB ((‚ÇÅ‚Çä n) QRel,_===_) in ‚àÄ {x y : ‚Ñ§ ‚Çö} (nzx : x ‚â¢ ‚ÇÄ) (nzy : y ‚â¢ ‚ÇÄ) -> x ‚â° y -> M (x , nzx) ‚âà M (y , nzy)
  aux-MM {n} {x} {y} nz1 nz2 eq rewrite eq = refl
    where
    open PB ((‚ÇÅ‚Çä n) QRel,_===_)


module Lemmas1 (n : ‚Ñï) where


  open Clifford-Relations

  open PB ((‚ÇÅ‚Çä n) QRel,_===_) hiding (_===_)
  open PP ((‚ÇÅ‚Çä n) QRel,_===_)
  open Pattern-Assoc
  open import Data.Nat.DivMod
  open import Data.Fin.Properties


  aux-M‚â°M : ‚àÄ y y' -> y .proj‚ÇÅ ‚â° y' .proj‚ÇÅ -> M {n = n} y ‚â° M y'
  aux-M‚â°M y y' eq = begin
    M y ‚â°‚ü® auto ‚ü©
    S^ x ‚Ä¢ H ‚Ä¢ S^ x‚Åª¬π ‚Ä¢ H ‚Ä¢ S^ x ‚Ä¢ H ‚â°‚ü® Eq.cong‚ÇÇ (\ xx yy -> S^ xx ‚Ä¢ H ‚Ä¢ S^ yy ‚Ä¢ H ‚Ä¢ S^ x ‚Ä¢ H) eq aux-eq ‚ü©
    S^ x' ‚Ä¢ H ‚Ä¢ S^ x'‚Åª¬π ‚Ä¢ H ‚Ä¢ S^ x ‚Ä¢ H ‚â°‚ü® Eq.cong (\ xx -> S^ x' ‚Ä¢ H ‚Ä¢ S^ x'‚Åª¬π ‚Ä¢ H ‚Ä¢ S^ xx ‚Ä¢ H) eq ‚ü©
    S^ x' ‚Ä¢ H ‚Ä¢ S^ x'‚Åª¬π ‚Ä¢ H ‚Ä¢ S^ x' ‚Ä¢ H ‚â°‚ü® auto ‚ü©
    M y' ‚àé
    where
    open ‚â°-Reasoning
    x = y .proj‚ÇÅ
    x‚Åª¬π = ((y ‚Åª¬π) .proj‚ÇÅ )
    x' = y' .proj‚ÇÅ
    x'‚Åª¬π = ((y' ‚Åª¬π) .proj‚ÇÅ )
    aux-eq : x‚Åª¬π ‚â° x'‚Åª¬π
    aux-eq  = begin
      x‚Åª¬π ‚â°‚ü®  Eq.sym  (*-identity ≥ x‚Åª¬π) ‚ü©
      x‚Åª¬π * ‚ÇÅ ‚â°‚ü® Eq.cong (x‚Åª¬π *_) (Eq.sym (lemma-‚Åª¬π ≥ x' {{nzto‚Ñï {y = x'} {neq0 = y' .proj‚ÇÇ} }})) ‚ü©
      x‚Åª¬π * (x' * x'‚Åª¬π) ‚â°‚ü® Eq.sym (*-assoc x‚Åª¬π x' x'‚Åª¬π) ‚ü©
      (x‚Åª¬π * x') * x'‚Åª¬π ‚â°‚ü® Eq.cong (\ xx -> (x‚Åª¬π * xx) * x'‚Åª¬π) (Eq.sym eq) ‚ü©
      (x‚Åª¬π * x) * x'‚Åª¬π ‚â°‚ü® Eq.cong (_* x'‚Åª¬π) (lemma-‚Åª¬πÀ° x {{nzto‚Ñï {y = x} {neq0 = y .proj‚ÇÇ} }}) ‚ü©
      ‚ÇÅ * x'‚Åª¬π ‚â°‚ü® *-identityÀ° x'‚Åª¬π ‚ü©
      x'‚Åª¬π ‚àé

  lemma-M1 : M‚ÇÅ ‚âà Œµ
  lemma-M1 = begin
    M‚ÇÅ ‚â°‚ü® aux-M‚â°M ((‚ÇÅ , Œª ())) (g^ ‚ÇÄ) auto ‚ü©
    M (g^ ‚ÇÄ) ‚âà‚ü® sym (axiom (M-power ‚ÇÄ)) ‚ü©
    Mg^ ‚ÇÄ ‚âà‚ü® refl ‚ü©
    Œµ ‚àé
    where
    open SR word-setoid

  lemma-order-SH : (S ‚Ä¢ H) ^ 3 ‚âà Œµ
  lemma-order-SH = begin
    (S ‚Ä¢ H) ^ 3 ‚âà‚ü® by-assoc auto ‚ü©
    S ‚Ä¢ H ‚Ä¢ S ‚Ä¢ H ‚Ä¢ S ‚Ä¢ H ‚âà‚ü® (cright (cright cong aux-S refl)) ‚ü©
    S^ x ‚Ä¢ H ‚Ä¢ S^ x‚Åª¬π ‚Ä¢ H ‚Ä¢ S^ x ‚Ä¢ H ‚âà‚ü® refl ‚ü©
    M‚ÇÅ ‚âà‚ü® lemma-M1 ‚ü©
    Œµ ‚àé
    where
    open SR word-setoid
    x' : ‚Ñ§* ‚Çö
    x' = (‚ÇÅ , Œª ())
    x = x' .proj‚ÇÅ
    x‚Åª¬π = ((x' ‚Åª¬π) .proj‚ÇÅ )
    aux-S : S ‚âà S^ x‚Åª¬π
    aux-S = begin
      S ‚âà‚ü® refl ‚ü©
      S^ ‚ÇÅ ‚â°‚ü® Eq.cong S^ (Eq.sym aux‚ÇÅ‚Åª¬π') ‚ü©
      S^ x‚Åª¬π ‚àé


  lemma-S‚Åª¬π : S‚Åª¬π ‚âà S^ ‚Çö‚Çã‚ÇÅ
  lemma-S‚Åª¬π = begin
    S‚Åª¬π ‚âà‚ü® refl ‚ü©
    S ^ p-1 ‚â°‚ü® Eq.cong (S ^_) (Eq.sym lemma-to‚Ñï-‚Çö‚Çã‚ÇÅ) ‚ü©
    S ^ to‚Ñï ‚Çö‚Çã‚ÇÅ ‚âà‚ü® refl ‚ü©
    S^ ‚Çö‚Çã‚ÇÅ ‚àé
    where
    open SR word-setoid




  lemma-MgS^k : ‚àÄ k ->  let g‚Åª¬π = (g‚Ä≤ ‚Åª¬π) .proj‚ÇÅ in let -g‚Åª¬π = - g‚Åª¬π in
    Mg ‚Ä¢ S ^ k ‚âà S ^ (k Nat.* to‚Ñï (g * g)) ‚Ä¢ Mg
  lemma-MgS^k k@0 = trans right-unit (sym left-unit)
  lemma-MgS^k k@1 = begin  
    Mg ‚Ä¢ S ^ k ‚âà‚ü® refl ‚ü©
    Mg ‚Ä¢ S ‚âà‚ü® axiom semi-MS ‚ü©
    S^ (g * g) ‚Ä¢ Mg ‚âà‚ü® refl ‚ü©
    S ^ to‚Ñï (g * g) ‚Ä¢ Mg ‚âà‚ü® (cleft refl' (Eq.cong (S ^_) (Eq.sym ( NP.*-identityÀ° (to‚Ñï (g * g)))))) ‚ü©
    S ^ (k Nat.* to‚Ñï (g * g)) ‚Ä¢ Mg ‚àé
    where
    open SR word-setoid
  lemma-MgS^k k@(‚ÇÇ‚Çä k') = begin  
    Mg ‚Ä¢ S ^ k ‚âà‚ü® refl ‚ü©
    Mg ‚Ä¢ S ‚Ä¢ S ^ ‚ÇÅ‚Çä k' ‚âà‚ü® sym assoc ‚ü©
    (Mg ‚Ä¢ S) ‚Ä¢ S ^ ‚ÇÅ‚Çä k' ‚âà‚ü® (cleft lemma-MgS^k 1 ) ‚ü©
    (S ^ (1 Nat.* to‚Ñï (g * g)) ‚Ä¢ Mg) ‚Ä¢ S ^ ‚ÇÅ‚Çä k' ‚âà‚ü® assoc ‚ü©
    S ^ (1 Nat.* to‚Ñï (g * g)) ‚Ä¢ Mg ‚Ä¢ S ^ ‚ÇÅ‚Çä k' ‚âà‚ü® (cright lemma-MgS^k (‚ÇÅ‚Çä k')) ‚ü©
    S ^ (1 Nat.* to‚Ñï (g * g)) ‚Ä¢ S ^ (‚ÇÅ‚Çä k' Nat.* to‚Ñï (g * g)) ‚Ä¢ Mg ‚âà‚ü® sym assoc ‚ü©
    (S ^ (1 Nat.* to‚Ñï (g * g)) ‚Ä¢ S ^ (‚ÇÅ‚Çä k' Nat.* to‚Ñï (g * g))) ‚Ä¢ Mg ‚âà‚ü® (cleft sym (lemma-^-+ S ((1 Nat.* to‚Ñï (g * g))) ((‚ÇÅ‚Çä k' Nat.* to‚Ñï (g * g))))) ‚ü©
    (S ^ ((1 Nat.* to‚Ñï (g * g)) Nat.+ (‚ÇÅ‚Çä k' Nat.* to‚Ñï (g * g)))) ‚Ä¢ Mg ‚âà‚ü® (cleft refl' (Eq.cong (S ^_) (Eq.sym (NP.*-distrib ≥-+ (to‚Ñï (g * g)) ‚ÇÅ (‚ÇÅ‚Çä k'))))) ‚ü©
    S ^ ((1 Nat.+ ‚ÇÅ‚Çä k') Nat.* to‚Ñï (g * g) ) ‚Ä¢ Mg ‚âà‚ü® refl ‚ü©
    S ^ (k Nat.* to‚Ñï (g * g)) ‚Ä¢ Mg ‚àé
    where
    open SR word-setoid

  lemma-S^k-% : ‚àÄ k -> S ^ k ‚âà S ^ (k % p)
  lemma-S^k-% k = begin
    S ^ k ‚â°‚ü® Eq.cong (S ^_) (m‚â°m%n+[m/n]*n k p) ‚ü©
    S ^ (k Nat.% p Nat.+ k Nat./ p Nat.* p) ‚âà‚ü® lemma-^-+ S (k Nat.% p) (k Nat./ p Nat.* p) ‚ü©
    S ^ (k Nat.% p) ‚Ä¢ S ^ (k Nat./ p Nat.* p) ‚âà‚ü® (cright refl' (Eq.cong (S ^_) (NP.*-comm (k Nat./ p) p))) ‚ü©
    S ^ (k Nat.% p) ‚Ä¢ S ^ (p Nat.* (k Nat./ p)) ‚âà‚ü® sym (cright lemma-^^ S p (k Nat./ p)) ‚ü©
    S ^ (k Nat.% p) ‚Ä¢ (S ^ p) ^ (k Nat./ p) ‚âà‚ü® (cright lemma-^-cong (S ^ p) Œµ (k Nat./ p) (axiom order-S)) ‚ü©
    S ^ (k Nat.% p) ‚Ä¢ (Œµ) ^ (k Nat./ p) ‚âà‚ü® (cright lemma-Œµ^k=Œµ (k Nat./ p)) ‚ü©
    S ^ (k Nat.% p) ‚Ä¢ Œµ ‚âà‚ü® right-unit ‚ü©
    S ^ (k % p) ‚àé
    where
    open SR word-setoid


  lemma-MgS^k' : ‚àÄ k -> let x‚Åª¬π = (g‚Ä≤ ‚Åª¬π) .proj‚ÇÅ in let -x‚Åª¬π = - x‚Åª¬π in
    Mg ‚Ä¢ S^ k ‚âà S^ (k * (g * g)) ‚Ä¢ Mg
  lemma-MgS^k' k = begin 
    Mg ‚Ä¢ S^ k ‚âà‚ü® refl ‚ü©
    Mg ‚Ä¢ S ^ to‚Ñï k ‚âà‚ü® lemma-MgS^k (to‚Ñï k) ‚ü©
    S ^ (to‚Ñï k Nat.* to‚Ñï (g * g)) ‚Ä¢ Mg ‚âà‚ü® (cleft lemma-S^k-% (to‚Ñï k Nat.* to‚Ñï (g * g))) ‚ü©
    S ^ ((to‚Ñï k Nat.* to‚Ñï (g * g)) % p) ‚Ä¢ Mg ‚âà‚ü® (cleft refl' (Eq.cong (S ^_) (lemma-to‚Ñï-% k (g * g)))) ‚ü©
    S ^ to‚Ñï (k * (g * g)) ‚Ä¢ Mg ‚âà‚ü® refl ‚ü©
    S^ (k * (g * g)) ‚Ä¢ Mg ‚àé
    where
    open SR word-setoid
    x‚Åª¬π = (g‚Ä≤ ‚Åª¬π) .proj‚ÇÅ
    -x‚Åª¬π = - x‚Åª¬π

  lemma-Mg^kS : ‚àÄ k -> Mg ^ k ‚Ä¢ S ‚âà S^ ((g * g) ^‚Ä≤ k) ‚Ä¢ Mg ^ k
  lemma-Mg^kS k@0 = trans left-unit (sym right-unit)
  lemma-Mg^kS k@1 = begin
    Mg ^ k ‚Ä¢ S ‚âà‚ü® axiom semi-MS ‚ü©
    S^ ((g * g)) ‚Ä¢ Mg ^ k ‚âà‚ü® (cleft refl' (Eq.cong S^ (Eq.sym (lemma-x^‚Ä≤1=x (from‚Ñï< _))))) ‚ü©
    S^ ((g * g) ^‚Ä≤ k) ‚Ä¢ Mg ^ k ‚àé
    where
    open SR word-setoid
  lemma-Mg^kS k@(‚ÇÇ‚Çä n) = begin
    (Mg ‚Ä¢ Mg ^ ‚ÇÅ‚Çä n) ‚Ä¢ S ‚âà‚ü® assoc ‚ü©
    Mg ‚Ä¢ Mg ^ ‚ÇÅ‚Çä n ‚Ä¢ S ‚âà‚ü® (cright lemma-Mg^kS (‚ÇÅ‚Çä n)) ‚ü©
    Mg ‚Ä¢ S^ ((g * g) ^‚Ä≤ (‚ÇÅ‚Çä n)) ‚Ä¢ Mg ^ (‚ÇÅ‚Çä n) ‚âà‚ü® sym assoc ‚ü©
    (Mg ‚Ä¢ S^ ((g * g) ^‚Ä≤ (‚ÇÅ‚Çä n))) ‚Ä¢ Mg ^ (‚ÇÅ‚Çä n) ‚âà‚ü® (cleft lemma-MgS^k' ((g * g) ^‚Ä≤ (‚ÇÅ‚Çä n))) ‚ü©
    (S^ (((g * g) ^‚Ä≤ (‚ÇÅ‚Çä n)) * (g * g)) ‚Ä¢ Mg) ‚Ä¢ Mg ^ (‚ÇÅ‚Çä n) ‚âà‚ü® refl' (Eq.cong (\ xx -> (S^ xx ‚Ä¢ Mg) ‚Ä¢ Mg ^ (‚ÇÅ‚Çä n)) (*-comm ((g * g) ^‚Ä≤ (‚ÇÅ‚Çä n)) (g * g))) ‚ü©
    (S^ ((g * g) * ((g * g) ^‚Ä≤ (‚ÇÅ‚Çä n))) ‚Ä¢ Mg) ‚Ä¢ Mg ^ (‚ÇÅ‚Çä n) ‚âà‚ü® assoc ‚ü©
    S^ ((g * g) ^‚Ä≤ k) ‚Ä¢ Mg ‚Ä¢ Mg ^ ‚ÇÅ‚Çä n ‚àé
    where
    open SR word-setoid


  lemma-semi-MS : ‚àÄ x -> let x' = x .proj‚ÇÅ in let k = g-gen x .proj‚ÇÅ in M x ‚Ä¢ S ‚âà S^ ((x' * x')) ‚Ä¢ M x
  lemma-semi-MS x = begin
    M x ‚Ä¢ S ‚âà‚ü® (cleft refl' (aux-M‚â°M x (g^ k) (eqk))) ‚ü©
    M (g^ k) ‚Ä¢ S ‚âà‚ü® cong (sym (axiom (M-power (k)))) refl ‚ü©
    Mg^ k ‚Ä¢ S ‚âà‚ü® lemma-Mg^kS (to‚Ñï k) ‚ü©
    S^ ((g * g) ^‚Ä≤ to‚Ñï k) ‚Ä¢ Mg^ k ‚âà‚ü® (cright axiom (M-power (k))) ‚ü©
    S^ ((g * g) ^‚Ä≤ to‚Ñï k) ‚Ä¢ M (g^ k) ‚âà‚ü® (cleft refl' (Eq.cong S^ (*-^‚Ä≤-distrib ≥ g g (to‚Ñï k)))) ‚ü©
    S^ ((g ^‚Ä≤ to‚Ñï k) * (g ^‚Ä≤ to‚Ñï k)) ‚Ä¢ M (g^ k) ‚âà‚ü® sym (cleft refl' (Eq.cong‚ÇÇ (\ xx yy -> S^ (xx * yy)) (eqk) (eqk))) ‚ü©
    S^ (x' * x') ‚Ä¢ M (g^ k) ‚âà‚ü® (cright refl' (aux-M‚â°M (g^ k) x (Eq.sym (eqk)))) ‚ü©
    S^ (x' * x') ‚Ä¢ M x ‚àé
    where
    open SR word-setoid
    x' = x .proj‚ÇÅ
    k = inject‚ÇÅ (g-gen x .proj‚ÇÅ)
    eqk : x .proj‚ÇÅ ‚â° (g^ k) .proj‚ÇÅ
    eqk = Eq.sym (lemma-log-inject x)



  open import Data.Fin.Properties
  
  lemma-Mg^p-1=Œµ : Mg ^ p-1 ‚âà Œµ
  lemma-Mg^p-1=Œµ = begin
    Mg ^ p-1 ‚â°‚ü® Eq.cong (Mg ^_) (Eq.sym (to‚Ñï-from‚Ñï< (NP.n<1+n p-1))) ‚ü©
    Mg^ (from‚Ñï< (NP.n<1+n p-1)) ‚âà‚ü® axiom (M-power (‚ÇÅ‚Çä (from‚Ñï< _))) ‚ü©
    M (g^ p-1') ‚â°‚ü® aux-M‚â°M (g^ p-1') ((g ^‚Ä≤ p-1 , lemma-g^‚Ä≤k‚â†0 p-1)) (Eq.cong (g ^‚Ä≤_) (to‚Ñï-from‚Ñï< (NP.n<1+n p-1))) ‚ü©
    M (g ^‚Ä≤ p-1 , lemma-g^‚Ä≤k‚â†0 p-1) ‚â°‚ü® aux-M‚â°M ((g ^‚Ä≤ p-1 , lemma-g^‚Ä≤k‚â†0 p-1)) (1‚Çö , Œª ()) Zp.Fermats-little-theorem' ‚ü©
    M (1‚Çö , Œª ()) ‚âà‚ü® sym (axiom (M-power ‚ÇÄ)) ‚ü©
    Œµ ‚àé
    where
    open SR word-setoid
    p-1' = from‚Ñï< (NP.n<1+n p-1)

  aux-Mg^[kp-1] : ‚àÄ k -> Mg ^ (k Nat.* p-1) ‚âà Œµ
  aux-Mg^[kp-1] k = begin
    Mg ^ (k Nat.* p-1) ‚âà‚ü® refl' (Eq.cong (Mg ^_) (NP.*-comm k p-1)) ‚ü©
    Mg ^ (p-1 Nat.* k) ‚âà‚ü® sym (lemma-^^ Mg p-1 k) ‚ü©
    (Mg ^ p-1) ^ k ‚âà‚ü® lemma-^-cong (Mg ^ p-1) Œµ k lemma-Mg^p-1=Œµ ‚ü©
    Œµ ^ k ‚âà‚ü® lemma-Œµ^k=Œµ k ‚ü©
    Œµ ‚àé
    where
    open SR word-setoid

  lemma-M-mul : ‚àÄ x y -> M x ‚Ä¢ M y ‚âà M (x *' y)
  lemma-M-mul x y = begin
    M x ‚Ä¢ M y ‚âà‚ü® cong (refl' (aux-M‚â°M x (g^ k) eqk)) (refl' (aux-M‚â°M y (g^ l) eql)) ‚ü©
    M (g^ k) ‚Ä¢ M (g^ l) ‚âà‚ü® cong (sym (axiom (M-power k))) (sym (axiom (M-power l))) ‚ü©
    Mg ^ to‚Ñï k ‚Ä¢ Mg ^ to‚Ñï l ‚âà‚ü® sym (lemma-^-+ Mg (to‚Ñï k) (to‚Ñï l)) ‚ü©
    Mg ^ [k+l] ‚â°‚ü® Eq.cong (Mg ^_) (m‚â°m%n+[m/n]*n [k+l] p-1) ‚ü©
    Mg ^ ([k+l]%p-1 Nat.+ [k+l]/p-1 Nat.* p-1) ‚âà‚ü® lemma-^-+ Mg [k+l]%p-1 (([k+l]/p-1 Nat.* p-1)) ‚ü©
    Mg ^ [k+l]%p-1 ‚Ä¢ Mg ^ ([k+l]/p-1 Nat.* p-1) ‚âà‚ü® (cright trans refl (aux-Mg^[kp-1] [k+l]/p-1)) ‚ü©
    Mg ^ [k+l]%p-1 ‚Ä¢ Œµ ‚âà‚ü® right-unit ‚ü©
    Mg ^ [k+l]%p-1 ‚â°‚ü® Eq.cong (Mg ^_) (Eq.sym (to‚Ñï-from‚Ñï< (m%n<n [k+l] p-1))) ‚ü©
    Mg ^ to‚Ñï ( (from‚Ñï< (m%n<n [k+l] p-1))) ‚â°‚ü® Eq.cong (Mg ^_) (Eq.sym (to‚Ñï-inject‚ÇÅ ((from‚Ñï< (m%n<n [k+l] p-1))))) ‚ü©
    Mg ^ to‚Ñï (inject‚ÇÅ (from‚Ñï< (m%n<n [k+l] p-1))) ‚âà‚ü® refl ‚ü©
    Mg^ (inject‚ÇÅ (from‚Ñï< (m%n<n [k+l] p-1))) ‚âà‚ü® axiom (M-power (inject‚ÇÅ (from‚Ñï< (m%n<n [k+l] p-1)))) ‚ü©
    M (g^ (inject‚ÇÅ (from‚Ñï< (m%n<n [k+l] p-1)))) ‚â°‚ü® aux-M‚â°M (g^ (inject‚ÇÅ (from‚Ñï< (m%n<n [k+l] p-1)))) (g^‚Ä≤ [k+l]) aux-2 ‚ü©
    M (g^‚Ä≤ [k+l]) ‚â°‚ü® aux-M‚â°M (g^‚Ä≤ [k+l]) (g^‚Ä≤ to‚Ñï k *' g^‚Ä≤ to‚Ñï l) aux-1 ‚ü©
    M (g^‚Ä≤ to‚Ñï k *' g^‚Ä≤ to‚Ñï l) ‚â°‚ü® aux-M‚â°M (g^‚Ä≤ to‚Ñï k *' g^‚Ä≤ to‚Ñï l) (x *' y) aux-0 ‚ü©
    M (x *' y) ‚àé
    where
    k = inject‚ÇÅ (g-gen x .proj‚ÇÅ)
    l = inject‚ÇÅ (g-gen y .proj‚ÇÅ)
    eqk : x .proj‚ÇÅ ‚â° (g^ k) .proj‚ÇÅ
    eqk = Eq.sym (lemma-log-inject x)
    eql : y .proj‚ÇÅ ‚â° (g^ l) .proj‚ÇÅ
    eql = Eq.sym (lemma-log-inject y)

    [k+l] = to‚Ñï k Nat.+ to‚Ñï l
    [k+l]%p-1 = [k+l] Nat.% p-1
    [k+l]/p-1 = [k+l] Nat./ p-1

    aux-0 : ((g^‚Ä≤ to‚Ñï k) *' (g^‚Ä≤ to‚Ñï l)) .proj‚ÇÅ ‚â° (x *' y) .proj‚ÇÅ
    aux-0 = begin
      ((g^‚Ä≤ to‚Ñï k) *' (g^‚Ä≤ to‚Ñï l)) .proj‚ÇÅ ‚â°‚ü® auto ‚ü©
      (g^‚Ä≤ to‚Ñï k) .proj‚ÇÅ * (g^‚Ä≤ to‚Ñï l) .proj‚ÇÅ ‚â°‚ü® Eq.cong‚ÇÇ (\ xx yy -> (xx * yy) ) (lemma-log-inject x) (lemma-log-inject y) ‚ü©
      x .proj‚ÇÅ * y .proj‚ÇÅ ‚â°‚ü® auto ‚ü©
      (x *' y) .proj‚ÇÅ ‚àé
      where
      open ‚â°-Reasoning

    aux-1 : (g^‚Ä≤ [k+l]) .proj‚ÇÅ ‚â° ((g^‚Ä≤ to‚Ñï k) *' (g^‚Ä≤ to‚Ñï l)) .proj‚ÇÅ
    aux-1 = begin
      (g^‚Ä≤ [k+l]) .proj‚ÇÅ ‚â°‚ü® auto ‚ü©
      (g ^‚Ä≤ [k+l]) ‚â°‚ü® Eq.sym (+-^‚Ä≤-distrib ≥ g (to‚Ñï k) (to‚Ñï l)) ‚ü©
      ((g ^‚Ä≤ to‚Ñï k) * (g ^‚Ä≤ to‚Ñï l)) ‚â°‚ü® auto ‚ü©
      ((g^‚Ä≤ to‚Ñï k) *' (g^‚Ä≤ to‚Ñï l)) .proj‚ÇÅ ‚àé
      where
      open ‚â°-Reasoning

    aux-2 : g ^‚Ä≤ to‚Ñï (inject‚ÇÅ (from‚Ñï< (m%n<n [k+l] p-1))) ‚â° g ^‚Ä≤ (to‚Ñï k Nat.+ to‚Ñï l)
    aux-2 = begin
      g ^‚Ä≤ to‚Ñï (inject‚ÇÅ (from‚Ñï< (m%n<n [k+l] p-1))) ‚â°‚ü® Eq.cong (g ^‚Ä≤_) (to‚Ñï-inject‚ÇÅ ((from‚Ñï< (m%n<n [k+l] p-1)))) ‚ü©
      g ^‚Ä≤ to‚Ñï ( (from‚Ñï< (m%n<n [k+l] p-1))) ‚â°‚ü® Eq.cong (g ^‚Ä≤_) (to‚Ñï-from‚Ñï< ((m%n<n [k+l] p-1))) ‚ü©
      g ^‚Ä≤ [k+l]%p-1 ‚â°‚ü® Eq.sym (aux-g^‚Ä≤-% [k+l]) ‚ü©
      g ^‚Ä≤ (to‚Ñï k Nat.+ to‚Ñï l) ‚àé
      where
      open ‚â°-Reasoning

    open SR word-setoid


  lemma-M‚Çã‚ÇÅ^2 : M‚Çã‚ÇÅ ^ 2 ‚âà Œµ
  lemma-M‚Çã‚ÇÅ^2 = begin
    M‚Çã‚ÇÅ ^ 2 ‚âà‚ü® lemma-M-mul -'‚ÇÅ -'‚ÇÅ ‚ü©
    M (-'‚ÇÅ *' -'‚ÇÅ) ‚â°‚ü® aux-M‚â°M (-'‚ÇÅ *' -'‚ÇÅ) (‚ÇÅ , (Œª ())) aux-0 ‚ü©
    M‚ÇÅ ‚âà‚ü® sym (sym lemma-M1) ‚ü©
    Œµ ‚àé
    where
    open import Algebra.Properties.Ring (+-*-ring p-2)
    
    aux-0 : (-'‚ÇÅ *' -'‚ÇÅ) .proj‚ÇÅ ‚â° ‚ÇÅ
    aux-0 = begin
      (- ‚ÇÅ * - ‚ÇÅ) ‚â°‚ü® -1*x‚âà-x (- ‚ÇÅ) ‚ü©
      (- - ‚ÇÅ) ‚â°‚ü® -‚Äøinvolutive ‚ÇÅ ‚ü©
      ‚ÇÅ ‚àé
      where
      open ‚â°-Reasoning
    open SR word-setoid

  lemma-order-H : H ^ 4 ‚âà Œµ
  lemma-order-H = begin
    H ^ 4 ‚âà‚ü® sym assoc ‚ü©
    HH ^ 2 ‚âà‚ü® cong (axiom order-H) (axiom order-H) ‚ü©
    M‚Çã‚ÇÅ ^ 2 ‚âà‚ü® lemma-M‚Çã‚ÇÅ^2 ‚ü©
    Œµ ‚àé
    where
    open SR word-setoid


module Clifford-GroupLike where

  private
    variable
      n : ‚Ñï
    
  open Clifford-Relations
  open Lemmas-Clifford


  grouplike : Grouplike (n QRel,_===_)
  grouplike {‚ÇÅ‚Çä n} (H-gen) = (H ) ^ 3 , claim
    where
    open PB ((‚ÇÅ‚Çä n) QRel,_===_)
    open PP ((‚ÇÅ‚Çä n) QRel,_===_)
    open SR word-setoid
    open Lemmas1 n
    claim : (H ) ^ 3 ‚Ä¢ H ‚âà Œµ
    claim = begin
      (H) ^ 3 ‚Ä¢ H ‚âà‚ü® by-assoc auto ‚ü©
      (H) ^ 4 ‚âà‚ü® lemma-order-H ‚ü©
      Œµ ‚àé

  grouplike {‚ÇÅ‚Çä n} (S-gen) = (S) ^ p-1 ,  claim
    where
    open PB ((‚ÇÅ‚Çä n) QRel,_===_)
    open PP ((‚ÇÅ‚Çä n) QRel,_===_)
    open SR word-setoid
    claim : (S) ^ p-1 ‚Ä¢ S ‚âà Œµ
    claim = begin
      (S) ^ p-1 ‚Ä¢ S ‚âà‚ü® sym (lemma-^-+ (S) p-1 1) ‚ü©
      (S) ^ (p-1 Nat.+ 1) ‚â°‚ü® Eq.cong (S ^_) ( NP.+-comm p-1 1) ‚ü©
      (S ^ p) ‚âà‚ü® (axiom order-S) ‚ü©
      (Œµ) ‚àé

  grouplike {‚ÇÇ‚Çä n} (CZ-gen) = (CZ) ^ p-1 ,  claim
    where
    open PB ((‚ÇÇ‚Çä n) QRel,_===_)
    open PP ((‚ÇÇ‚Çä n) QRel,_===_)
    open SR word-setoid
    claim : (CZ) ^ p-1 ‚Ä¢ CZ ‚âà Œµ
    claim = begin
      (CZ) ^ p-1 ‚Ä¢ CZ ‚âà‚ü® sym (lemma-^-+ (CZ) p-1 1) ‚ü©
      (CZ) ^ (p-1 Nat.+ 1) ‚â°‚ü® Eq.cong (CZ ^_) ( NP.+-comm p-1 1) ‚ü©
      (CZ ^ p) ‚âà‚ü® (axiom order-CZ) ‚ü©
      (Œµ) ‚àé

  grouplike {‚ÇÇ‚Çä n} (g ‚Ü•) with grouplike g
  ... | ig , prf = (ig ‚Üë) , lemma-cong‚Üë (ig ‚Ä¢ [ g ] ∑) Œµ prf
    where
    open PB ((‚ÇÇ‚Çä n) QRel,_===_)
    open PP ((‚ÇÇ‚Çä n) QRel,_===_)


module Lemmas1b (n : ‚Ñï) where


  open Clifford-Relations

  open PB ((‚ÇÅ‚Çä n) QRel,_===_) hiding (_===_)
  open PP ((‚ÇÅ‚Çä n) QRel,_===_)
  open Pattern-Assoc
  open Clifford-GroupLike
  open import Data.Nat.DivMod
  open import Data.Fin.Properties

  lemma-[H‚Åª¬πS‚Åª¬π]^3 : (H‚Åª¬π ‚Ä¢ S‚Åª¬π) ^ 3 ‚âà Œµ
  lemma-[H‚Åª¬πS‚Åª¬π]^3 = begin
    (H‚Åª¬π ‚Ä¢ S‚Åª¬π) ^ 3 ‚âà‚ü® _‚âà_.sym assoc ‚ü©
    (H‚Åª¬π ‚Ä¢ S‚Åª¬π) WB.^' 3 ‚âà‚ü® lemma-cong-inv (lemma-order-SH) ‚ü©
    winv Œµ ‚âà‚ü® refl ‚ü©
    Œµ ‚àé
    where
    open Lemmas1 n
    open Group-Lemmas _ _ grouplike renaming (_‚Åª¬π to winv)
    open SR word-setoid

  lemma-[S‚Åª¬πH‚Åª¬π]^3 : (S‚Åª¬π ‚Ä¢ H‚Åª¬π) ^ 3 ‚âà Œµ
  lemma-[S‚Åª¬πH‚Åª¬π]^3 = begin
    (S‚Åª¬π ‚Ä¢ H‚Åª¬π) ^ 3 ‚âà‚ü® sym (trans (cright lemma-left-inverse) right-unit) ‚ü©
    (S‚Åª¬π ‚Ä¢ H‚Åª¬π) ^ 3 ‚Ä¢ (S‚Åª¬π ‚Ä¢ S) ‚âà‚ü® special-assoc ((‚ñ° ‚Ä¢ ‚ñ°) ^ 3 ‚Ä¢ ‚ñ° ‚Ä¢ ‚ñ°) (‚ñ° ‚Ä¢ (‚ñ° ‚Ä¢ ‚ñ°) ^ 3 ‚Ä¢ ‚ñ°) auto ‚ü©
    S‚Åª¬π ‚Ä¢ (H‚Åª¬π ‚Ä¢ S‚Åª¬π) ^ 3 ‚Ä¢ S ‚âà‚ü® cright cleft lemma-[H‚Åª¬πS‚Åª¬π]^3 ‚ü©
    S‚Åª¬π ‚Ä¢ Œµ ‚Ä¢ S ‚âà‚ü® by-assoc auto ‚ü©
    S‚Åª¬π ‚Ä¢ S ‚âà‚ü® lemma-left-inverse ‚ü©
    Œµ ‚àé
    where
    open Group-Lemmas _ _ grouplike renaming (_‚Åª¬π to winv)
    open SR word-setoid
    open Pattern-Assoc

  derived-5 : ‚àÄ x k -> (nz : x ‚â¢ ‚ÇÄ) -> let x‚Åª¬π = ((x , nz) ‚Åª¬π) .proj‚ÇÅ in let -x‚Åª¬π = - x‚Åª¬π in

    M (x , nz) ‚Ä¢ S ^ k ‚âà S ^ (k Nat.* to‚Ñï (x * x)) ‚Ä¢ M (x , nz)
  derived-5 x k@0 nz = trans right-unit (sym left-unit)
  derived-5 x k@1 nz = begin  
    M (x , nz) ‚Ä¢ S ^ k ‚âà‚ü® refl ‚ü©
    M (x , nz) ‚Ä¢ S ‚âà‚ü® lemma-semi-MS (x , nz) ‚ü©
    S^ (x * x) ‚Ä¢ M (x , nz) ‚âà‚ü® refl ‚ü©
    S ^ to‚Ñï (x * x) ‚Ä¢ M (x , nz) ‚âà‚ü® (cleft refl' (Eq.cong (S ^_) (Eq.sym ( NP.*-identityÀ° (to‚Ñï (x * x)))))) ‚ü©
    S ^ (k Nat.* to‚Ñï (x * x)) ‚Ä¢ M (x , nz) ‚àé
    where
    open SR word-setoid
    open Lemmas1 n
  derived-5 x k@(‚ÇÇ‚Çä k') nz = begin  
    M (x , nz) ‚Ä¢ S ^ k ‚âà‚ü® refl ‚ü©
    M (x , nz) ‚Ä¢ S ‚Ä¢ S ^ ‚ÇÅ‚Çä k' ‚âà‚ü® sym assoc ‚ü©
    (M (x , nz) ‚Ä¢ S) ‚Ä¢ S ^ ‚ÇÅ‚Çä k' ‚âà‚ü® (cleft derived-5 x 1 nz) ‚ü©
    (S ^ (1 Nat.* to‚Ñï (x * x)) ‚Ä¢ M (x , nz)) ‚Ä¢ S ^ ‚ÇÅ‚Çä k' ‚âà‚ü® assoc ‚ü©
    S ^ (1 Nat.* to‚Ñï (x * x)) ‚Ä¢ M (x , nz) ‚Ä¢ S ^ ‚ÇÅ‚Çä k' ‚âà‚ü® (cright derived-5 x (‚ÇÅ‚Çä k') nz) ‚ü©
    S ^ (1 Nat.* to‚Ñï (x * x)) ‚Ä¢ S ^ (‚ÇÅ‚Çä k' Nat.* to‚Ñï (x * x)) ‚Ä¢ M (x , nz) ‚âà‚ü® sym assoc ‚ü©
    (S ^ (1 Nat.* to‚Ñï (x * x)) ‚Ä¢ S ^ (‚ÇÅ‚Çä k' Nat.* to‚Ñï (x * x))) ‚Ä¢ M (x , nz) ‚âà‚ü® (cleft sym (lemma-^-+ S ((1 Nat.* to‚Ñï (x * x))) ((‚ÇÅ‚Çä k' Nat.* to‚Ñï (x * x))))) ‚ü©
    (S ^ ((1 Nat.* to‚Ñï (x * x)) Nat.+ (‚ÇÅ‚Çä k' Nat.* to‚Ñï (x * x)))) ‚Ä¢ M (x , nz) ‚âà‚ü® (cleft refl' (Eq.cong (S ^_) (Eq.sym (NP.*-distrib ≥-+ (to‚Ñï (x * x)) ‚ÇÅ (‚ÇÅ‚Çä k'))))) ‚ü©
    S ^ ((1 Nat.+ ‚ÇÅ‚Çä k') Nat.* to‚Ñï (x * x) ) ‚Ä¢ M (x , nz) ‚âà‚ü® refl ‚ü©
    S ^ (k Nat.* to‚Ñï (x * x)) ‚Ä¢ M (x , nz) ‚àé
    where
    open SR word-setoid


  lemma-MS^k : ‚àÄ x k -> (nz : x ‚â¢ ‚ÇÄ) -> let x‚Åª¬π = ((x , nz) ‚Åª¬π) .proj‚ÇÅ in let -x‚Åª¬π = - x‚Åª¬π in
    M (x , nz) ‚Ä¢ S^ k ‚âà S^ (k * (x * x)) ‚Ä¢ M (x , nz)
  lemma-MS^k x k nz = begin 
    M (x , nz) ‚Ä¢ S^ k ‚âà‚ü® refl ‚ü©
    M (x , nz) ‚Ä¢ S ^ to‚Ñï k ‚âà‚ü® derived-5 x (to‚Ñï k) nz ‚ü©
    S ^ (to‚Ñï k Nat.* to‚Ñï (x * x)) ‚Ä¢ M (x , nz) ‚âà‚ü® (cleft lemma-S^k-% (to‚Ñï k Nat.* to‚Ñï (x * x))) ‚ü©
    S ^ ((to‚Ñï k Nat.* to‚Ñï (x * x)) % p) ‚Ä¢ M (x , nz) ‚âà‚ü® (cleft refl' (Eq.cong (S ^_) (lemma-to‚Ñï-% k (x * x)))) ‚ü©
    S ^ to‚Ñï (k * (x * x)) ‚Ä¢ M (x , nz) ‚âà‚ü® refl ‚ü©
    S^ (k * (x * x)) ‚Ä¢ M (x , nz) ‚àé
    where
    open Lemmas1 n    
    open SR word-setoid
    x‚Åª¬π = ((x , nz) ‚Åª¬π) .proj‚ÇÅ
    -x‚Åª¬π = - x‚Åª¬π


  lemma-comm-HHS : H ‚Ä¢ H ‚Ä¢ S ‚âà S ‚Ä¢ H ‚Ä¢ H
  lemma-comm-HHS = begin
    H ‚Ä¢ H ‚Ä¢ S ‚âà‚ü® sym assoc ‚ü©
    HH ‚Ä¢ S ‚âà‚ü® (cleft axiom order-H) ‚ü©
    M‚Çã‚ÇÅ ‚Ä¢ S ‚âà‚ü® lemma-semi-MS -'‚ÇÅ ‚ü©
    S^ (- ‚ÇÅ * - ‚ÇÅ) ‚Ä¢ M‚Çã‚ÇÅ ‚âà‚ü® (cleft refl' (Eq.cong S^ aux-0)) ‚ü©
    S^ ‚ÇÅ ‚Ä¢ M‚Çã‚ÇÅ ‚âà‚ü® refl ‚ü©
    S ‚Ä¢ M‚Çã‚ÇÅ ‚âà‚ü® (cright sym (axiom order-H)) ‚ü©
    S ‚Ä¢ H ‚Ä¢ H ‚àé
    where
    open Lemmas1 n    
    open import Algebra.Properties.Ring (+-*-ring p-2)

    aux-0 : (-'‚ÇÅ *' -'‚ÇÅ) .proj‚ÇÅ ‚â° ‚ÇÅ
    aux-0 = begin
      (- ‚ÇÅ * - ‚ÇÅ) ‚â°‚ü® -1*x‚âà-x (- ‚ÇÅ) ‚ü©
      (- - ‚ÇÅ) ‚â°‚ü® -‚Äøinvolutive ‚ÇÅ ‚ü©
      ‚ÇÅ ‚àé
      where
      open ‚â°-Reasoning
    
    open SR word-setoid



-- ----------------------------------------------------------------------
-- * Data required for applying word tactics to Symplectic generators

module CommData-Sim where
  variable
    n : ‚Ñï

  open Clifford-Relations
  open Lemmas-Clifford
  
  
  -- Commutativity.
  commute : (x y : Gen (‚ÇÇ‚Çä n)) ‚Üí let open PB ((‚ÇÇ‚Çä n) QRel,_===_) in Maybe (([ x ] ∑ ‚Ä¢ [ y ] ∑) ‚âà ([ y ] ∑ ‚Ä¢ [ x ] ∑))
  commute {n} H-gen (y ‚Ü•) = just (PB.sym (PB.axiom comm-H))
  commute {n} (x ‚Ü•) H-gen = just (PB.axiom comm-H)
  commute {n} S-gen (y ‚Ü•) = just (PB.sym (PB.axiom comm-S))
  commute {n} (x ‚Ü•) S-gen = just (PB.axiom comm-S)
  commute {n} S-gen CZ-gen = just (PB.sym (PB.axiom comm-CZ-S‚Üì))
  commute {n} CZ-gen S-gen = just (PB.axiom comm-CZ-S‚Üì)
  commute {n} (S-gen ‚Ü•) CZ-gen = just (PB.sym (PB.axiom comm-CZ-S‚Üë))
  commute {n} CZ-gen (S-gen ‚Ü•) = just (PB.axiom comm-CZ-S‚Üë)
  
  commute {n@(suc n')} CZ-gen (CZ-gen ‚Ü•) = just (PB.sym (PB.axiom selinger-c12))
  commute {n} (CZ-gen ‚Ü•) CZ-gen = just (PB.axiom selinger-c12)
  
  commute {n@(suc n')} CZ-gen ((y ‚Ü•) ‚Ü•) = just (PB.sym (PB.axiom comm-CZ))
  commute {n@(suc n')} ((x ‚Ü•) ‚Ü•) CZ-gen = just (PB.axiom comm-CZ)
  
  commute {n@(suc n')} (x ‚Ü•) (y ‚Ü•) with commute x y
  ... | nothing = nothing
  ... | just eq = just (lemma-cong‚Üë ([ x ] ∑ ‚Ä¢ [ y ] ∑) ([ y ] ∑ ‚Ä¢ [ x ] ∑) eq)

  commute {n} _ _ = nothing


  -- We number the generators for the purpose of ordering them.
  ord : Gen (‚ÇÅ‚Çä n) ‚Üí ‚Ñï
  ord {n}(S-gen) = 0
  ord {n} (H-gen) = 1
  ord {suc n} (CZ-gen) = 2
  ord {suc n} (g ‚Ü•) = 3 Nat.+ ord g


  -- Ordering of generators.
  les : Gen (‚ÇÇ‚Çä n) ‚Üí Gen (‚ÇÇ‚Çä n) ‚Üí Bool
  les x y with ord x Nat.<? ord y
  les x y | yes _ = true
  les x y | no _ = false

module Commuting-Symplectic-Sim (n : ‚Ñï) where
  open Clifford-Relations
  open CommData-Sim hiding (n)
  open Commuting (((‚ÇÇ‚Çä n) QRel,_===_) ) commute les public


module Rewriting-Sim where

  open Rewriting
  open Clifford-Relations
  variable
    n : ‚Ñï

  
  
  step-sym0 : let open PB ((‚ÇÅ‚Çä n) QRel,_===_) hiding (_===_) in Step-Function (Gen (‚ÇÅ‚Çä n))  ((‚ÇÅ‚Çä n) QRel,_===_)

  -- Order of generators.
  step-sym0 {n} ((H-gen) ‚à∑ (H-gen) ‚à∑ (H-gen) ‚à∑ (H-gen) ‚à∑ xs) = just (xs , at-head (lemma-order-H))
    where
    open Lemmas1 n
  step-sym0 {‚ÇÅ‚Çä n} ((H-gen ‚Ü•) ‚à∑ (H-gen ‚Ü•) ‚à∑ (H-gen ‚Ü•) ‚à∑ (H-gen ‚Ü•) ‚à∑ xs) = just (xs , at-head (lemma-cong‚Üë _ _ lemma-order-H))
    where
    open Lemmas1 n
    open Lemmas-Clifford
  step-sym0 {‚ÇÇ‚Çä n} ((H-gen ‚Ü• ‚Ü•) ‚à∑ (H-gen ‚Ü• ‚Ü•) ‚à∑ (H-gen ‚Ü• ‚Ü•) ‚à∑ (H-gen ‚Ü• ‚Ü•) ‚à∑ xs) = just (xs , at-head (lemma-cong‚Üë _ _ (lemma-cong‚Üë _ _ lemma-order-H)))
    where
    open Lemmas1 n
    open Lemmas-Clifford

  step-sym0 {n} ((S-gen) ‚à∑ (H-gen) ‚à∑ (S-gen) ‚à∑ (H-gen) ‚à∑ (S-gen) ‚à∑ (H-gen) ‚à∑ xs) = just (xs , at-head (lemma-order-SH))
    where
    open Lemmas1 n
  step-sym0 {‚ÇÅ‚Çä n} ((S-gen ‚Ü•) ‚à∑ (H-gen ‚Ü•) ‚à∑ (S-gen ‚Ü•) ‚à∑ (H-gen ‚Ü•) ‚à∑ (S-gen ‚Ü•) ‚à∑ (H-gen ‚Ü•) ‚à∑ xs) = just (xs , at-head (lemma-cong‚Üë _ _ lemma-order-SH))
    where
    open Lemmas1 n
    open Lemmas-Clifford
  step-sym0 {‚ÇÇ‚Çä n} ((S-gen ‚Ü• ‚Ü•) ‚à∑ (H-gen ‚Ü• ‚Ü•) ‚à∑ (S-gen ‚Ü• ‚Ü•) ‚à∑ (H-gen ‚Ü• ‚Ü•) ‚à∑ (S-gen ‚Ü• ‚Ü•) ‚à∑ (H-gen ‚Ü• ‚Ü•) ‚à∑ xs) = just (xs , at-head (lemma-cong‚Üë _ _ (lemma-cong‚Üë _ _ lemma-order-SH)))
    where
    open Lemmas1 n
    open Lemmas-Clifford

  -- Commuting of generators.
  step-sym0 ((S-gen) ‚à∑ (CZ-gen) ‚à∑ xs) = just ((CZ-gen) ‚à∑ (S-gen) ‚à∑ xs , at-head (PB.sym (PB.axiom comm-CZ-S‚Üì)))
  step-sym0 ((S-gen ‚Ü•) ‚à∑ (CZ-gen) ‚à∑ xs) = just ((CZ-gen) ‚à∑ (S-gen ‚Ü•) ‚à∑ xs , at-head (PB.sym (PB.axiom comm-CZ-S‚Üë)))
  step-sym0 ((S-gen ‚Ü•) ‚à∑ (CZ-gen ‚Ü•) ‚à∑ xs) = just ((CZ-gen ‚Ü•) ‚à∑ (S-gen ‚Ü•) ‚à∑ xs , at-head (PB.sym (PB.axiom (cong‚Üë comm-CZ-S‚Üì))))
  step-sym0 ((S-gen ‚Ü• ‚Ü•) ‚à∑ (CZ-gen ‚Ü•) ‚à∑ xs) = just ((CZ-gen ‚Ü•) ‚à∑ (S-gen ‚Ü• ‚Ü•) ‚à∑ xs , at-head (PB.sym (PB.axiom (cong‚Üë comm-CZ-S‚Üë))))

  step-sym0 ((H-gen ‚Ü• ‚Ü•) ‚à∑ (CZ-gen) ‚à∑ xs) = just ((CZ-gen) ‚à∑ (H-gen ‚Ü• ‚Ü•) ‚à∑ xs , at-head (PB.axiom comm-CZ))
  step-sym0 ((S-gen ‚Ü• ‚Ü•) ‚à∑ (CZ-gen) ‚à∑ xs) = just ((CZ-gen) ‚à∑ (S-gen ‚Ü• ‚Ü•) ‚à∑ xs , at-head (PB.axiom comm-CZ))

  step-sym0 ((S-gen ‚Ü•) ‚à∑ (S-gen) ‚à∑ xs) = just ((S-gen) ‚à∑ (S-gen ‚Ü•) ‚à∑ xs , at-head ((PB.axiom comm-S)))
  step-sym0 ((S-gen ‚Ü• ‚Ü•) ‚à∑ (S-gen ‚Ü•) ‚à∑ xs) = just ((S-gen ‚Ü•) ‚à∑ (S-gen ‚Ü• ‚Ü•) ‚à∑ xs , at-head ((PB.axiom (cong‚Üë comm-S))))
  step-sym0 ((S-gen ‚Ü• ‚Ü•) ‚à∑ (S-gen) ‚à∑ xs) = just ((S-gen) ‚à∑ (S-gen ‚Ü• ‚Ü•) ‚à∑ xs , at-head (PB.axiom comm-S))
  step-sym0 ((S-gen ‚Ü•) ‚à∑ (H-gen) ‚à∑ xs) = just ((H-gen) ‚à∑ (S-gen ‚Ü•) ‚à∑ xs , at-head ((PB.axiom comm-H)))
  step-sym0 ((S-gen ‚Ü• ‚Ü•) ‚à∑ (H-gen ‚Ü•) ‚à∑ xs) = just ((H-gen ‚Ü•) ‚à∑ (S-gen ‚Ü• ‚Ü•) ‚à∑ xs , at-head ((PB.axiom (cong‚Üë comm-H))))
  step-sym0 ((S-gen ‚Ü• ‚Ü•) ‚à∑ (H-gen) ‚à∑ xs) = just ((H-gen) ‚à∑ (S-gen ‚Ü• ‚Ü•) ‚à∑ xs , at-head (PB.axiom comm-H))
  step-sym0 ((H-gen ‚Ü•) ‚à∑ (H-gen) ‚à∑ xs) = just ((H-gen) ‚à∑ (H-gen ‚Ü•) ‚à∑ xs , at-head ((PB.axiom comm-H)))
  step-sym0 ((H-gen ‚Ü•) ‚à∑ (S-gen) ‚à∑ xs) = just ((S-gen) ‚à∑ (H-gen ‚Ü•) ‚à∑ xs , at-head ((PB.axiom comm-S)))
  step-sym0 ((H-gen ‚Ü• ‚Ü•) ‚à∑ (H-gen ‚Ü•) ‚à∑ xs) = just ((H-gen ‚Ü•) ‚à∑ (H-gen ‚Ü• ‚Ü•) ‚à∑ xs , at-head ((PB.axiom (cong‚Üë comm-H))))
  step-sym0 ((H-gen ‚Ü• ‚Ü•) ‚à∑ (H-gen) ‚à∑ xs) = just ((H-gen) ‚à∑ (H-gen ‚Ü• ‚Ü•) ‚à∑ xs , at-head (PB.axiom comm-H))
  step-sym0 ((H-gen ‚Ü• ‚Ü•) ‚à∑ (S-gen ‚Ü•) ‚à∑ xs) = just ((S-gen ‚Ü•) ‚à∑ (H-gen ‚Ü• ‚Ü•) ‚à∑ xs , at-head ((PB.axiom (cong‚Üë comm-S))))
  step-sym0 ((H-gen ‚Ü• ‚Ü•) ‚à∑ (S-gen) ‚à∑ xs) = just ((S-gen) ‚à∑ (H-gen ‚Ü• ‚Ü•) ‚à∑ xs , at-head (PB.axiom comm-S))

  step-sym0 ((CZ-gen ‚Ü• ‚Ü•) ‚à∑ (H-gen ‚Ü•) ‚à∑ xs) = just ((H-gen ‚Ü•) ‚à∑ (CZ-gen ‚Ü• ‚Ü•) ‚à∑ xs , at-head ((PB.axiom (cong‚Üë comm-H))))
  step-sym0 ((CZ-gen ‚Ü• ‚Ü•) ‚à∑ (H-gen) ‚à∑ xs) = just ((H-gen) ‚à∑ (CZ-gen ‚Ü• ‚Ü•) ‚à∑ xs , at-head (PB.axiom comm-H))
  step-sym0 ((CZ-gen ‚Ü• ‚Ü•) ‚à∑ (S-gen ‚Ü•) ‚à∑ xs) = just ((S-gen ‚Ü•) ‚à∑ (CZ-gen ‚Ü• ‚Ü•) ‚à∑ xs , at-head ((PB.axiom (cong‚Üë comm-S))))
  step-sym0 ((CZ-gen ‚Ü• ‚Ü•) ‚à∑ (S-gen) ‚à∑ xs) = just ((S-gen) ‚à∑ (CZ-gen ‚Ü• ‚Ü•) ‚à∑ xs , at-head (PB.axiom comm-S))

  step-sym0 ((CZ-gen ‚Ü• ‚Ü•) ‚à∑ (CZ-gen) ‚à∑ xs) = just ((CZ-gen) ‚à∑ (CZ-gen ‚Ü• ‚Ü•) ‚à∑ xs , at-head ((PB.axiom comm-CZ)))
  step-sym0 ((CZ-gen ‚Ü•) ‚à∑ (CZ-gen) ‚à∑ xs) = just ((CZ-gen) ‚à∑ (CZ-gen ‚Ü•) ‚à∑ xs , at-head ((PB.axiom selinger-c12)))

  step-sym0 {n} ((S-gen) ‚à∑ (H-gen) ‚à∑ (H-gen) ‚à∑ xs) = just ((H-gen) ‚à∑ (H-gen) ‚à∑ (S-gen) ‚à∑ xs , at-head (PB.sym (lemma-comm-HHS)))
    where
    open Lemmas1b n
    open Lemmas-Clifford
  step-sym0 {‚ÇÅ‚Çä n} ((S-gen ‚Ü•) ‚à∑ (H-gen ‚Ü•) ‚à∑ (H-gen ‚Ü•) ‚à∑ xs) = just ((H-gen ‚Ü•) ‚à∑ (H-gen ‚Ü•) ‚à∑ (S-gen ‚Ü•) ‚à∑ xs , at-head (PB.sym (lemma-cong‚Üë _ _ lemma-comm-HHS)))
    where
    open Lemmas1b n
    open Lemmas-Clifford
  step-sym0 {‚ÇÇ‚Çä n} ((S-gen ‚Ü• ‚Ü•) ‚à∑ (H-gen ‚Ü• ‚Ü•) ‚à∑ (H-gen ‚Ü• ‚Ü•) ‚à∑ xs) = just ((H-gen ‚Ü• ‚Ü•) ‚à∑ (H-gen ‚Ü• ‚Ü•) ‚à∑ (S-gen ‚Ü• ‚Ü•) ‚à∑ xs , at-head (PB.sym (lemma-cong‚Üë _ _ (lemma-cong‚Üë _ _ lemma-comm-HHS))))
    where
    open Lemmas1b n
    open Lemmas-Clifford

  -- Catch-all
  step-sym0 _ = nothing

module Sim-Rewriting (n : ‚Ñï) where
  open Rewriting
  open Rewriting-Sim hiding (n)
  open Rewriting.Step (step-cong (step-sym0 {n})) renaming (general-rewrite to rewrite-sim) public



module Lemmas2 (n : ‚Ñï) where

  open Clifford-Relations
  open Clifford-GroupLike

  open PB ((‚ÇÇ‚Çä n) QRel,_===_) hiding (_===_)
  open PP ((‚ÇÇ‚Çä n) QRel,_===_)
  open Pattern-Assoc
  open import Data.Nat.DivMod
  open import Data.Fin.Properties
  module LL0 = Lemmas1 n
  module LLb0 = Lemmas1b n
  open Lemmas1 (‚ÇÅ‚Çä n)
  open Lemmas1b (‚ÇÅ‚Çä n)


  lemma-CZ^k-% : ‚àÄ k -> CZ ^ k ‚âà CZ ^ (k % p)
  lemma-CZ^k-% k = begin
    CZ ^ k ‚â°‚ü® Eq.cong (CZ ^_) (m‚â°m%n+[m/n]*n k p) ‚ü©
    CZ ^ (k Nat.% p Nat.+ k Nat./ p Nat.* p) ‚âà‚ü® lemma-^-+ CZ (k Nat.% p) (k Nat./ p Nat.* p) ‚ü©
    CZ ^ (k Nat.% p) ‚Ä¢ CZ ^ (k Nat./ p Nat.* p) ‚âà‚ü® (cright refl' (Eq.cong (CZ ^_) (NP.*-comm (k Nat./ p) p))) ‚ü©
    CZ ^ (k Nat.% p) ‚Ä¢ CZ ^ (p Nat.* (k Nat./ p)) ‚âà‚ü® sym (cright lemma-^^ CZ p (k Nat./ p)) ‚ü©
    CZ ^ (k Nat.% p) ‚Ä¢ (CZ ^ p) ^ (k Nat./ p) ‚âà‚ü® (cright lemma-^-cong (CZ ^ p) Œµ (k Nat./ p) (axiom order-CZ)) ‚ü©
    CZ ^ (k Nat.% p) ‚Ä¢ (Œµ) ^ (k Nat./ p) ‚âà‚ü® (cright lemma-Œµ^k=Œµ (k Nat./ p)) ‚ü©
    CZ ^ (k Nat.% p) ‚Ä¢ Œµ ‚âà‚ü® right-unit ‚ü©
    CZ ^ (k % p) ‚àé
    where
    open SR word-setoid


  lemma-Mg‚ÜìCZ^k : ‚àÄ k ->  let g‚Åª¬π = (g‚Ä≤ ‚Åª¬π) .proj‚ÇÅ in let -g‚Åª¬π = - g‚Åª¬π in
    Mg ‚Ä¢ CZ ^ k ‚âà CZ ^ (k Nat.* to‚Ñï g) ‚Ä¢ Mg
  lemma-Mg‚ÜìCZ^k k@0 = trans right-unit (sym left-unit)
  lemma-Mg‚ÜìCZ^k k@1 = begin  
    Mg ‚Ä¢ CZ ^ k ‚âà‚ü® refl ‚ü©
    Mg ‚Ä¢ CZ ‚âà‚ü® axiom semi-M‚ÜìCZ ‚ü©
    CZ^ g ‚Ä¢ Mg ‚âà‚ü® refl ‚ü©
    CZ ^ to‚Ñï g ‚Ä¢ Mg ‚âà‚ü® (cleft refl' (Eq.cong (CZ ^_) (Eq.sym ( NP.*-identityÀ° (to‚Ñï g))))) ‚ü©
    CZ ^ (k Nat.* to‚Ñï g) ‚Ä¢ Mg ‚àé
    where
    open SR word-setoid
  lemma-Mg‚ÜìCZ^k k@(‚ÇÇ‚Çä k') = begin  
    Mg ‚Ä¢ CZ ^ k ‚âà‚ü® refl ‚ü©
    Mg ‚Ä¢ CZ ‚Ä¢ CZ ^ ‚ÇÅ‚Çä k' ‚âà‚ü® sym assoc ‚ü©
    (Mg ‚Ä¢ CZ) ‚Ä¢ CZ ^ ‚ÇÅ‚Çä k' ‚âà‚ü® (cleft lemma-Mg‚ÜìCZ^k 1 ) ‚ü©
    (CZ ^ (1 Nat.* to‚Ñï g) ‚Ä¢ Mg) ‚Ä¢ CZ ^ ‚ÇÅ‚Çä k' ‚âà‚ü® assoc ‚ü©
    CZ ^ (1 Nat.* to‚Ñï g) ‚Ä¢ Mg ‚Ä¢ CZ ^ ‚ÇÅ‚Çä k' ‚âà‚ü® (cright lemma-Mg‚ÜìCZ^k (‚ÇÅ‚Çä k')) ‚ü©
    CZ ^ (1 Nat.* to‚Ñï g) ‚Ä¢ CZ ^ (‚ÇÅ‚Çä k' Nat.* to‚Ñï g) ‚Ä¢ Mg ‚âà‚ü® sym assoc ‚ü©
    (CZ ^ (1 Nat.* to‚Ñï g) ‚Ä¢ CZ ^ (‚ÇÅ‚Çä k' Nat.* to‚Ñï g)) ‚Ä¢ Mg ‚âà‚ü® (cleft sym (lemma-^-+ CZ ((1 Nat.* to‚Ñï g)) ((‚ÇÅ‚Çä k' Nat.* to‚Ñï g)))) ‚ü©
    (CZ ^ ((1 Nat.* to‚Ñï g) Nat.+ (‚ÇÅ‚Çä k' Nat.* to‚Ñï g))) ‚Ä¢ Mg ‚âà‚ü® (cleft refl' (Eq.cong (CZ ^_) (Eq.sym (NP.*-distrib ≥-+ (to‚Ñï g) ‚ÇÅ (‚ÇÅ‚Çä k'))))) ‚ü©
    CZ ^ ((1 Nat.+ ‚ÇÅ‚Çä k') Nat.* to‚Ñï g ) ‚Ä¢ Mg ‚âà‚ü® refl ‚ü©
    CZ ^ (k Nat.* to‚Ñï g) ‚Ä¢ Mg ‚àé
    where
    open SR word-setoid

  lemma-Mg‚ÜìCZ^k' : ‚àÄ k -> let x‚Åª¬π = (g‚Ä≤ ‚Åª¬π) .proj‚ÇÅ in let -x‚Åª¬π = - x‚Åª¬π in
    Mg ‚Ä¢ CZ^ k ‚âà CZ^ (k * g) ‚Ä¢ Mg
  lemma-Mg‚ÜìCZ^k' k = begin 
    Mg ‚Ä¢ CZ^ k ‚âà‚ü® refl ‚ü©
    Mg ‚Ä¢ CZ ^ to‚Ñï k ‚âà‚ü® lemma-Mg‚ÜìCZ^k (to‚Ñï k) ‚ü©
    CZ ^ (to‚Ñï k Nat.* to‚Ñï g) ‚Ä¢ Mg ‚âà‚ü® (cleft lemma-CZ^k-% (to‚Ñï k Nat.* to‚Ñï g)) ‚ü©
    CZ ^ ((to‚Ñï k Nat.* to‚Ñï g) % p) ‚Ä¢ Mg ‚âà‚ü® (cleft refl' (Eq.cong (CZ ^_) (lemma-to‚Ñï-% k g))) ‚ü©
    CZ ^ to‚Ñï (k * g) ‚Ä¢ Mg ‚âà‚ü® refl ‚ü©
    CZ^ (k * g) ‚Ä¢ Mg ‚àé
    where
    open SR word-setoid
    x‚Åª¬π = (g‚Ä≤ ‚Åª¬π) .proj‚ÇÅ
    -x‚Åª¬π = - x‚Åª¬π

  lemma-Mg^kCZ : ‚àÄ k -> Mg ^ k ‚Ä¢ CZ ‚âà CZ^ (g ^‚Ä≤ k) ‚Ä¢ Mg ^ k
  lemma-Mg^kCZ k@0 = trans left-unit (sym right-unit)
  lemma-Mg^kCZ k@1 = begin
    Mg ^ k ‚Ä¢ CZ ‚âà‚ü® axiom semi-M‚ÜìCZ ‚ü©
    CZ^ (g) ‚Ä¢ Mg ^ k ‚âà‚ü® (cleft refl' (Eq.cong CZ^ (Eq.sym (lemma-x^‚Ä≤1=x g)))) ‚ü©
    CZ^ (g ^‚Ä≤ k) ‚Ä¢ Mg ^ k ‚àé
    where
    open SR word-setoid
  lemma-Mg^kCZ k@(‚ÇÇ‚Çä n) = begin
    (Mg ‚Ä¢ Mg ^ ‚ÇÅ‚Çä n) ‚Ä¢ CZ ‚âà‚ü® assoc ‚ü©
    Mg ‚Ä¢ Mg ^ ‚ÇÅ‚Çä n ‚Ä¢ CZ ‚âà‚ü® (cright lemma-Mg^kCZ (‚ÇÅ‚Çä n)) ‚ü©
    Mg ‚Ä¢ CZ^ (g ^‚Ä≤ (‚ÇÅ‚Çä n)) ‚Ä¢ Mg ^ (‚ÇÅ‚Çä n) ‚âà‚ü® sym assoc ‚ü©
    (Mg ‚Ä¢ CZ^ (g ^‚Ä≤ (‚ÇÅ‚Çä n))) ‚Ä¢ Mg ^ (‚ÇÅ‚Çä n) ‚âà‚ü® (cleft lemma-Mg‚ÜìCZ^k' (g ^‚Ä≤ (‚ÇÅ‚Çä n))) ‚ü©
    (CZ^ ((g ^‚Ä≤ (‚ÇÅ‚Çä n)) * g) ‚Ä¢ Mg) ‚Ä¢ Mg ^ (‚ÇÅ‚Çä n) ‚âà‚ü® refl' (Eq.cong (\ xx -> (CZ^ xx ‚Ä¢ Mg) ‚Ä¢ Mg ^ (‚ÇÅ‚Çä n)) (*-comm (g ^‚Ä≤ (‚ÇÅ‚Çä n)) g)) ‚ü©
    (CZ^ (g * (g ^‚Ä≤ (‚ÇÅ‚Çä n))) ‚Ä¢ Mg) ‚Ä¢ Mg ^ (‚ÇÅ‚Çä n) ‚âà‚ü® assoc ‚ü©
    CZ^ (g ^‚Ä≤ k) ‚Ä¢ Mg ‚Ä¢ Mg ^ ‚ÇÅ‚Çä n ‚àé
    where
    open SR word-setoid



  lemma-semi-M‚ÜìCZ : ‚àÄ x -> let x' = x .proj‚ÇÅ in let k = g-gen x .proj‚ÇÅ in M x ‚Ä¢ CZ ‚âà CZ^ x' ‚Ä¢ M x
  lemma-semi-M‚ÜìCZ x = begin
    M x ‚Ä¢ CZ ‚âà‚ü® (cleft refl' (aux-M‚â°M x (g^ k) (eqk))) ‚ü©
    M (g^ k) ‚Ä¢ CZ ‚âà‚ü® cong (sym (axiom (M-power (k)))) refl ‚ü©
    Mg^ k ‚Ä¢ CZ ‚âà‚ü® lemma-Mg^kCZ (to‚Ñï k) ‚ü©
    CZ^ (g ^‚Ä≤ to‚Ñï k) ‚Ä¢ Mg^ k ‚âà‚ü® (cright axiom (M-power (k))) ‚ü©
    CZ^ (g ^‚Ä≤ to‚Ñï k) ‚Ä¢ M (g^ k) ‚âà‚ü® (cleft refl' (Eq.cong CZ^ (Eq.sym eqk))) ‚ü©
    CZ^ (x') ‚Ä¢ M (g^ k) ‚âà‚ü® (cright refl' (aux-M‚â°M (g^ k) x (Eq.sym (eqk)))) ‚ü©
    CZ^ (x') ‚Ä¢ M x ‚àé
    where
    open SR word-setoid
    x' = x .proj‚ÇÅ
    k = inject‚ÇÅ (g-gen x .proj‚ÇÅ)
    eqk : x .proj‚ÇÅ ‚â° (g^ k) .proj‚ÇÅ
    eqk = Eq.sym (lemma-log-inject x)






  lemma-Mg‚ÜëCZ^k : ‚àÄ k ->  let g‚Åª¬π = (g‚Ä≤ ‚Åª¬π) .proj‚ÇÅ in let -g‚Åª¬π = - g‚Åª¬π in
    Mg ‚Üë ‚Ä¢ CZ ^ k ‚âà CZ ^ (k Nat.* to‚Ñï g) ‚Ä¢ Mg ‚Üë
  lemma-Mg‚ÜëCZ^k k@0 = trans right-unit (sym left-unit)
  lemma-Mg‚ÜëCZ^k k@1 = begin  
    Mg ‚Üë ‚Ä¢ CZ ^ k ‚âà‚ü® refl ‚ü©
    Mg ‚Üë ‚Ä¢ CZ ‚âà‚ü® axiom semi-M‚ÜëCZ ‚ü©
    CZ^ g ‚Ä¢ Mg ‚Üë ‚âà‚ü® refl ‚ü©
    CZ ^ to‚Ñï g ‚Ä¢ Mg ‚Üë ‚âà‚ü® (cleft refl' (Eq.cong (CZ ^_) (Eq.sym ( NP.*-identityÀ° (to‚Ñï g))))) ‚ü©
    CZ ^ (k Nat.* to‚Ñï g) ‚Ä¢ Mg ‚Üë ‚àé
    where
    open SR word-setoid
  lemma-Mg‚ÜëCZ^k k@(‚ÇÇ‚Çä k') = begin  
    Mg ‚Üë ‚Ä¢ CZ ^ k ‚âà‚ü® refl ‚ü©
    Mg ‚Üë ‚Ä¢ CZ ‚Ä¢ CZ ^ ‚ÇÅ‚Çä k' ‚âà‚ü® sym assoc ‚ü©
    (Mg ‚Üë ‚Ä¢ CZ) ‚Ä¢ CZ ^ ‚ÇÅ‚Çä k' ‚âà‚ü® (cleft lemma-Mg‚ÜëCZ^k 1 ) ‚ü©
    (CZ ^ (1 Nat.* to‚Ñï g) ‚Ä¢ Mg ‚Üë) ‚Ä¢ CZ ^ ‚ÇÅ‚Çä k' ‚âà‚ü® assoc ‚ü©
    CZ ^ (1 Nat.* to‚Ñï g) ‚Ä¢ Mg ‚Üë ‚Ä¢ CZ ^ ‚ÇÅ‚Çä k' ‚âà‚ü® (cright lemma-Mg‚ÜëCZ^k (‚ÇÅ‚Çä k')) ‚ü©
    CZ ^ (1 Nat.* to‚Ñï g) ‚Ä¢ CZ ^ (‚ÇÅ‚Çä k' Nat.* to‚Ñï g) ‚Ä¢ Mg ‚Üë ‚âà‚ü® sym assoc ‚ü©
    (CZ ^ (1 Nat.* to‚Ñï g) ‚Ä¢ CZ ^ (‚ÇÅ‚Çä k' Nat.* to‚Ñï g)) ‚Ä¢ Mg ‚Üë ‚âà‚ü® (cleft sym (lemma-^-+ CZ ((1 Nat.* to‚Ñï g)) ((‚ÇÅ‚Çä k' Nat.* to‚Ñï g)))) ‚ü©
    (CZ ^ ((1 Nat.* to‚Ñï g) Nat.+ (‚ÇÅ‚Çä k' Nat.* to‚Ñï g))) ‚Ä¢ Mg ‚Üë ‚âà‚ü® (cleft refl' (Eq.cong (CZ ^_) (Eq.sym (NP.*-distrib ≥-+ (to‚Ñï g) ‚ÇÅ (‚ÇÅ‚Çä k'))))) ‚ü©
    CZ ^ ((1 Nat.+ ‚ÇÅ‚Çä k') Nat.* to‚Ñï g ) ‚Ä¢ Mg ‚Üë ‚âà‚ü® refl ‚ü©
    CZ ^ (k Nat.* to‚Ñï g) ‚Ä¢ Mg ‚Üë ‚àé
    where
    open SR word-setoid

  lemma-Mg‚ÜëCZ^k' : ‚àÄ k -> let x‚Åª¬π = (g‚Ä≤ ‚Åª¬π) .proj‚ÇÅ in let -x‚Åª¬π = - x‚Åª¬π in
    Mg ‚Üë ‚Ä¢ CZ^ k ‚âà CZ^ (k * g) ‚Ä¢ Mg ‚Üë
  lemma-Mg‚ÜëCZ^k' k = begin 
    Mg ‚Üë ‚Ä¢ CZ^ k ‚âà‚ü® refl ‚ü©
    Mg ‚Üë ‚Ä¢ CZ ^ to‚Ñï k ‚âà‚ü® lemma-Mg‚ÜëCZ^k (to‚Ñï k) ‚ü©
    CZ ^ (to‚Ñï k Nat.* to‚Ñï g) ‚Ä¢ Mg ‚Üë ‚âà‚ü® (cleft lemma-CZ^k-% (to‚Ñï k Nat.* to‚Ñï g)) ‚ü©
    CZ ^ ((to‚Ñï k Nat.* to‚Ñï g) % p) ‚Ä¢ Mg ‚Üë ‚âà‚ü® (cleft refl' (Eq.cong (CZ ^_) (lemma-to‚Ñï-% k g))) ‚ü©
    CZ ^ to‚Ñï (k * g) ‚Ä¢ Mg ‚Üë ‚âà‚ü® refl ‚ü©
    CZ^ (k * g) ‚Ä¢ Mg ‚Üë ‚àé
    where
    open SR word-setoid
    x‚Åª¬π = (g‚Ä≤ ‚Åª¬π) .proj‚ÇÅ
    -x‚Åª¬π = - x‚Åª¬π

  lemma-Mg^k‚ÜëCZ : ‚àÄ k -> Mg ‚Üë ^ k ‚Ä¢ CZ ‚âà CZ^ (g ^‚Ä≤ k) ‚Ä¢ Mg ‚Üë ^ k
  lemma-Mg^k‚ÜëCZ k@0 = trans left-unit (sym right-unit)
  lemma-Mg^k‚ÜëCZ k@1 = begin
    Mg ‚Üë ^ k ‚Ä¢ CZ ‚âà‚ü® axiom semi-M‚ÜëCZ ‚ü©
    CZ^ (g) ‚Ä¢ Mg ‚Üë ^ k ‚âà‚ü® (cleft refl' (Eq.cong CZ^ (Eq.sym (lemma-x^‚Ä≤1=x g)))) ‚ü©
    CZ^ (g ^‚Ä≤ k) ‚Ä¢ Mg ‚Üë ^ k ‚àé
    where
    open SR word-setoid
  lemma-Mg^k‚ÜëCZ k@(‚ÇÇ‚Çä n) = begin
    (Mg ‚Üë ‚Ä¢ Mg ‚Üë ^ ‚ÇÅ‚Çä n) ‚Ä¢ CZ ‚âà‚ü® assoc ‚ü©
    Mg ‚Üë ‚Ä¢ Mg ‚Üë ^ ‚ÇÅ‚Çä n ‚Ä¢ CZ ‚âà‚ü® (cright lemma-Mg^k‚ÜëCZ (‚ÇÅ‚Çä n)) ‚ü©
    Mg ‚Üë ‚Ä¢ CZ^ (g ^‚Ä≤ (‚ÇÅ‚Çä n)) ‚Ä¢ Mg ‚Üë ^ (‚ÇÅ‚Çä n) ‚âà‚ü® sym assoc ‚ü©
    (Mg ‚Üë ‚Ä¢ CZ^ (g ^‚Ä≤ (‚ÇÅ‚Çä n))) ‚Ä¢ Mg ‚Üë ^ (‚ÇÅ‚Çä n) ‚âà‚ü® (cleft lemma-Mg‚ÜëCZ^k' (g ^‚Ä≤ (‚ÇÅ‚Çä n))) ‚ü©
    (CZ^ ((g ^‚Ä≤ (‚ÇÅ‚Çä n)) * g) ‚Ä¢ Mg ‚Üë) ‚Ä¢ Mg ‚Üë ^ (‚ÇÅ‚Çä n) ‚âà‚ü® refl' (Eq.cong (\ xx -> (CZ^ xx ‚Ä¢ Mg ‚Üë) ‚Ä¢ Mg ‚Üë ^ (‚ÇÅ‚Çä n)) (*-comm (g ^‚Ä≤ (‚ÇÅ‚Çä n)) g)) ‚ü©
    (CZ^ (g * (g ^‚Ä≤ (‚ÇÅ‚Çä n))) ‚Ä¢ Mg ‚Üë) ‚Ä¢ Mg ‚Üë ^ (‚ÇÅ‚Çä n) ‚âà‚ü® assoc ‚ü©
    CZ^ (g ^‚Ä≤ k) ‚Ä¢ Mg ‚Üë ‚Ä¢ Mg ‚Üë ^ ‚ÇÅ‚Çä n ‚àé
    where
    open SR word-setoid



  lemma-semi-M‚ÜëCZ : ‚àÄ x -> let x' = x .proj‚ÇÅ in let k = g-gen x .proj‚ÇÅ in M x ‚Üë ‚Ä¢ CZ ‚âà CZ^ x' ‚Ä¢ M x ‚Üë 
  lemma-semi-M‚ÜëCZ x = begin
    M x ‚Üë ‚Ä¢ CZ ‚âà‚ü® (cleft (lemma-cong‚Üë _ _ ((aux-MM (x .proj‚ÇÇ) (((g^ k) .proj‚ÇÇ))  ( (eqk)))))) ‚ü©
    M (g^ k) ‚Üë ‚Ä¢ CZ ‚âà‚ü® cong (sym (axiom (cong‚Üë (M-power (k))))) refl ‚ü©
    (Mg ^ to‚Ñï k) ‚Üë ‚Ä¢ CZ ‚âà‚ü® (cleft refl' (lemma-‚Üë^ (to‚Ñï k) Mg)) ‚ü©
    Mg ‚Üë ^ to‚Ñï k ‚Ä¢ CZ ‚âà‚ü® lemma-Mg^k‚ÜëCZ (to‚Ñï k) ‚ü©
    CZ^ (g ^‚Ä≤ to‚Ñï k) ‚Ä¢ Mg ‚Üë ^ to‚Ñï k ‚âà‚ü® (cright sym (refl' (lemma-‚Üë^ (to‚Ñï k) Mg))) ‚ü©
    CZ^ (g ^‚Ä≤ to‚Ñï k) ‚Ä¢ (Mg ^ to‚Ñï k) ‚Üë ‚âà‚ü® (cright axiom (cong‚Üë (M-power (k)))) ‚ü©
    CZ^ (g ^‚Ä≤ to‚Ñï k) ‚Ä¢ M (g^ k) ‚Üë ‚âà‚ü® (cleft refl' (Eq.cong CZ^ (Eq.sym eqk))) ‚ü©
    CZ^ (x') ‚Ä¢ M (g^ k) ‚Üë ‚âà‚ü® (cright (lemma-cong‚Üë _ _ ((aux-MM (((g^ k) .proj‚ÇÇ)) (x .proj‚ÇÇ) (Eq.sym (eqk)))))) ‚ü©
    CZ^ (x') ‚Ä¢ M x ‚Üë ‚àé
    where
    open Lemmas-Clifford
    open SR word-setoid
    x' = x .proj‚ÇÅ
    k = inject‚ÇÅ (g-gen x .proj‚ÇÅ)
    eqk : x .proj‚ÇÅ ‚â° (g^ k) .proj‚ÇÅ
    eqk = Eq.sym (lemma-log-inject x)



module Lemmas0b (n : ‚Ñï) where

  open Clifford-Relations
  open Clifford-GroupLike

  open PB ((‚ÇÅ‚Çä n) QRel,_===_) hiding (_===_)
  open PP ((‚ÇÅ‚Çä n) QRel,_===_)
  open Pattern-Assoc
  open import Data.Nat.DivMod
  open import Data.Fin.Properties
  open Lemmas1 n
  open Lemmas1b n


  lemma-S^k+l : ‚àÄ k l -> S^ k ‚Ä¢ S^ l ‚âà S^ (k + l)
  lemma-S^k+l k l = begin
    S^ k ‚Ä¢ S^ l ‚âà‚ü® refl ‚ü©
    S ^ to‚Ñï k ‚Ä¢ S ^ to‚Ñï l ‚âà‚ü® sym (lemma-^-+ S (to‚Ñï k) (to‚Ñï l)) ‚ü©
    S ^ (to‚Ñï k Nat.+ to‚Ñï l) ‚â°‚ü® Eq.cong (S ^_) (m‚â°m%n+[m/n]*n k+l p) ‚ü©
    S ^ (k+l Nat.% p Nat.+ (k+l Nat./ p) Nat.* p) ‚âà‚ü® lemma-^-+ S (k+l Nat.% p) (((k+l Nat./ p) Nat.* p)) ‚ü©
    S ^ (k+l Nat.% p) ‚Ä¢ S ^ ((k+l Nat./ p) Nat.* p) ‚âà‚ü® cong (refl' (Eq.cong (S ^_) (Eq.sym (to‚Ñï-from‚Ñï< (m%n<n k+l p))))) (refl' (Eq.cong (S ^_) (NP.*-comm ((k+l Nat./ p)) p))) ‚ü©
    S ^ to‚Ñï (from‚Ñï< (m%n<n k+l p)) ‚Ä¢ S ^ (p Nat.* (k+l Nat./ p) ) ‚âà‚ü® cong (sym (refl)) (sym (lemma-^^ S p (k+l Nat./ p))) ‚ü©
    S^ (k + l) ‚Ä¢ (S ^ p) ^ (k+l Nat./ p) ‚âà‚ü® cright (lemma-^-cong (S ^ p) Œµ (k+l Nat./ p) (axiom order-S)) ‚ü©
    S^ (k + l) ‚Ä¢ Œµ ^ (k+l Nat./ p) ‚âà‚ü® cright lemma-Œµ^k=Œµ (k+l Nat./ p) ‚ü©
    S^ (k + l) ‚Ä¢ Œµ ‚âà‚ü® right-unit ‚ü©
    S^ (k + l) ‚àé
    where
    k+l = to‚Ñï k Nat.+ to‚Ñï l
    open SR word-setoid


  lemma-S^k-k : ‚àÄ k -> S^ k ‚Ä¢ S^ (- k) ‚âà Œµ
  lemma-S^k-k k = begin
    S^ k ‚Ä¢ S^ (- k) ‚âà‚ü® lemma-S^k+l k (- k) ‚ü©
    S^ (k + - k) ‚â°‚ü® Eq.cong S^ (+-inverse ≥ k) ‚ü©
    S^ ‚ÇÄ ‚âà‚ü® refl ‚ü©
    Œµ ‚àé
    where
    open SR word-setoid
    k-k = to‚Ñï k Nat.+ to‚Ñï (- k)

  lemma-S^-k+k : ‚àÄ k -> S^ (- k) ‚Ä¢ S^ k ‚âà Œµ
  lemma-S^-k+k k = begin
    S^ (- k) ‚Ä¢ S^ k ‚âà‚ü® refl ‚ü©
    S ^ to‚Ñï (- k) ‚Ä¢ S ^ to‚Ñï k ‚âà‚ü® word-comm (to‚Ñï (- k)) (to‚Ñï ( k)) refl ‚ü©
    S ^ to‚Ñï k ‚Ä¢ S ^ to‚Ñï (- k) ‚âà‚ü® refl ‚ü©
    S^ k ‚Ä¢ S^ (- k) ‚âà‚ü® lemma-S^k-k k ‚ü©
    Œµ ‚àé
    where
    open SR word-setoid

  open Eq using (_‚â¢_)



  lemma-HH-M-1 : let -'‚ÇÅ = -' ((‚ÇÅ , Œª ())) in HH ‚âà M -'‚ÇÅ
  lemma-HH-M-1 = begin
    HH ‚âà‚ü® trans (sym right-unit) (cright sym lemma-[S‚Åª¬πH‚Åª¬π]^3) ‚ü©
    HH ‚Ä¢ (S‚Åª¬π ‚Ä¢ H‚Åª¬π) ^ 3 ‚âà‚ü® (cright lemma-^-cong (S‚Åª¬π ‚Ä¢ H‚Åª¬π) (S‚Åª¬π ‚Ä¢ H ‚Ä¢ HH) 3 refl) ‚ü©
    HH ‚Ä¢ (S‚Åª¬π ‚Ä¢ H ‚Ä¢ HH) ^ 3 ‚âà‚ü® refl ‚ü©
    HH ‚Ä¢ (S‚Åª¬π ‚Ä¢ H ‚Ä¢ HH) ‚Ä¢ (S‚Åª¬π ‚Ä¢ H ‚Ä¢ HH) ‚Ä¢ (S‚Åª¬π ‚Ä¢ H ‚Ä¢ HH) ‚âà‚ü® (cright cong (cright sym assoc) (special-assoc (‚ñ° ^ 3 ‚Ä¢ ‚ñ° ^ 3) (‚ñ° ^ 2 ‚Ä¢ ‚ñ° ^ 2 ‚Ä¢ ‚ñ° ^ 2) auto)) ‚ü©
    HH ‚Ä¢ (S‚Åª¬π ‚Ä¢ HH ‚Ä¢ H) ‚Ä¢ (S‚Åª¬π ‚Ä¢ H) ‚Ä¢ (HH ‚Ä¢ S‚Åª¬π) ‚Ä¢ H ‚Ä¢ HH ‚âà‚ü® (cright cong (sym assoc) (cright cleft word-comm 1 p-1 (trans assoc (lemma-comm-HHS)))) ‚ü©
    HH ‚Ä¢ ((S‚Åª¬π ‚Ä¢ HH) ‚Ä¢ H) ‚Ä¢ (S‚Åª¬π ‚Ä¢ H) ‚Ä¢ (S‚Åª¬π ‚Ä¢ HH) ‚Ä¢ H ‚Ä¢ HH ‚âà‚ü® (cright cong (cleft word-comm p-1 1 (sym (trans assoc (lemma-comm-HHS)))) (cright assoc)) ‚ü©
    HH ‚Ä¢ ((HH ‚Ä¢ S‚Åª¬π) ‚Ä¢ H) ‚Ä¢ (S‚Åª¬π ‚Ä¢ H) ‚Ä¢ S‚Åª¬π ‚Ä¢ HH ‚Ä¢ H ‚Ä¢ HH ‚âà‚ü® (cright cright cright cright rewrite-sim 100 auto) ‚ü©
    HH ‚Ä¢ ((HH ‚Ä¢ S‚Åª¬π) ‚Ä¢ H) ‚Ä¢ (S‚Åª¬π ‚Ä¢ H) ‚Ä¢ S‚Åª¬π ‚Ä¢ H ‚âà‚ü® special-assoc (‚ñ° ‚Ä¢ (‚ñ° ^ 2 ‚Ä¢ ‚ñ°) ‚Ä¢ ‚ñ°) (‚ñ° ^ 2 ‚Ä¢ ‚ñ° ^ 2 ‚Ä¢ ‚ñ°) auto ‚ü©
    (HH ‚Ä¢ HH) ‚Ä¢ (S‚Åª¬π ‚Ä¢ H) ‚Ä¢ (S‚Åª¬π ‚Ä¢ H) ‚Ä¢ S‚Åª¬π ‚Ä¢ H ‚âà‚ü® (cleft rewrite-sim 100 auto) ‚ü©
    Œµ ‚Ä¢ (S‚Åª¬π ‚Ä¢ H) ‚Ä¢ (S‚Åª¬π ‚Ä¢ H) ‚Ä¢ S‚Åª¬π ‚Ä¢ H ‚âà‚ü® left-unit ‚ü©
    (S‚Åª¬π ‚Ä¢ H) ‚Ä¢ (S‚Åª¬π ‚Ä¢ H) ‚Ä¢ S‚Åª¬π ‚Ä¢ H ‚âà‚ü® special-assoc ((‚ñ° ^ 2) ^ 3) (‚ñ° ^ 6) auto ‚ü©
    S‚Åª¬π ‚Ä¢ H ‚Ä¢ S‚Åª¬π ‚Ä¢ H ‚Ä¢ S‚Åª¬π ‚Ä¢ H ‚âà‚ü® cong lemma-S‚Åª¬π (cright cong lemma-S‚Åª¬π (cright cong lemma-S‚Åª¬π refl)) ‚ü©
    S^ ‚Çö‚Çã‚ÇÅ ‚Ä¢ H ‚Ä¢ S^ ‚Çö‚Çã‚ÇÅ ‚Ä¢ H ‚Ä¢ S^ ‚Çö‚Çã‚ÇÅ ‚Ä¢ H ‚â°‚ü® Eq.cong (\ xx -> S^ ‚Çö‚Çã‚ÇÅ ‚Ä¢ H ‚Ä¢ S^ ‚Çö‚Çã‚ÇÅ ‚Ä¢ H ‚Ä¢ S^ xx ‚Ä¢ H) p-1=-1‚Çö ‚ü©
    S^ ‚Çö‚Çã‚ÇÅ ‚Ä¢ H ‚Ä¢ S^ ‚Çö‚Çã‚ÇÅ ‚Ä¢ H ‚Ä¢ S^ -‚ÇÅ ‚Ä¢ H ‚â°‚ü® Eq.cong‚ÇÇ (\ xx yy -> S^ xx ‚Ä¢ H ‚Ä¢ S^ yy ‚Ä¢ H ‚Ä¢ S^ -‚ÇÅ ‚Ä¢ H) (p-1=-1‚Çö) p-1=-1‚Çö ‚ü©
    S^ -‚ÇÅ ‚Ä¢ H ‚Ä¢ S^ -‚ÇÅ ‚Ä¢ H ‚Ä¢ S^ -‚ÇÅ ‚Ä¢ H ‚â°‚ü® Eq.cong (\ xx -> S^ -‚ÇÅ ‚Ä¢ H ‚Ä¢ S^ xx ‚Ä¢ H ‚Ä¢ S^ -‚ÇÅ ‚Ä¢ H) (Eq.sym aux-‚ÇÅ‚Åª¬π) ‚ü©
    S^ -‚ÇÅ ‚Ä¢ H ‚Ä¢ S^ -‚ÇÅ‚Åª¬π ‚Ä¢ H ‚Ä¢ S^ -‚ÇÅ ‚Ä¢ H ‚âà‚ü® refl ‚ü©
    S^ x ‚Ä¢ H ‚Ä¢ S^ x‚Åª¬π ‚Ä¢ H ‚Ä¢ S^ x ‚Ä¢ H ‚â°‚ü® Eq.refl ‚ü©
    M x' ‚àé
    where
    open Sim-Rewriting n


    x' = -'‚ÇÅ
    -‚ÇÅ = -'‚ÇÅ .proj‚ÇÅ
    -‚ÇÅ‚Åª¬π = (-'‚ÇÅ ‚Åª¬π) .proj‚ÇÅ
    x = x' .proj‚ÇÅ
    x‚Åª¬π = (x' ‚Åª¬π) .proj‚ÇÅ
    open SR word-setoid



  derived-D : ‚àÄ x -> (nz : x ‚â¢ ‚ÇÄ) -> let x‚Åª¬π = ((x , nz) ‚Åª¬π) .proj‚ÇÅ in let -x‚Åª¬π = - x‚Åª¬π in
    H ‚Ä¢ S^ x ‚Ä¢ H ‚âà H ‚Ä¢ S^ x ‚Ä¢ H ‚Ä¢ S^ x‚Åª¬π ‚Ä¢ H ‚Ä¢ H ^ 3 ‚Ä¢ S^ -x‚Åª¬π
  derived-D  x nz = begin
    H ‚Ä¢ S^ x ‚Ä¢ H ‚âà‚ü® (cright cright sym right-unit) ‚ü©
    H ‚Ä¢ S^ x ‚Ä¢ H ‚Ä¢ Œµ ‚âà‚ü® cright cright cright sym (lemma-S^k-k x‚Åª¬π) ‚ü©
    H ‚Ä¢ S^ x ‚Ä¢ H ‚Ä¢ S^ x‚Åª¬π ‚Ä¢ S^ -x‚Åª¬π ‚âà‚ü® cright cright cright cright sym left-unit ‚ü©
    H ‚Ä¢ S^ x ‚Ä¢ H ‚Ä¢ S^ x‚Åª¬π ‚Ä¢ Œµ ‚Ä¢ S^ -x‚Åª¬π ‚âà‚ü® cright cright cright cright sym (cong (lemma-order-H) refl) ‚ü©
    H ‚Ä¢ S^ x ‚Ä¢ H ‚Ä¢ S^ x‚Åª¬π ‚Ä¢ H ^ 4 ‚Ä¢ S^ -x‚Åª¬π ‚âà‚ü® (cright cright cright cright special-assoc (‚ñ° ^ 4 ‚Ä¢ ‚ñ°) (‚ñ° ‚Ä¢ ‚ñ° ^ 3 ‚Ä¢ ‚ñ°) auto) ‚ü©
    H ‚Ä¢ S^ x ‚Ä¢ H ‚Ä¢ S^ x‚Åª¬π ‚Ä¢ H ‚Ä¢ H ^ 3 ‚Ä¢ S^ -x‚Åª¬π ‚àé
    where
    x‚Åª¬π = ((x , nz) ‚Åª¬π) .proj‚ÇÅ
    -x‚Åª¬π = - x‚Åª¬π 
    open SR word-setoid



  lemma-MS^k' : ‚àÄ x k -> (nz : x ‚â¢ ‚ÇÄ) -> let x‚Åª¬π = ((x , nz) ‚Åª¬π) .proj‚ÇÅ in let -x‚Åª¬π = - x‚Åª¬π in
    M (x , nz) ‚Ä¢ S^ (k * (x‚Åª¬π * x‚Åª¬π)) ‚âà S^ k ‚Ä¢ M (x , nz)
  lemma-MS^k' x k nz = begin 
    M (x , nz) ‚Ä¢ S^ (k * (x‚Åª¬π * x‚Åª¬π)) ‚âà‚ü® lemma-MS^k x (k * (x‚Åª¬π * x‚Åª¬π)) nz ‚ü©
    S^ (k * (x‚Åª¬π * x‚Åª¬π) * (x * x)) ‚Ä¢ M (x , nz) ‚âà‚ü® (cleft refl' (Eq.cong S^ (Eq.trans (*-assoc k (x‚Åª¬π * x‚Åª¬π)  (x * x)) (Eq.cong (k *_) (aux-xxxx (x , nz)))))) ‚ü©
    S^ (k * ‚ÇÅ) ‚Ä¢ M (x , nz) ‚âà‚ü® (cleft refl' (Eq.cong S^ (*-identity ≥ k))) ‚ü©
    S^ k ‚Ä¢ M (x , nz) ‚àé
    where
    open SR word-setoid
    x‚Åª¬π = ((x , nz) ‚Åª¬π) .proj‚ÇÅ
    -x‚Åª¬π = - x‚Åª¬π


  lemma-S^ab : ‚àÄ (a b : ‚Ñ§ ‚Çö) -> S ^ to‚Ñï (a * b) ‚âà S ^ (to‚Ñï a Nat.* to‚Ñï b)
  lemma-S^ab a b = begin
    S ^ to‚Ñï (a * b) ‚â°‚ü® auto ‚ü©
    S ^ to‚Ñï (from‚Ñï< (m%n<n (to‚Ñï a Nat.* to‚Ñï b) p)) ‚â°‚ü® Eq.cong (S ^_) (to‚Ñï-from‚Ñï< (m%n<n (to‚Ñï a Nat.* to‚Ñï b) p)) ‚ü©
    S ^ ((to‚Ñï a Nat.* to‚Ñï b) % p) ‚âà‚ü® sym right-unit ‚ü©
    S ^ (ab Nat.% p) ‚Ä¢ Œµ ‚âà‚ü® (cright sym (lemma-Œµ^k=Œµ (ab Nat./ p))) ‚ü©
    S ^ (ab Nat.% p) ‚Ä¢ (Œµ) ^ (ab Nat./ p) ‚âà‚ü® (cright sym (lemma-^-cong (S ^ p) Œµ (ab Nat./ p) (axiom order-S))) ‚ü©
    S ^ (ab Nat.% p) ‚Ä¢ (S ^ p) ^ (ab Nat./ p) ‚âà‚ü® (cright lemma-^^ S p (ab Nat./ p)) ‚ü©
    S ^ (ab Nat.% p) ‚Ä¢ S ^ (p Nat.* (ab Nat./ p)) ‚âà‚ü® (cright refl' (Eq.cong (S ^_) (NP.*-comm p (ab Nat./ p)))) ‚ü©
    S ^ (ab Nat.% p) ‚Ä¢ S ^ (ab Nat./ p Nat.* p) ‚âà‚ü® sym (lemma-^-+ S (ab Nat.% p) (ab Nat./ p Nat.* p)) ‚ü©
    S ^ (ab Nat.% p Nat.+ ab Nat./ p Nat.* p) ‚â°‚ü® Eq.cong (S ^_) (Eq.sym (m‚â°m%n+[m/n]*n ab p)) ‚ü©
    S ^ (to‚Ñï a Nat.* to‚Ñï b) ‚àé
    where
    ab = to‚Ñï a Nat.* to‚Ñï b
    open SR word-setoid


  derived-7 : ‚àÄ x y -> (nz : x ‚â¢ ‚ÇÄ) -> (nzy : y ‚â¢ ‚ÇÄ) -> let -'‚ÇÅ = -' ((‚ÇÅ , Œª ())) in let x‚Åª¬π = ((x , nz) ‚Åª¬π) .proj‚ÇÅ in let -x‚Åª¬π = - x‚Åª¬π in let -y/x' = (((y , nzy) *' ((x , nz) ‚Åª¬π)) *' -'‚ÇÅ) in let -y/x = -y/x' .proj‚ÇÅ in
  
    M (y , nzy) ‚Ä¢ H ‚Ä¢ S^ x ‚Ä¢ H ‚âà S^ (-x‚Åª¬π * (y * y)) ‚Ä¢ M -y/x' ‚Ä¢ (H ‚Ä¢ S^ -x‚Åª¬π)
    
  derived-7 x y nzx nzy = begin
    M (y , nzy) ‚Ä¢ H ‚Ä¢ S^ x ‚Ä¢ H ‚âà‚ü® (cright derived-D x nzx) ‚ü©
    M (y , nzy) ‚Ä¢ H ‚Ä¢ S^ x ‚Ä¢ H ‚Ä¢ S^ x‚Åª¬π ‚Ä¢ H ‚Ä¢ H ^ 3 ‚Ä¢ S^ -x‚Åª¬π ‚âà‚ü® (cright special-assoc (‚ñ° ‚Ä¢ ‚ñ° ‚Ä¢ ‚ñ° ‚Ä¢ ‚ñ° ‚Ä¢ ‚ñ° ‚Ä¢ ‚ñ° ‚Ä¢ ‚ñ°) (‚ñ° ^ 5 ‚Ä¢ ‚ñ° ‚Ä¢ ‚ñ°) auto) ‚ü©
    M (y , nzy) ‚Ä¢ (H ‚Ä¢ S^ x ‚Ä¢ H ‚Ä¢ S^ x‚Åª¬π ‚Ä¢ H) ‚Ä¢ H ^ 3 ‚Ä¢ S^ -x‚Åª¬π ‚âà‚ü® (cright cleft sym left-unit) ‚ü©
    M (y , nzy) ‚Ä¢ (Œµ ‚Ä¢ H ‚Ä¢ S^ x ‚Ä¢ H ‚Ä¢ S^ x‚Åª¬π ‚Ä¢ H) ‚Ä¢ H ^ 3 ‚Ä¢ S^ -x‚Åª¬π ‚âà‚ü® (cright cleft cleft sym (lemma-S^-k+k x‚Åª¬π)) ‚ü©
    M (y , nzy) ‚Ä¢ ((S^ -x‚Åª¬π ‚Ä¢ S^ x‚Åª¬π) ‚Ä¢ H ‚Ä¢ S^ x ‚Ä¢ H ‚Ä¢ S^ x‚Åª¬π ‚Ä¢ H) ‚Ä¢ H ^ 3 ‚Ä¢ S^ -x‚Åª¬π ‚âà‚ü® special-assoc (‚ñ° ‚Ä¢ (‚ñ° ^ 2 ‚Ä¢ ‚ñ° ^ 5) ‚Ä¢ ‚ñ°) (‚ñ° ^ 2 ‚Ä¢ ‚ñ° ^ 6 ‚Ä¢ ‚ñ°) auto ‚ü©
    (M (y , nzy) ‚Ä¢ S^ -x‚Åª¬π) ‚Ä¢ (S^ x‚Åª¬π ‚Ä¢ H ‚Ä¢ S^ x ‚Ä¢ H ‚Ä¢ S^ x‚Åª¬π ‚Ä¢ H) ‚Ä¢ H ^ 3 ‚Ä¢ S^ -x‚Åª¬π ‚âà‚ü® refl ‚ü©
    (M (y , nzy) ‚Ä¢ S ^ to‚Ñï -x‚Åª¬π) ‚Ä¢ (S^ x‚Åª¬π ‚Ä¢ H ‚Ä¢ S^ x ‚Ä¢ H ‚Ä¢ S^ x‚Åª¬π ‚Ä¢ H) ‚Ä¢ H ^ 3 ‚Ä¢ S^ -x‚Åª¬π ‚âà‚ü® (cleft derived-5 y (to‚Ñï -x‚Åª¬π) nzy) ‚ü©
    (S ^ (to‚Ñï -x‚Åª¬π Nat.* to‚Ñï (y * y)) ‚Ä¢ M (y , nzy)) ‚Ä¢ (S^ x‚Åª¬π ‚Ä¢ H ‚Ä¢ S^ x ‚Ä¢ H ‚Ä¢ S^ x‚Åª¬π ‚Ä¢ H) ‚Ä¢ H ^ 3 ‚Ä¢ S^ -x‚Åª¬π ‚âà‚ü® special-assoc (‚ñ° ^ 2 ‚Ä¢ ‚ñ° ^ 2) (‚ñ° ‚Ä¢ ‚ñ° ^ 2 ‚Ä¢ ‚ñ°) auto ‚ü©
    S ^ (to‚Ñï -x‚Åª¬π Nat.* to‚Ñï (y * y)) ‚Ä¢ (M (y , nzy) ‚Ä¢ (S^ x‚Åª¬π ‚Ä¢ H ‚Ä¢ S^ x ‚Ä¢ H ‚Ä¢ S^ x‚Åª¬π ‚Ä¢ H)) ‚Ä¢ H ^ 3 ‚Ä¢ S^ -x‚Åª¬π ‚âà‚ü® (cright cleft (cright (cright cright cleft refl' (Eq.cong S^ (Eq.sym (inv-involutive ((x , nz)))))))) ‚ü©
    S ^ (to‚Ñï -x‚Åª¬π Nat.* to‚Ñï (y * y)) ‚Ä¢ (M (y , nzy) ‚Ä¢ M ((x , nz) ‚Åª¬π)) ‚Ä¢ H ^ 3 ‚Ä¢ S^ -x‚Åª¬π ‚âà‚ü® (cright cleft (lemma-M-mul (y , nzy) ((x , nz) ‚Åª¬π))) ‚ü©
    S ^ (to‚Ñï -x‚Åª¬π Nat.* to‚Ñï (y * y)) ‚Ä¢ M ((y , nzy) *' ((x , nz) ‚Åª¬π)) ‚Ä¢ H ^ 3 ‚Ä¢ S^ -x‚Åª¬π ‚âà‚ü® (cright special-assoc (‚ñ° ‚Ä¢ ‚ñ° ^ 3 ‚Ä¢ ‚ñ°) (‚ñ° ^ 3 ‚Ä¢ ‚ñ° ^ 2) auto) ‚ü©
    S ^ (to‚Ñï -x‚Åª¬π Nat.* to‚Ñï (y * y)) ‚Ä¢ (M ((y , nzy) *' ((x , nz) ‚Åª¬π)) ‚Ä¢ HH) ‚Ä¢ H ‚Ä¢ S^ -x‚Åª¬π ‚âà‚ü® (cright cleft (cright lemma-HH-M-1)) ‚ü©
    S ^ (to‚Ñï -x‚Åª¬π Nat.* to‚Ñï (y * y)) ‚Ä¢ (M ((y , nzy) *' ((x , nz) ‚Åª¬π)) ‚Ä¢ M -'‚ÇÅ) ‚Ä¢ H ‚Ä¢ S^ -x‚Åª¬π ‚âà‚ü® (cright cleft (lemma-M-mul (((y , nzy) *' ((x , nz) ‚Åª¬π))) -'‚ÇÅ)) ‚ü©
    S ^ (to‚Ñï -x‚Åª¬π Nat.* to‚Ñï (y * y)) ‚Ä¢ (M (((y , nzy) *' ((x , nz) ‚Åª¬π)) *' -'‚ÇÅ) ) ‚Ä¢ H ‚Ä¢ S^ -x‚Åª¬π ‚âà‚ü® (cleft sym (lemma-S^ab -x‚Åª¬π (y * y))) ‚ü©
    S ^ to‚Ñï (-x‚Åª¬π * (y * y)) ‚Ä¢ M -y/x' ‚Ä¢ (H ‚Ä¢ S^ -x‚Åª¬π) ‚âà‚ü® refl ‚ü©
    S^ (-x‚Åª¬π * (y * y)) ‚Ä¢ M -y/x' ‚Ä¢ (H ‚Ä¢ S^ -x‚Åª¬π) ‚àé
    where
    open SR word-setoid
    nz = nzx
    x‚Åª¬π = ((x , nz) ‚Åª¬π) .proj‚ÇÅ
    x‚Åª¬π‚Åª¬π = (((x , nz) ‚Åª¬π) ‚Åª¬π) .proj‚ÇÅ
    -x‚Åª¬π = - x‚Åª¬π
    -y/x' = (((y , nzy) *' ((x , nz) ‚Åª¬π)) *' -'‚ÇÅ)
    -y/x = -y/x' .proj‚ÇÅ

  aux-MM : ‚àÄ {x y : ‚Ñ§ ‚Çö} (nzx : x ‚â¢ ‚ÇÄ) (nzy : y ‚â¢ ‚ÇÄ) -> x ‚â° y -> M (x , nzx) ‚âà M (y , nzy)
  aux-MM {x} {y} nz1 nz2 eq rewrite eq = refl


  aux-M-mul : ‚àÄ m -> M m ‚Ä¢ M (m ‚Åª¬π) ‚âà Œµ
  aux-M-mul m = begin
    M m ‚Ä¢ M (m ‚Åª¬π) ‚âà‚ü® (lemma-M-mul m ( m ‚Åª¬π)) ‚ü©
    M (m *' m ‚Åª¬π) ‚âà‚ü® aux-MM ((m *' m ‚Åª¬π) .proj‚ÇÇ) (Œª ()) (lemma-‚Åª¬π ≥ (m ^1) {{nzto‚Ñï {y = m ^1} {neq0 = m .proj‚ÇÇ}}}) ‚ü©
    M‚ÇÅ ‚âà‚ü® lemma-M1 ‚ü©
    Œµ ‚àé
    where
    open SR word-setoid

  aux-M-mulÀ° : ‚àÄ m -> M (m ‚Åª¬π) ‚Ä¢ M m ‚âà Œµ
  aux-M-mulÀ° m = begin
    M (m ‚Åª¬π) ‚Ä¢ M m ‚âà‚ü® (lemma-M-mul ( m ‚Åª¬π) m) ‚ü©
    M (m ‚Åª¬π *' m) ‚âà‚ü® aux-MM ((m ‚Åª¬π *' m) .proj‚ÇÇ) (Œª ()) (lemma-‚Åª¬πÀ° (m ^1) {{nzto‚Ñï {y = m ^1} {neq0 = m .proj‚ÇÇ}}}) ‚ü©
    M‚ÇÅ ‚âà‚ü® lemma-M1 ‚ü©
    Œµ ‚àé
    where
    open SR word-setoid



  semi-HM : ‚àÄ (x : ‚Ñ§* ‚Çö) -> H ‚Ä¢ M x ‚âà M (x ‚Åª¬π) ‚Ä¢ H
  semi-HM x' = begin
    H ‚Ä¢ (S^ x ‚Ä¢ H ‚Ä¢ S^ x‚Åª¬π ‚Ä¢ H ‚Ä¢ S^ x ‚Ä¢ H) ‚âà‚ü® special-assoc (‚ñ° ‚Ä¢ ‚ñ° ^ 6) (‚ñ° ^ 3 ‚Ä¢ ‚ñ° ^ 4) auto ‚ü©
    (H ‚Ä¢ S^ x ‚Ä¢ H) ‚Ä¢ S^ x‚Åª¬π ‚Ä¢ H ‚Ä¢ S^ x ‚Ä¢ H ‚âà‚ü® (trans (sym left-unit) (cong (sym lemma-M1) refl)) ‚ü©
    M‚ÇÅ ‚Ä¢ (H ‚Ä¢ S^ x ‚Ä¢ H) ‚Ä¢ S^ x‚Åª¬π ‚Ä¢ H ‚Ä¢ S^ x ‚Ä¢ H ‚âà‚ü® sym assoc ‚ü©
    (M‚ÇÅ ‚Ä¢ (H ‚Ä¢ S^ x ‚Ä¢ H)) ‚Ä¢ S^ x‚Åª¬π ‚Ä¢ H ‚Ä¢ S^ x ‚Ä¢ H ‚âà‚ü® (cleft derived-7 x ‚ÇÅ (x' .proj‚ÇÇ) Œª ()) ‚ü©
    (S^ (-x‚Åª¬π * (‚ÇÅ * ‚ÇÅ)) ‚Ä¢ M (((‚ÇÅ , Œª ()) *' x' ‚Åª¬π) *' -'‚ÇÅ) ‚Ä¢ H ‚Ä¢ S^ -x‚Åª¬π) ‚Ä¢ S^ x‚Åª¬π ‚Ä¢ H ‚Ä¢ S^ x ‚Ä¢ H ‚âà‚ü® cleft (cright (cleft aux-MM ((((‚ÇÅ , Œª ()) *' x' ‚Åª¬π) *' -'‚ÇÅ) .proj‚ÇÇ) ((-' (x' ‚Åª¬π)) .proj‚ÇÇ) aux-a1)) ‚ü©
    (S^ (-x‚Åª¬π * ‚ÇÅ) ‚Ä¢ M (-' (x' ‚Åª¬π)) ‚Ä¢ H ‚Ä¢ S^ -x‚Åª¬π) ‚Ä¢ S^ x‚Åª¬π ‚Ä¢ H ‚Ä¢ S^ x ‚Ä¢ H ‚âà‚ü® special-assoc (‚ñ° ^ 4 ‚Ä¢ ‚ñ° ^ 4) (‚ñ° ‚Ä¢ ‚ñ° ^ 4 ‚Ä¢ ‚ñ° ^ 3) auto ‚ü©
    S^ (-x‚Åª¬π * ‚ÇÅ) ‚Ä¢ (M (-' (x' ‚Åª¬π)) ‚Ä¢ H ‚Ä¢ S^ -x‚Åª¬π ‚Ä¢ S^ x‚Åª¬π) ‚Ä¢ H ‚Ä¢ S^ x ‚Ä¢ H ‚âà‚ü® cong (refl' (Eq.cong S^ (*-identity ≥ -x‚Åª¬π))) (cleft cright (cright lemma-S^-k+k x‚Åª¬π)) ‚ü©
    S^ -x‚Åª¬π ‚Ä¢ (M (-' (x' ‚Åª¬π)) ‚Ä¢ H ‚Ä¢ Œµ) ‚Ä¢ H ‚Ä¢ S^ x ‚Ä¢ H ‚âà‚ü® (cright cleft (cright right-unit)) ‚ü©
    S^ -x‚Åª¬π ‚Ä¢ (M (-' (x' ‚Åª¬π)) ‚Ä¢ H) ‚Ä¢ H ‚Ä¢ S^ x ‚Ä¢ H ‚âà‚ü® (cright special-assoc (‚ñ° ^ 2 ‚Ä¢ ‚ñ° ^ 3) (‚ñ° ^ 3 ‚Ä¢ ‚ñ° ^ 2) auto) ‚ü©
    S^ -x‚Åª¬π ‚Ä¢ (M (-' (x' ‚Åª¬π)) ‚Ä¢ H ‚Ä¢ H) ‚Ä¢ S^ x ‚Ä¢ H ‚âà‚ü® (cright cleft cright lemma-HH-M-1) ‚ü©
    S^ -x‚Åª¬π ‚Ä¢ (M (-' (x' ‚Åª¬π)) ‚Ä¢ M -'‚ÇÅ) ‚Ä¢ S^ x ‚Ä¢ H ‚âà‚ü® (cright cleft (lemma-M-mul (-' (x' ‚Åª¬π)) -'‚ÇÅ)) ‚ü©
    S^ -x‚Åª¬π ‚Ä¢ M (-' (x' ‚Åª¬π) *' -'‚ÇÅ) ‚Ä¢ S^ x ‚Ä¢ H ‚âà‚ü® (cright cleft aux-MM ((-' (x' ‚Åª¬π) *' -'‚ÇÅ) .proj‚ÇÇ) ((x' ‚Åª¬π) .proj‚ÇÇ) aux-a2) ‚ü©
    S^ -x‚Åª¬π ‚Ä¢ M (x' ‚Åª¬π) ‚Ä¢ S^ x ‚Ä¢ H ‚âà‚ü® sym (cong refl assoc) ‚ü©
    S^ -x‚Åª¬π ‚Ä¢ (M (x' ‚Åª¬π) ‚Ä¢ S^ x) ‚Ä¢ H ‚âà‚ü® (cright cleft lemma-MS^k x‚Åª¬π x ((x' ‚Åª¬π) .proj‚ÇÇ)) ‚ü©
    S^ -x‚Åª¬π ‚Ä¢ (S^ (x * (x‚Åª¬π * x‚Åª¬π)) ‚Ä¢ M (x' ‚Åª¬π)) ‚Ä¢ H ‚âà‚ü® (cright cleft (cleft refl' (Eq.cong S^ aux-a3))) ‚ü©
    S^ -x‚Åª¬π ‚Ä¢ (S^ x‚Åª¬π ‚Ä¢ M (x' ‚Åª¬π)) ‚Ä¢ H ‚âà‚ü® special-assoc (‚ñ° ‚Ä¢ ‚ñ° ^ 2 ‚Ä¢ ‚ñ°) (‚ñ° ^ 2 ‚Ä¢ ‚ñ° ^ 2) auto ‚ü©
    (S^ -x‚Åª¬π ‚Ä¢ S^ x‚Åª¬π) ‚Ä¢ M (x' ‚Åª¬π) ‚Ä¢ H ‚âà‚ü® (cleft lemma-S^-k+k x‚Åª¬π) ‚ü©
    Œµ ‚Ä¢ M (x' ‚Åª¬π) ‚Ä¢ H ‚âà‚ü® left-unit ‚ü©
    M (x' ‚Åª¬π) ‚Ä¢ H ‚àé
    where
    x = x' .proj‚ÇÅ
    x‚Åª¬π = ((x' ‚Åª¬π) .proj‚ÇÅ )
    open Pattern-Assoc
    -x = - x
    -x‚Åª¬π = - x‚Åª¬π
    aux-a1 : ‚ÇÅ * x‚Åª¬π * (-'‚ÇÅ .proj‚ÇÅ) ‚â° -x‚Åª¬π
    aux-a1 = begin
      ‚ÇÅ * x‚Åª¬π * (-'‚ÇÅ .proj‚ÇÅ) ‚â°‚ü® Eq.cong (\ xx -> xx * (-'‚ÇÅ .proj‚ÇÅ)) (*-identityÀ° x‚Åª¬π) ‚ü©
      x‚Åª¬π * (-'‚ÇÅ .proj‚ÇÅ) ‚â°‚ü® Eq.cong (x‚Åª¬π *_) (Eq.sym p-1=-1‚Çö) ‚ü©
      x‚Åª¬π * ‚Çã‚ÇÅ ‚â°‚ü® *-comm x‚Åª¬π ‚Çã‚ÇÅ ‚ü©
      ‚Çã‚ÇÅ * x‚Åª¬π ‚â°‚ü® auto ‚ü©
      -x‚Åª¬π ‚àé
      where open ‚â°-Reasoning

    aux-a2 : -x‚Åª¬π * - ‚ÇÅ ‚â° x‚Åª¬π
    aux-a2 = begin
      -x‚Åª¬π * - ‚ÇÅ ‚â°‚ü® *-comm -x‚Åª¬π (- ‚ÇÅ) ‚ü©
      - ‚ÇÅ * -x‚Åª¬π ‚â°‚ü® -1*x‚âà-x -x‚Åª¬π ‚ü©
      - -x‚Åª¬π ‚â°‚ü® -‚Äøinvolutive x‚Åª¬π ‚ü©
      x‚Åª¬π ‚àé
      where
      open ‚â°-Reasoning
      open import Algebra.Properties.Ring (+-*-ring p-2)


    aux-a3 : x * (x‚Åª¬π * x‚Åª¬π) ‚â° x‚Åª¬π
    aux-a3 = begin
      x * (x‚Åª¬π * x‚Åª¬π) ‚â°‚ü® Eq.sym (*-assoc x x‚Åª¬π x‚Åª¬π) ‚ü©
      x * x‚Åª¬π * x‚Åª¬π ‚â°‚ü® Eq.cong (_* x‚Åª¬π) (lemma-‚Åª¬π ≥ x {{nzto‚Ñï {y = x} {neq0 = x' .proj‚ÇÇ}}}) ‚ü©
      ‚ÇÅ * x‚Åª¬π ‚â°‚ü® *-identityÀ° x‚Åª¬π ‚ü©
      x‚Åª¬π ‚àé
      where open ‚â°-Reasoning

    open SR word-setoid

  aux-comm-MM' : ‚àÄ m m' -> M m ‚Ä¢ M m' ‚âà M m' ‚Ä¢ M m
  aux-comm-MM' m m' = begin
    M m ‚Ä¢ M m' ‚âà‚ü® (lemma-M-mul m m') ‚ü©
    M (m *' m') ‚âà‚ü® aux-MM ((m *' m') .proj‚ÇÇ) ((m' *' m) .proj‚ÇÇ) (*-comm (m .proj‚ÇÅ) (m' .proj‚ÇÅ)) ‚ü©
    M (m' *' m) ‚âà‚ü® sym ((lemma-M-mul m' m)) ‚ü©
    M m' ‚Ä¢ M m ‚àé
    where
    open SR word-setoid
    
  aux-comm-HHM : ‚àÄ m -> HH ‚Ä¢ M m ‚âà M m ‚Ä¢ HH
  aux-comm-HHM m = begin
    HH ‚Ä¢ M m ‚âà‚ü® (cleft lemma-HH-M-1) ‚ü©
    M -'‚ÇÅ ‚Ä¢ M m ‚âà‚ü® aux-comm-MM' -'‚ÇÅ m ‚ü©
    M m ‚Ä¢ M -'‚ÇÅ ‚âà‚ü® (cright sym lemma-HH-M-1) ‚ü©
    M m ‚Ä¢ HH ‚àé
    where
    open SR word-setoid

  lemma-S^kM : ‚àÄ x k -> (nz : x ‚â¢ ‚ÇÄ) ->
    let
    x‚Åª¬π = ((x , nz) ‚Åª¬π) .proj‚ÇÅ
    -x‚Åª¬π = - x‚Åª¬π
    x‚Åª¬≤ = x‚Åª¬π * x‚Åª¬π
    in
    S^ k ‚Ä¢ M (x , nz) ‚âà M (x , nz) ‚Ä¢ S^ (k * x‚Åª¬≤)
  lemma-S^kM x k nz = bbc (M ((x , nz) ‚Åª¬π)) (M ((x , nz) ‚Åª¬π)) aux
    where
    open Basis-Change _ ((‚ÇÅ‚Çä n) QRel,_===_) grouplike
    open SR word-setoid
    x‚Åª¬π = ((x , nz) ‚Åª¬π) .proj‚ÇÅ
    -x‚Åª¬π = - x‚Åª¬π
    x‚Åª¬≤ = x‚Åª¬π * x‚Åª¬π
    aux : M ((x , nz) ‚Åª¬π) ‚Ä¢ (S^ k ‚Ä¢ M (x , nz)) ‚Ä¢ M ((x , nz) ‚Åª¬π) ‚âà M ((x , nz) ‚Åª¬π) ‚Ä¢ (M (x , nz) ‚Ä¢ S^ (k * x‚Åª¬≤)) ‚Ä¢ M ((x , nz) ‚Åª¬π)
    aux = begin
      M ((x , nz) ‚Åª¬π) ‚Ä¢ (S^ k ‚Ä¢ M (x , nz)) ‚Ä¢ M ((x , nz) ‚Åª¬π) ‚âà‚ü® cong refl assoc ‚ü©
      M ((x , nz) ‚Åª¬π) ‚Ä¢ S^ k ‚Ä¢ M (x , nz) ‚Ä¢ M ((x , nz) ‚Åª¬π) ‚âà‚ü® sym assoc ‚ü©
      (M ((x , nz) ‚Åª¬π) ‚Ä¢ S^ k) ‚Ä¢ M (x , nz) ‚Ä¢ M ((x , nz) ‚Åª¬π) ‚âà‚ü® (cleft lemma-MS^k x‚Åª¬π k (((x , nz) ‚Åª¬π) .proj‚ÇÇ)) ‚ü©
      (S^ (k * x‚Åª¬≤) ‚Ä¢ M ((x , nz) ‚Åª¬π)) ‚Ä¢ M (x , nz) ‚Ä¢ M ((x , nz) ‚Åª¬π) ‚âà‚ü® assoc ‚ü©
      S^ (k * x‚Åª¬≤) ‚Ä¢ M ((x , nz) ‚Åª¬π) ‚Ä¢ M (x , nz) ‚Ä¢ M ((x , nz) ‚Åª¬π) ‚âà‚ü® (cright sym assoc) ‚ü©
      S^ (k * x‚Åª¬≤) ‚Ä¢ (M ((x , nz) ‚Åª¬π) ‚Ä¢ M (x , nz)) ‚Ä¢ M ((x , nz) ‚Åª¬π) ‚âà‚ü®  (cright cleft (aux-M-mulÀ° (x , nz))) ‚ü©
      S^ (k * x‚Åª¬≤) ‚Ä¢ Œµ ‚Ä¢ M ((x , nz) ‚Åª¬π) ‚âà‚ü® cong refl left-unit ‚ü©
      S^ (k * x‚Åª¬≤) ‚Ä¢ M ((x , nz) ‚Åª¬π) ‚âà‚ü® sym left-unit ‚ü©
      Œµ ‚Ä¢ S^ (k * x‚Åª¬≤) ‚Ä¢ M ((x , nz) ‚Åª¬π) ‚âà‚ü® (cleft sym ((aux-M-mulÀ° (x , nz)))) ‚ü©
      (M ((x , nz) ‚Åª¬π) ‚Ä¢ M (x , nz)) ‚Ä¢ S^ (k * x‚Åª¬≤) ‚Ä¢ M ((x , nz) ‚Åª¬π) ‚âà‚ü® assoc ‚ü©
      M ((x , nz) ‚Åª¬π) ‚Ä¢ M (x , nz) ‚Ä¢ S^ (k * x‚Åª¬≤) ‚Ä¢ M ((x , nz) ‚Åª¬π) ‚âà‚ü® sym (cong refl assoc) ‚ü©
      M ((x , nz) ‚Åª¬π) ‚Ä¢ (M (x , nz) ‚Ä¢ S^ (k * x‚Åª¬≤)) ‚Ä¢ M ((x , nz) ‚Åª¬π) ‚àé


  aux-H¬≥M : ‚àÄ m* -> H ^ 3 ‚Ä¢ M m* ‚âà M (m* ‚Åª¬π) ‚Ä¢ H ^ 3
  aux-H¬≥M m*  = begin
    H ^ 3 ‚Ä¢ M m* ‚âà‚ü® special-assoc (‚ñ° ^ 3 ‚Ä¢ ‚ñ°) (‚ñ° ^ 2 ‚Ä¢ ‚ñ° ^ 2 ) auto ‚ü©
    H ^ 2 ‚Ä¢ H ‚Ä¢ M m* ‚âà‚ü® cright semi-HM m* ‚ü©
    H ^ 2 ‚Ä¢ M (m* ‚Åª¬π) ‚Ä¢ H ‚âà‚ü® sym assoc ‚ü©
    (H ^ 2 ‚Ä¢ M (m* ‚Åª¬π)) ‚Ä¢ H ‚âà‚ü® cleft aux-comm-HHM (m* ‚Åª¬π) ‚ü©
    (M (m* ‚Åª¬π) ‚Ä¢ H ^ 2) ‚Ä¢ H ‚âà‚ü® trans assoc (cong refl assoc) ‚ü©
    M (m* ‚Åª¬π) ‚Ä¢ H ^ 3 ‚àé
    where
    open SR word-setoid

  aux-H¬≥M' : ‚àÄ m'* -> H ^ 3 ‚Ä¢ M (m'* ‚Åª¬π) ‚âà M m'* ‚Ä¢ H ^ 3
  aux-H¬≥M' m'* = begin
    H ^ 3 ‚Ä¢ M (m'* ‚Åª¬π) ‚âà‚ü® aux-H¬≥M (m'* ‚Åª¬π) ‚ü©
    M (m'* ‚Åª¬π ‚Åª¬π) ‚Ä¢ H ^ 3 ‚âà‚ü® cleft aux-MM ((m'* ‚Åª¬π ‚Åª¬π).proj‚ÇÇ) (m'* .proj‚ÇÇ) (inv-involutive m'* ) ‚ü©
    M (m'*) ‚Ä¢ H ^ 3 ‚àé
    where
    open SR word-setoid


{-
module Clifford-Lemmas1 (n : ‚Ñï) where
  open Clifford-Relations
  open Clifford-GroupLike

  open PB ((‚ÇÅ‚Çä n) QRel,_===_) hiding (_===_)
  open PP ((‚ÇÅ‚Çä n) QRel,_===_)
  open Pattern-Assoc
  open import Data.Nat.DivMod
  open import Data.Fin.Properties
  open Lemmas1 n
  open Lemmas1b n
  open SR word-setoid
  
  lemma-order-HH : HH ^ 2 ‚âà Œµ
  lemma-order-HH = begin
    (H ^ 2) ^ 2 ‚âà‚ü® assoc ‚ü©
    (H ^ 4) ‚âà‚ü® axiom {!!} ‚ü©
    Œµ ‚àé


  lemma-order-Z : Z ^ 2 ‚Ä¢ Z ‚âà Œµ
  lemma-order-Z = begin
    Z ^ 2 ‚Ä¢ Z ‚âà‚ü® by-assoc auto ‚ü©
    (H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S) ‚Ä¢ (S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H) ‚Ä¢ S ^ 2 ‚Ä¢ (H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S) ‚Ä¢ S ‚âà‚ü® cong (_‚âà_.axiom comm-HHSHHS) (_‚âà_.cong (_‚âà_.sym (_‚âà_.axiom comm-HHSHHS)) _‚âà_.refl) ‚ü©
    (S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H) ‚Ä¢ (H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S) ‚Ä¢ S ^ 2 ‚Ä¢ (H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S) ‚Ä¢ S ‚âà‚ü® by-assoc auto ‚ü©
    (S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S) ‚Ä¢ H ^ 4 ‚Ä¢ (S ‚Ä¢ H ‚Ä¢ H) ‚Ä¢ S ^ 3 ‚Ä¢ (H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S) ‚Ä¢ S ‚âà‚ü® cong _‚âà_.refl (cong (_‚âà_.axiom order-H) (_‚âà_.cong _‚âà_.refl (_‚âà_.cong (_‚âà_.axiom order-S) _‚âà_.refl))) ‚ü©
    (S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S) ‚Ä¢ Œµ ‚Ä¢ (S ‚Ä¢ H ‚Ä¢ H) ‚Ä¢ Œµ ‚Ä¢ (H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S) ‚Ä¢ S ‚âà‚ü® by-assoc auto ‚ü©
    (S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ S) ‚Ä¢ H ^ 4 ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ S ‚âà‚ü® _‚âà_.cong _‚âà_.refl (_‚âà_.cong (_‚âà_.axiom order-H) _‚âà_.refl) ‚ü©
    (S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ S) ‚Ä¢ Œµ ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ S ‚âà‚ü® by-assoc auto ‚ü©
    (S ‚Ä¢ H ‚Ä¢ H) ‚Ä¢ S ^ 3 ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ S ‚âà‚ü® _‚âà_.cong _‚âà_.refl (_‚âà_.cong (_‚âà_.axiom order-S) _‚âà_.refl) ‚ü©
    (S ‚Ä¢ H ‚Ä¢ H) ‚Ä¢ Œµ ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ S ‚âà‚ü® by-assoc auto ‚ü©
    S ‚Ä¢ H ^ 4 ‚Ä¢ S ‚Ä¢ S ‚âà‚ü® _‚âà_.cong _‚âà_.refl (_‚âà_.cong (_‚âà_.axiom order-H) _‚âà_.refl) ‚ü©
    S ‚Ä¢ Œµ ‚Ä¢ S ‚Ä¢ S ‚âà‚ü® _‚âà_.trans (_‚âà_.cong _‚âà_.refl _‚âà_.left-unit) (_‚âà_.axiom order-S) ‚ü©
    Œµ ‚àé

  lemma-order-X : X ^ 2 ‚Ä¢ X ‚âà Œµ
  lemma-order-X = begin
    X ^ 2 ‚Ä¢ X ‚âà‚ü® by-assoc auto ‚ü©
    (H ‚Ä¢ S ‚Ä¢ HH ‚Ä¢ S) ‚Ä¢ (S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H) ‚Ä¢ S ^ 2 ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ SS ‚Ä¢ H ‚âà‚ü® cong refl (_‚âà_.cong (_‚âà_.sym (_‚âà_.axiom comm-HHSHHS)) _‚âà_.refl) ‚ü©
    (H ‚Ä¢ S ‚Ä¢ HH ‚Ä¢ S) ‚Ä¢ (H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S) ‚Ä¢ S ^ 2 ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ SS ‚Ä¢ H ‚âà‚ü® by-assoc auto ‚ü©
    (H ‚Ä¢ S ‚Ä¢ HH ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H) ‚Ä¢ S ^ 3 ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ SS ‚Ä¢ H ‚âà‚ü® _‚âà_.cong _‚âà_.refl (_‚âà_.cong (_‚âà_.axiom order-S) _‚âà_.refl) ‚ü©
    (H ‚Ä¢ S ‚Ä¢ HH ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H) ‚Ä¢ Œµ ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ SS ‚Ä¢ H ‚âà‚ü® by-assoc auto ‚ü©
    (H ‚Ä¢ S ‚Ä¢ HH ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S) ‚Ä¢ H ^ 4 ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ SS ‚Ä¢ H ‚âà‚ü® _‚âà_.cong _‚âà_.refl (_‚âà_.cong (_‚âà_.axiom order-H) _‚âà_.refl) ‚ü©
    (H ‚Ä¢ S ‚Ä¢ HH ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S) ‚Ä¢ Œµ ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ SS ‚Ä¢ H ‚âà‚ü® by-assoc auto ‚ü©
    H ‚Ä¢ (S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H) ‚Ä¢ S ^ 2 ‚Ä¢ H ‚Ä¢ H ‚Ä¢ SS ‚Ä¢ H ‚âà‚ü® cong refl (_‚âà_.cong (_‚âà_.sym (_‚âà_.axiom comm-HHSHHS)) _‚âà_.refl) ‚ü©
    H ‚Ä¢ (H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S) ‚Ä¢ S ^ 2 ‚Ä¢ H ‚Ä¢ H ‚Ä¢ SS ‚Ä¢ H ‚âà‚ü® by-assoc auto ‚ü©
    (H ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H) ‚Ä¢ S ^ 3 ‚Ä¢ H ‚Ä¢ H ‚Ä¢ SS ‚Ä¢ H ‚âà‚ü® _‚âà_.cong _‚âà_.refl (_‚âà_.cong (_‚âà_.axiom order-S) _‚âà_.refl) ‚ü©
    (H ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H) ‚Ä¢ Œµ ‚Ä¢ H ‚Ä¢ H ‚Ä¢ SS ‚Ä¢ H ‚âà‚ü® by-assoc auto ‚ü©
    (H ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S) ‚Ä¢ H ^ 4 ‚Ä¢ SS ‚Ä¢ H ‚âà‚ü® _‚âà_.cong _‚âà_.refl (_‚âà_.cong (_‚âà_.axiom order-H) _‚âà_.refl) ‚ü©
    (H ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S) ‚Ä¢ Œµ ‚Ä¢ SS ‚Ä¢ H ‚âà‚ü® by-assoc auto ‚ü©
    (H ‚Ä¢ H ‚Ä¢ H) ‚Ä¢ S ^ 3 ‚Ä¢ H ‚âà‚ü® _‚âà_.cong _‚âà_.refl (_‚âà_.cong (_‚âà_.axiom order-S) _‚âà_.refl) ‚ü©
    (H ‚Ä¢ H ‚Ä¢ H) ‚Ä¢ Œµ ‚Ä¢ H ‚âà‚ü® by-assoc auto ‚ü©
    H ‚Ä¢ H ‚Ä¢ H ‚Ä¢ H ‚âà‚ü® _‚âà_.axiom order-H ‚ü©
    Œµ ‚àé

  lemma-comm-Z-S : Z ‚Ä¢ S ‚âà S ‚Ä¢ Z
  lemma-comm-Z-S = begin
    Z ‚Ä¢ S ‚âà‚ü® by-assoc auto ‚ü©
    (H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S) ‚Ä¢ S ‚Ä¢ S ‚âà‚ü® _‚âà_.cong (_‚âà_.axiom comm-HHSHHS) _‚âà_.refl ‚ü©
    (S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H) ‚Ä¢ S ‚Ä¢ S ‚âà‚ü® by-assoc auto ‚ü©
    S ‚Ä¢ Z ‚àé

  lemma-SH^2 : (S ‚Ä¢ H) ^ 2 ‚âà H ^ 3 ‚Ä¢ S ^ 2
  lemma-SH^2 = begin
    (S ‚Ä¢ H) ^ 2 ‚âà‚ü® by-assoc auto ‚ü©
    (S ‚Ä¢ H ‚Ä¢ S ‚Ä¢ H) ‚Ä¢ Œµ ‚âà‚ü® _‚âà_.sym (_‚âà_.cong _‚âà_.refl (_‚âà_.axiom order-S)) ‚ü©
    (S ‚Ä¢ H ‚Ä¢ S ‚Ä¢ H) ‚Ä¢ S ^ 3 ‚âà‚ü® by-assoc auto ‚ü©
    (S ‚Ä¢ H ‚Ä¢ S ‚Ä¢ H ‚Ä¢ S) ‚Ä¢ Œµ ‚Ä¢ S ^ 2 ‚âà‚ü® cong refl (_‚âà_.sym (_‚âà_.cong (_‚âà_.axiom order-H) _‚âà_.refl)) ‚ü©
    (S ‚Ä¢ H ‚Ä¢ S ‚Ä¢ H ‚Ä¢ S) ‚Ä¢ H ^ 4 ‚Ä¢ S ^ 2 ‚âà‚ü® by-assoc auto ‚ü©
    (S ‚Ä¢ H) ^ 3 ‚Ä¢ H ^ 3 ‚Ä¢ S ^ 2 ‚âà‚ü® cong (_‚âà_.axiom order-SH) refl ‚ü©
    Œµ ‚Ä¢ H ^ 3 ‚Ä¢ S ^ 2 ‚âà‚ü® left-unit ‚ü©
    H ^ 3 ‚Ä¢ S ^ 2 ‚àé

  lemma-comm-HHSSHHS : H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S ‚âà S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H
  lemma-comm-HHSSHHS = begin
    H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S ‚âà‚ü® by-assoc Eq.refl ‚ü©
    (H ‚Ä¢ H ‚Ä¢ S) ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S ‚âà‚ü® cong refl (trans (sym left-unit) (sym (cong (axiom order-H) refl))) ‚ü©
    (H ‚Ä¢ H ‚Ä¢ S) ‚Ä¢ H ^ 4 ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S ‚âà‚ü® by-assoc Eq.refl ‚ü©
    (H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ H  ‚Ä¢ H) ‚Ä¢ (H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S) ‚âà‚ü® cong refl (axiom comm-HHSHHS) ‚ü©
    (H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ H  ‚Ä¢ H) ‚Ä¢ S ‚Ä¢ (H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H) ‚âà‚ü® by-assoc Eq.refl ‚ü©
    (H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ H  ‚Ä¢ H ‚Ä¢ S) ‚Ä¢ (H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H) ‚âà‚ü® cong (axiom comm-HHSHHS) refl ‚ü©
    (S ‚Ä¢ (H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H)) ‚Ä¢ (H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H) ‚âà‚ü® by-assoc Eq.refl ‚ü©
    (S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S) ‚Ä¢ H ^ 4 ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H ‚âà‚ü® cong refl (cong (axiom order-H) refl) ‚ü©
    (S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S) ‚Ä¢ Œµ ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H ‚âà‚ü® by-assoc Eq.refl ‚ü©
    S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H ‚àé

  lemma-conj-HH-Z : HH ‚Ä¢ Z ‚âà (Z ‚Ä¢ Z) ‚Ä¢ HH
  lemma-conj-HH-Z = begin
    HH ‚Ä¢ HH ‚Ä¢ S ‚Ä¢ HH ‚Ä¢ SS ‚âà‚ü® by-assoc auto ‚ü©
    H ^ 4 ‚Ä¢ S ‚Ä¢ HH ‚Ä¢ SS ‚âà‚ü® _‚âà_.trans (_‚âà_.cong (_‚âà_.axiom order-H) _‚âà_.refl) _‚âà_.left-unit ‚ü©
    S ‚Ä¢ HH ‚Ä¢ SS ‚âà‚ü® by-assoc auto ‚ü©
    (Œµ ‚Ä¢ Œµ) ‚Ä¢ (S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ S) ‚Ä¢ Œµ ‚âà‚ü® cong (_‚âà_.sym (_‚âà_.cong (_‚âà_.axiom order-H) (_‚âà_.axiom order-S))) (_‚âà_.sym (_‚âà_.cong _‚âà_.refl (_‚âà_.axiom order-H))) ‚ü©
    (H ^ 4 ‚Ä¢ S ^ 3) ‚Ä¢ (S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ S) ‚Ä¢ H ^ 4 ‚âà‚ü® by-assoc auto ‚ü©
    (H ^ 4 ‚Ä¢ S ^ 3) ‚Ä¢ (S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H) ‚Ä¢ HH ‚âà‚ü® cong refl (cong (_‚âà_.sym lemma-comm-HHSSHHS) refl) ‚ü©
    (H ^ 4 ‚Ä¢ S ^ 3) ‚Ä¢ (H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S) ‚Ä¢ HH ‚âà‚ü® by-assoc auto ‚ü©
    (H ^ 4 ‚Ä¢ S ‚Ä¢ S) ‚Ä¢ (S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H) ‚Ä¢ S ‚Ä¢ HH ‚âà‚ü® cong refl (cong (_‚âà_.sym lemma-comm-HHSSHHS) refl) ‚ü©
    (H ^ 4 ‚Ä¢ S ‚Ä¢ S) ‚Ä¢ (H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S) ‚Ä¢ S ‚Ä¢ HH ‚âà‚ü® by-assoc auto ‚ü©
    HH ‚Ä¢ (H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S) ‚Ä¢ S ‚Ä¢ HH ‚Ä¢ SS ‚Ä¢ HH ‚âà‚ü® cong refl (cong lemma-comm-HHSSHHS refl) ‚ü©
    HH ‚Ä¢ (S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H) ‚Ä¢ S ‚Ä¢ HH ‚Ä¢ SS ‚Ä¢ HH ‚âà‚ü® by-assoc auto ‚ü©
    (Z ‚Ä¢ Z) ‚Ä¢ HH ‚àé


  lemma-def-XX : X ‚Ä¢ X ‚âà (H ‚Ä¢ S ‚Ä¢ S ‚Ä¢ H) ‚Ä¢ (H ‚Ä¢ S ‚Ä¢ H)
  lemma-def-XX = begin
    X ‚Ä¢ X ‚âà‚ü® by-assoc auto ‚ü©
    (H ‚Ä¢ S) ‚Ä¢ (H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S) ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ S ‚Ä¢ H ‚âà‚ü® cong refl (cong lemma-comm-HHSSHHS refl) ‚ü©
    (H ‚Ä¢ S) ‚Ä¢ (S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H) ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ S ‚Ä¢ H ‚âà‚ü® by-assoc Eq.refl ‚ü©
    (H ‚Ä¢ S ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ S) ‚Ä¢ H ^ 4 ‚Ä¢ S ‚Ä¢ S ‚Ä¢ H ‚âà‚ü® general-powers 100 auto ‚ü©
    (H ‚Ä¢ S ‚Ä¢ S ‚Ä¢ H) ‚Ä¢ (H ‚Ä¢ S ‚Ä¢ H) ‚àé

  lemma-def-ZZ : Z ‚Ä¢ Z ‚âà (HH ‚Ä¢ S ‚Ä¢ S ‚Ä¢ HH) ‚Ä¢ S
  lemma-def-ZZ = begin
    (HH ‚Ä¢ S ‚Ä¢ HH ‚Ä¢ SS) ‚Ä¢ (HH ‚Ä¢ S ‚Ä¢ HH ‚Ä¢ SS) ‚âà‚ü® by-assoc auto ‚ü©
    (HH ‚Ä¢ S ‚Ä¢ HH ‚Ä¢ S) ‚Ä¢ (S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H) ‚Ä¢ SS ‚âà‚ü® cong refl (sym (cong (axiom comm-HHSHHS) refl)) ‚ü©
    (HH ‚Ä¢ S ‚Ä¢ HH ‚Ä¢ S) ‚Ä¢ (H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S) ‚Ä¢ SS ‚âà‚ü® by-assoc auto ‚ü©
    (HH ‚Ä¢ S ‚Ä¢ HH) ‚Ä¢ (S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H) ‚Ä¢ S ^ 3 ‚âà‚ü® cong refl (cong (sym (axiom comm-HHSHHS)) (axiom order-S)) ‚ü©
    (HH ‚Ä¢ S ‚Ä¢ HH) ‚Ä¢ (H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S) ‚Ä¢ Œµ ‚âà‚ü® general-powers 100 auto ‚ü©
    (HH ‚Ä¢ S ‚Ä¢ S ‚Ä¢ HH) ‚Ä¢ S ‚àé

  lemma-conj-HH-X : HH ‚Ä¢ X ‚âà (X ‚Ä¢ X) ‚Ä¢ HH
  lemma-conj-HH-X = begin
    HH ‚Ä¢ X ‚âà‚ü® general-powers 100 auto ‚ü©
    H ‚Ä¢ (H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S) ‚Ä¢ S ‚Ä¢ H ‚âà‚ü® cong refl (cong (axiom comm-HHSHHS) refl) ‚ü©
    H ‚Ä¢ (S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H) ‚Ä¢ S ‚Ä¢ H ‚âà‚ü® by-assoc auto ‚ü©
    (H ‚Ä¢ S) ‚Ä¢ (H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S) ‚Ä¢ H ‚âà‚ü® cong refl (cong (axiom comm-HHSHHS) refl) ‚ü©
    (H ‚Ä¢ S) ‚Ä¢ (S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H) ‚Ä¢ H ‚âà‚ü® by-assoc auto ‚ü©
    ((H ‚Ä¢ S ‚Ä¢ S ‚Ä¢ H) ‚Ä¢ (H ‚Ä¢ S ‚Ä¢ H)) ‚Ä¢ HH ‚âà‚ü® cong (sym lemma-def-XX) refl ‚ü©
    (X ‚Ä¢ X) ‚Ä¢ HH ‚àé
    
  lemma-conj-HH-S : HH ‚Ä¢ S ‚âà (S ‚Ä¢ Z) ‚Ä¢ HH
  lemma-conj-HH-S = begin
    HH ‚Ä¢ S ‚âà‚ü® general-powers 100 auto ‚ü©
    (S ‚Ä¢ HH) ‚Ä¢ (H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S) ‚âà‚ü® cong refl lemma-comm-HHSSHHS ‚ü©
    (S ‚Ä¢ HH) ‚Ä¢ (S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H) ‚âà‚ü® by-assoc auto ‚ü©
    (S ‚Ä¢ HH ‚Ä¢ S ‚Ä¢ HH ‚Ä¢ SS) ‚Ä¢ HH ‚àé

  lemma-SHS : S ‚Ä¢ H ‚Ä¢ S ‚âà H ^ 3 ‚Ä¢ S ^ 2 ‚Ä¢ H ^ 3
  lemma-SHS = begin
    S ‚Ä¢ H ‚Ä¢ S ‚âà‚ü® general-powers 100 auto ‚ü©
    (S ‚Ä¢ H) ^ 3 ‚Ä¢ H ^ 3 ‚Ä¢ S ^ 2 ‚Ä¢ H ^ 3 ‚âà‚ü® cong (axiom order-SH) refl ‚ü©
    Œµ ‚Ä¢ H ^ 3 ‚Ä¢ S ^ 2 ‚Ä¢ H ^ 3 ‚âà‚ü® left-unit ‚ü©
    H ^ 3 ‚Ä¢ S ^ 2 ‚Ä¢ H ^ 3 ‚àé

  lemma-SHSH : S ‚Ä¢ H ‚Ä¢ S ‚Ä¢ H ‚âà H ^ 3 ‚Ä¢ S ^ 2
  lemma-SHSH = begin
    S ‚Ä¢ H ‚Ä¢ S ‚Ä¢ H ‚âà‚ü® general-powers 100 auto ‚ü©
    (S ‚Ä¢ H) ^ 3 ‚Ä¢ H ^ 3 ‚Ä¢ S ^ 2 ‚âà‚ü® trans (cong (axiom order-SH) refl) left-unit ‚ü©
    H ^ 3 ‚Ä¢ S ^ 2 ‚àé

  lemma-HSH : H ‚Ä¢ S ‚Ä¢ H ‚âà S ^ 2 ‚Ä¢ H ^ 3 ‚Ä¢ S ^ 2
  lemma-HSH = begin
    H ‚Ä¢ S ‚Ä¢ H ‚âà‚ü® general-powers 100 auto ‚ü©
    S ^ 2 ‚Ä¢ (S ‚Ä¢ H) ^ 3 ‚Ä¢ H ^ 3 ‚Ä¢ S ^ 2 ‚âà‚ü® cong refl (trans (cong (axiom order-SH) refl) left-unit) ‚ü©
    S ^ 2 ‚Ä¢ H ^ 3 ‚Ä¢ S ^ 2 ‚âà‚ü® general-powers 100 auto ‚ü©
    S ^ 2 ‚Ä¢ H ^ 3 ‚Ä¢ S ^ 2 ‚àé

  lemma-HSHS : H ‚Ä¢ S ‚Ä¢ H ‚Ä¢ S ‚âà S ^ 2 ‚Ä¢ H ^ 3
  lemma-HSHS = begin
    H ‚Ä¢ S ‚Ä¢ H ‚Ä¢ S ‚âà‚ü® general-powers 100 auto ‚ü©
    S ^ 2 ‚Ä¢ (S ‚Ä¢ H) ^ 3 ‚Ä¢ H ^ 3 ‚âà‚ü® cong refl (trans (cong (axiom order-SH) refl) left-unit) ‚ü©
    S ^ 2 ‚Ä¢ H ^ 3 ‚âà‚ü® general-powers 100 auto ‚ü©
    S ^ 2 ‚Ä¢ H ^ 3 ‚àé

  lemma-SHSHS : S ‚Ä¢ H ‚Ä¢ S ‚Ä¢ H ‚Ä¢ S ‚âà H ^ 3
  lemma-SHSHS = begin
    S ‚Ä¢ H ‚Ä¢ S ‚Ä¢ H ‚Ä¢ S ‚âà‚ü® general-powers 100 auto ‚ü©
    (S ‚Ä¢ H) ^ 3 ‚Ä¢ H ^ 3 ‚âà‚ü® trans (cong (axiom order-SH) refl) left-unit ‚ü©
    H ^ 3 ‚àé

  lemma-HSHSH : H ‚Ä¢ S ‚Ä¢ H ‚Ä¢ S ‚Ä¢ H ‚âà S ^ 2
  lemma-HSHSH = begin
    H ‚Ä¢ S ‚Ä¢ H ‚Ä¢ S ‚Ä¢ H ‚âà‚ü® general-powers 100 auto ‚ü©
    S ^ 2 ‚Ä¢ (S ‚Ä¢ H) ^ 3 ‚âà‚ü® cong refl (axiom order-SH) ‚ü©
    S ^ 2 ‚Ä¢ Œµ ‚âà‚ü® general-powers 100 auto ‚ü©
    S ^ 2 ‚àé

  lemma-SSH^6 : (S ‚Ä¢ S ‚Ä¢ H) ^ 6 ‚âà Œµ
  lemma-SSH^6 = begin
    (S ‚Ä¢ S ‚Ä¢ H) ^ 6 ‚âà‚ü® by-assoc auto ‚ü©
    S ‚Ä¢ (S ‚Ä¢ H ‚Ä¢ S) ‚Ä¢ (S ‚Ä¢ H ‚Ä¢ S) ‚Ä¢ (S ‚Ä¢ H ‚Ä¢ S) ‚Ä¢ (S ‚Ä¢ H ‚Ä¢ S) ‚Ä¢ (S ‚Ä¢ H ‚Ä¢ S) ‚Ä¢ S ‚Ä¢ H ‚âà‚ü® cong refl (cong lemma-SHS (cong lemma-SHS (cong lemma-SHS (cong lemma-SHS (cong lemma-SHS refl))))) ‚ü©
    S ‚Ä¢ (H ^ 3 ‚Ä¢ S ^ 2 ‚Ä¢ H ^ 3) ‚Ä¢ (H ^ 3 ‚Ä¢ S ^ 2 ‚Ä¢ H ^ 3) ‚Ä¢ (H ^ 3 ‚Ä¢ S ^ 2 ‚Ä¢ H ^ 3) ‚Ä¢ (H ^ 3 ‚Ä¢ S ^ 2 ‚Ä¢ H ^ 3) ‚Ä¢ (H ^ 3 ‚Ä¢ S ^ 2 ‚Ä¢ H ^ 3) ‚Ä¢ S ‚Ä¢ H ‚âà‚ü® general-powers 1000 auto ‚ü©
    S ‚Ä¢ H ‚Ä¢ (H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S) ‚Ä¢ (S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H) ‚Ä¢ S ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ S ‚Ä¢ H ^ 3 ‚Ä¢ S ‚Ä¢ H ‚âà‚ü® cong refl (cong refl (cong lemma-comm-HHSSHHS (cong (sym lemma-comm-HHSSHHS) refl))) ‚ü©
    S ‚Ä¢ H ‚Ä¢ (S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H) ‚Ä¢ (H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S) ‚Ä¢ S ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ S ‚Ä¢ H ^ 3 ‚Ä¢ S ‚Ä¢ H ‚âà‚ü® general-powers 1000 auto ‚ü©
    (S ‚Ä¢ H) ^ 3 ‚âà‚ü® axiom order-SH ‚ü©
    Œµ ‚àé

  lemma-SSH^3 : (S ‚Ä¢ S ‚Ä¢ H) ^ 3 ‚âà (H ^ 3 ‚Ä¢ S) ^ 3
  lemma-SSH^3 = begin
    (S ‚Ä¢ S ‚Ä¢ H) ^ 3 ‚âà‚ü® general-powers 100 auto ‚ü©
    (S ‚Ä¢ S ‚Ä¢ H) ^ 6 ‚Ä¢ (H ^ 3 ‚Ä¢ S) ^ 3 ‚âà‚ü® cong lemma-SSH^6 refl ‚ü©
    Œµ ‚Ä¢ (H ^ 3 ‚Ä¢ S) ^ 3 ‚âà‚ü® left-unit ‚ü©
    (H ^ 3 ‚Ä¢ S) ^ 3 ‚àé


  lemma-XZXXZZ : X ‚Ä¢ Z ‚Ä¢ X ^ 2 ‚Ä¢ Z ^ 2 ‚âà Œµ
  lemma-XZXXZZ = begin
    X ‚Ä¢ Z ‚Ä¢ X ^ 2 ‚Ä¢ Z ^ 2 ‚âà‚ü® cong refl (cong refl (cong lemma-def-XX lemma-def-ZZ)) ‚ü©
    (H ‚Ä¢ S ‚Ä¢ HH ‚Ä¢ SS ‚Ä¢ H) ‚Ä¢ (HH ‚Ä¢ S ‚Ä¢ HH ‚Ä¢ SS) ‚Ä¢ ((H ‚Ä¢ S ‚Ä¢ S ‚Ä¢ H) ‚Ä¢ (H ‚Ä¢ S ‚Ä¢ H)) ‚Ä¢ (HH ‚Ä¢ S ‚Ä¢ S ‚Ä¢ HH) ‚Ä¢ S ‚âà‚ü® by-assoc auto ‚ü©
    (H ‚Ä¢ S ‚Ä¢ HH ‚Ä¢ SS ‚Ä¢ H ‚Ä¢ HH ‚Ä¢ S ‚Ä¢ HH ‚Ä¢ SS ‚Ä¢ H ‚Ä¢ S ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ H) ‚Ä¢ (H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S) ‚âà‚ü® cong refl lemma-comm-HHSSHHS ‚ü©
    (H ‚Ä¢ S ‚Ä¢ HH ‚Ä¢ SS ‚Ä¢ H ‚Ä¢ HH ‚Ä¢ S ‚Ä¢ HH ‚Ä¢ SS ‚Ä¢ H ‚Ä¢ S ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ H) ‚Ä¢ (S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H) ‚âà‚ü® by-assoc auto ‚ü©
    (H ‚Ä¢ S ‚Ä¢ HH ‚Ä¢ SS ‚Ä¢ H ‚Ä¢ HH ‚Ä¢ S ‚Ä¢ HH ‚Ä¢ SS ‚Ä¢ H ‚Ä¢ S ‚Ä¢ S ‚Ä¢ H) ‚Ä¢ (H ‚Ä¢ S ‚Ä¢ H ‚Ä¢ S ‚Ä¢ H) ‚Ä¢ H ‚Ä¢ S ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H ‚âà‚ü® cong refl (cong lemma-HSHSH refl) ‚ü©
    (H ‚Ä¢ S ‚Ä¢ HH ‚Ä¢ SS ‚Ä¢ H ‚Ä¢ HH ‚Ä¢ S ‚Ä¢ HH ‚Ä¢ SS ‚Ä¢ H ‚Ä¢ S ‚Ä¢ S ‚Ä¢ H) ‚Ä¢ (S ‚Ä¢ S) ‚Ä¢ H ‚Ä¢ S ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H ‚âà‚ü® general-powers 100 auto ‚ü©
    (H ‚Ä¢ S ‚Ä¢ HH ‚Ä¢ SS ‚Ä¢ H ‚Ä¢ HH ‚Ä¢ S ‚Ä¢ HH ‚Ä¢ SS ‚Ä¢ H) ‚Ä¢ (S ‚Ä¢ S ‚Ä¢ H) ^ 3 ‚Ä¢ H ‚âà‚ü® cong refl (cong lemma-SSH^3 refl) ‚ü©
    (H ‚Ä¢ S ‚Ä¢ HH ‚Ä¢ SS ‚Ä¢ H ‚Ä¢ HH ‚Ä¢ S ‚Ä¢ HH ‚Ä¢ SS ‚Ä¢ H) ‚Ä¢ (H ^ 3 ‚Ä¢ S) ^ 3 ‚Ä¢ H ‚âà‚ü® general-powers 100 auto ‚ü©
    (H ‚Ä¢ S ‚Ä¢ HH ‚Ä¢ SS ‚Ä¢ H ‚Ä¢ HH ‚Ä¢ S ‚Ä¢ H ‚Ä¢ S) ‚Ä¢ (H ^ 3 ‚Ä¢ S) ‚Ä¢ H ‚âà‚ü® by-assoc auto ‚ü©
    (H ‚Ä¢ S ‚Ä¢ HH ‚Ä¢ SS ‚Ä¢ H ‚Ä¢ HH) ‚Ä¢ (S ‚Ä¢ H ‚Ä¢ S ‚Ä¢ H) ‚Ä¢ H ^ 2 ‚Ä¢ S ‚Ä¢ H ‚âà‚ü® cong refl (cong lemma-SHSH refl) ‚ü©
    (H ‚Ä¢ S ‚Ä¢ HH ‚Ä¢ SS ‚Ä¢ H ‚Ä¢ HH) ‚Ä¢ (H ^ 3 ‚Ä¢ S ^ 2) ‚Ä¢ H ^ 2 ‚Ä¢ S ‚Ä¢ H ‚âà‚ü® general-powers 1000 auto ‚ü©
    H ‚Ä¢ (S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H) ‚Ä¢ S ^ 2 ‚Ä¢ H ^ 2 ‚Ä¢ S ‚Ä¢ H ‚âà‚ü® cong refl (sym (cong lemma-comm-HHSSHHS refl)) ‚ü©
    H ‚Ä¢ (H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S) ‚Ä¢ S ^ 2 ‚Ä¢ H ^ 2 ‚Ä¢ S ‚Ä¢ H ‚âà‚ü®  general-powers 1000 auto ‚ü©
    Œµ ‚àé

  lemma-conj-X-S : X ‚Ä¢ S ‚âà (S ‚Ä¢ Z ‚Ä¢ Z) ‚Ä¢ X
  lemma-conj-X-S = begin
    X ‚Ä¢ S ‚âà‚ü® by-assoc auto ‚ü©
    H ‚Ä¢ (S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ S ‚Ä¢ H ‚Ä¢ S) ‚âà‚ü® general-powers 100 auto ‚ü©
    H ‚Ä¢ (S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H) ‚Ä¢ (H ^ 3 ‚Ä¢ S) ‚âà‚ü® cong refl (sym (cong lemma-comm-HHSSHHS refl)) ‚ü©
    H ‚Ä¢ (H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S) ‚Ä¢ (H ^ 3 ‚Ä¢ S) ‚âà‚ü® general-powers 100 auto ‚ü©
    (H ^ 3 ‚Ä¢ S ^ 2) ‚Ä¢ H ^ 2 ‚Ä¢ S ‚Ä¢ (H ^ 3 ‚Ä¢ S) ‚âà‚ü® (sym (cong lemma-SHSH refl)) ‚ü©
    (S ‚Ä¢ H ‚Ä¢ S ‚Ä¢ H) ‚Ä¢ H ^ 2 ‚Ä¢ S ‚Ä¢ (H ^ 3 ‚Ä¢ S) ‚âà‚ü® general-powers 100 auto ‚ü©
    (S ‚Ä¢ H ‚Ä¢ H) ‚Ä¢ (H ^ 3 ‚Ä¢ S) ^ 3 ‚âà‚ü® cong refl (sym lemma-SSH^3) ‚ü©
    (S ‚Ä¢ H ‚Ä¢ H) ‚Ä¢ (S ‚Ä¢ S ‚Ä¢ H) ^ 3 ‚âà‚ü® by-assoc auto ‚ü©
    S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ S ‚Ä¢ H ‚Ä¢ S ‚Ä¢ S ‚Ä¢ H ‚Ä¢ S ‚Ä¢ S ‚Ä¢ H ‚âà‚ü® by-assoc auto ‚ü©
    Œµ ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ S ‚Ä¢ H ‚Ä¢ S ^ 2 ‚Ä¢ H ‚Ä¢ SS ‚Ä¢ H ‚âà‚ü® (sym (cong (axiom order-H) refl)) ‚ü©
    H ^ 4 ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ S ‚Ä¢ H ‚Ä¢ S ^ 2 ‚Ä¢ H ‚Ä¢ SS ‚Ä¢ H ‚âà‚ü® by-assoc auto ‚ü©
    (H ‚Ä¢ H) ‚Ä¢ (H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S) ‚Ä¢ S ‚Ä¢ H ‚Ä¢ S ^ 2 ‚Ä¢ H ‚Ä¢ SS ‚Ä¢ H ‚âà‚ü® cong refl (_‚âà_.cong (_‚âà_.axiom comm-HHSHHS) _‚âà_.refl) ‚ü©
    (H ‚Ä¢ H) ‚Ä¢ (S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H) ‚Ä¢ S ‚Ä¢ H ‚Ä¢ S ^ 2 ‚Ä¢ H ‚Ä¢ SS ‚Ä¢ H ‚âà‚ü® by-assoc auto ‚ü©
    (H ‚Ä¢ H ‚Ä¢ S) ‚Ä¢ (H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S) ‚Ä¢ H ‚Ä¢ S ^ 2 ‚Ä¢ H ‚Ä¢ SS ‚Ä¢ H ‚âà‚ü® cong refl (_‚âà_.cong (_‚âà_.axiom comm-HHSHHS) _‚âà_.refl) ‚ü©
    (H ‚Ä¢ H ‚Ä¢ S) ‚Ä¢ (S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H) ‚Ä¢ H ‚Ä¢ S ^ 2 ‚Ä¢ H ‚Ä¢ SS ‚Ä¢ H ‚âà‚ü® by-assoc auto ‚ü©
    (H ‚Ä¢ H ‚Ä¢ SS ‚Ä¢ HH ‚Ä¢ S) ‚Ä¢ (H ^ 3 ‚Ä¢ S ^ 2) ‚Ä¢ H ‚Ä¢ SS ‚Ä¢ H ‚âà‚ü® general-powers 100 auto ‚ü©
    (H ‚Ä¢ H ‚Ä¢ SS ‚Ä¢ HH ‚Ä¢ S) ‚Ä¢ (H ^ 3 ‚Ä¢ S ^ 2) ‚Ä¢ H ‚Ä¢ SS ‚Ä¢ H ‚âà‚ü® cong refl (sym (cong lemma-SH^2 refl)) ‚ü©
    (H ‚Ä¢ H ‚Ä¢ SS ‚Ä¢ HH ‚Ä¢ S) ‚Ä¢ ((S ‚Ä¢ H) ^ 2) ‚Ä¢ H ‚Ä¢ SS ‚Ä¢ H ‚âà‚ü® by-assoc auto ‚ü©
    (H ‚Ä¢ H ‚Ä¢ S) ‚Ä¢ Œµ ‚Ä¢ S ‚Ä¢ HH ‚Ä¢ SS ‚Ä¢ H ‚Ä¢ S ‚Ä¢ HH ‚Ä¢ SS ‚Ä¢ H ‚âà‚ü® cong refl (_‚âà_.sym (_‚âà_.cong (_‚âà_.axiom order-H) _‚âà_.refl)) ‚ü©
    (H ‚Ä¢ H ‚Ä¢ S) ‚Ä¢ H ^ 4 ‚Ä¢ S ‚Ä¢ HH ‚Ä¢ SS ‚Ä¢ H ‚Ä¢ S ‚Ä¢ HH ‚Ä¢ SS ‚Ä¢ H ‚âà‚ü® by-assoc auto ‚ü©
    (H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H) ‚Ä¢ Œµ ‚Ä¢ HH ‚Ä¢ S ‚Ä¢ HH ‚Ä¢ SS ‚Ä¢ H ‚Ä¢ S ‚Ä¢ HH ‚Ä¢ SS ‚Ä¢ H ‚âà‚ü® cong refl (_‚âà_.sym (_‚âà_.cong (_‚âà_.axiom order-S) _‚âà_.refl)) ‚ü©
    (H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H) ‚Ä¢ S ^ 3 ‚Ä¢ HH ‚Ä¢ S ‚Ä¢ HH ‚Ä¢ SS ‚Ä¢ H ‚Ä¢ S ‚Ä¢ HH ‚Ä¢ SS ‚Ä¢ H ‚âà‚ü® by-assoc auto ‚ü©
    (H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S) ‚Ä¢ SS ‚Ä¢ HH ‚Ä¢ S ‚Ä¢ HH ‚Ä¢ SS ‚Ä¢ H ‚Ä¢ S ‚Ä¢ HH ‚Ä¢ SS ‚Ä¢ H ‚âà‚ü® (_‚âà_.cong (_‚âà_.axiom comm-HHSHHS) _‚âà_.refl) ‚ü©
    (S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H) ‚Ä¢ SS ‚Ä¢ HH ‚Ä¢ S ‚Ä¢ HH ‚Ä¢ SS ‚Ä¢ H ‚Ä¢ S ‚Ä¢ HH ‚Ä¢ SS ‚Ä¢ H ‚âà‚ü® by-assoc auto ‚ü©
    S ‚Ä¢ HH ‚Ä¢ S ‚Ä¢ HH ‚Ä¢ SS ‚Ä¢ HH ‚Ä¢ S ‚Ä¢ HH ‚Ä¢ SS ‚Ä¢ H ‚Ä¢ S ‚Ä¢ HH ‚Ä¢ SS ‚Ä¢ H ‚âà‚ü® by-assoc auto ‚ü©
    (S ‚Ä¢ Z ‚Ä¢ Z) ‚Ä¢ X ‚àé

  lemma-conj-X-Z : X ‚Ä¢ Z ‚âà (Z) ‚Ä¢ X
  lemma-conj-X-Z = begin
    X ‚Ä¢ Z ‚âà‚ü® by-assoc auto ‚ü©
    X ‚Ä¢ Z ‚Ä¢ Œµ ‚âà‚ü® cong refl (sym (cong refl lemma-order-X)) ‚ü©
    X ‚Ä¢ Z ‚Ä¢ X ^ 2 ‚Ä¢ X ‚âà‚ü® by-assoc auto ‚ü©
    (X ‚Ä¢ Z ‚Ä¢ X ^ 2) ‚Ä¢ Œµ ‚Ä¢ X ‚âà‚ü® cong refl (cong (sym lemma-order-Z) refl) ‚ü©
    (X ‚Ä¢ Z ‚Ä¢ X ^ 2) ‚Ä¢ (Z ^ 2 ‚Ä¢ Z) ‚Ä¢ X ‚âà‚ü® by-assoc auto ‚ü©
    ((X ‚Ä¢ Z ‚Ä¢ X ^ 2 ‚Ä¢ Z ^ 2) ‚Ä¢ Z) ‚Ä¢ X ‚âà‚ü®  cong (trans (cong lemma-XZXXZZ refl) left-unit) refl ‚ü©
    Z ‚Ä¢ X ‚àé

  lemma-X^3 : X ^ 3 ‚âà Œµ
  lemma-X^3 = begin
    X ^ 3 ‚âà‚ü® sym assoc ‚ü©
    X ^ 2 ‚Ä¢ X ‚âà‚ü® lemma-order-X ‚ü©
    Œµ ‚àé

  lemma-HX : H ‚Ä¢ X ‚âà Z ‚Ä¢ H
  lemma-HX = begin
    H ‚Ä¢ X ‚âà‚ü® by-assoc auto ‚ü©
    Z ‚Ä¢ H ‚àé

  lemma-HSSH : (H ‚Ä¢ S ‚Ä¢ S) ‚Ä¢ H ‚âà (S ‚Ä¢ Z ‚Ä¢ X ‚Ä¢ X) ‚Ä¢ H ‚Ä¢ S
  lemma-HSSH = begin
    (H ‚Ä¢ S ‚Ä¢ S) ‚Ä¢ H ‚âà‚ü® general-powers 100 auto ‚ü©
    (H) ‚Ä¢ (S ^ 2) ‚Ä¢ H ‚âà‚ü® cong refl (sym (cong lemma-HSHSH refl)) ‚ü©
    (H) ‚Ä¢ (H ‚Ä¢ S ‚Ä¢ H ‚Ä¢ S ‚Ä¢ H) ‚Ä¢ H ‚âà‚ü® general-powers 100 auto ‚ü©
    (S ‚Ä¢ H ‚Ä¢ H) ‚Ä¢ (H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S) ‚Ä¢ H ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H ‚âà‚ü® cong refl (cong lemma-comm-HHSSHHS refl ) ‚ü©
    (S ‚Ä¢ H ‚Ä¢ H) ‚Ä¢ (S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H) ‚Ä¢ H ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H ‚âà‚ü® general-powers 100 auto ‚ü©
    (S) ‚Ä¢ (H ‚Ä¢ X) ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H ‚âà‚ü® cong refl (cong lemma-HX refl) ‚ü©
    (S) ‚Ä¢ (Z ‚Ä¢ H) ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H ‚âà‚ü® general-powers 100 auto ‚ü©
    (S ‚Ä¢ Z ‚Ä¢ H ‚Ä¢ S ‚Ä¢ S) ‚Ä¢ (S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H) ‚âà‚ü® cong refl (sym (axiom comm-HHSHHS)) ‚ü©
    (S ‚Ä¢ Z ‚Ä¢ H ‚Ä¢ S ‚Ä¢ S) ‚Ä¢ (H ‚Ä¢ H ‚Ä¢ S ‚Ä¢ H ‚Ä¢ H ‚Ä¢ S) ‚âà‚ü® general-powers 100 auto ‚ü©
    (S ‚Ä¢ Z) ‚Ä¢ ((H ‚Ä¢ S ‚Ä¢ S ‚Ä¢ H) ‚Ä¢ (H ‚Ä¢ S ‚Ä¢ H)) ‚Ä¢ H ‚Ä¢ S ‚âà‚ü® cong refl (cong (sym lemma-def-XX) refl) ‚ü©
    (S ‚Ä¢ Z) ‚Ä¢ (X ‚Ä¢ X) ‚Ä¢ H ‚Ä¢ S ‚âà‚ü® by-assoc auto ‚ü©
    (S ‚Ä¢ Z ‚Ä¢ X ‚Ä¢ X) ‚Ä¢ H ‚Ä¢ S ‚àé


  lemma-ZZS^3 : (Z ^ 2 ‚Ä¢ S) ^ 2 ‚Ä¢ Z ^ 2 ‚Ä¢ S ‚âà Œµ
  lemma-ZZS^3 = begin
    (Z ^ 2 ‚Ä¢ S) ^ 2 ‚Ä¢ Z ^ 2 ‚Ä¢ S ‚âà‚ü® by-assoc auto ‚ü©
    Z ‚Ä¢ (Z ‚Ä¢ S) ‚Ä¢ Z ^ 2 ‚Ä¢ S ‚Ä¢ Z ^ 2 ‚Ä¢ S ‚âà‚ü® cong refl (cong lemma-comm-Z-S refl) ‚ü©
    Z ‚Ä¢ (S ‚Ä¢ Z) ‚Ä¢ Z ^ 2 ‚Ä¢ S ‚Ä¢ Z ^ 2 ‚Ä¢ S ‚âà‚ü® by-assoc auto ‚ü©
    (Z ‚Ä¢ S) ‚Ä¢ (Z ^ 2 ‚Ä¢ Z) ‚Ä¢ S ‚Ä¢ Z ^ 2 ‚Ä¢ S ‚âà‚ü® cong refl (cong lemma-order-Z refl) ‚ü©
    (Z ‚Ä¢ S) ‚Ä¢ Œµ ‚Ä¢ S ‚Ä¢ Z ^ 2 ‚Ä¢ S ‚âà‚ü® by-assoc auto ‚ü©
    (Z ‚Ä¢ S ‚Ä¢ S ‚Ä¢ Z) ‚Ä¢ (Z ‚Ä¢ S) ‚âà‚ü® cong refl lemma-comm-Z-S ‚ü©
    (Z ‚Ä¢ S ‚Ä¢ S ‚Ä¢ Z) ‚Ä¢ (S ‚Ä¢ Z) ‚âà‚ü® by-assoc auto ‚ü©
    (Z ‚Ä¢ S ‚Ä¢ S) ‚Ä¢ (Z ‚Ä¢ S) ‚Ä¢ Z ‚âà‚ü® cong refl (cong lemma-comm-Z-S refl) ‚ü©
    (Z ‚Ä¢ S ‚Ä¢ S) ‚Ä¢ (S ‚Ä¢ Z) ‚Ä¢ Z ‚âà‚ü® by-assoc auto ‚ü©
    Z ‚Ä¢ S ^ 3 ‚Ä¢ Z ‚Ä¢ Z ‚âà‚ü® cong refl (cong (axiom order-S) refl) ‚ü©
    Z ‚Ä¢ Œµ ‚Ä¢ Z ‚Ä¢ Z ‚âà‚ü® by-assoc auto ‚ü©
    Z ^ 2 ‚Ä¢ Z ‚âà‚ü® lemma-order-Z ‚ü©
    Œµ ‚àé



{-
module Iso where

  private
    variable
      n : ‚Ñï

  module Sym  = NSym.Symplectic
  module Sim  = Clifford-Relations
  open Sym renaming (Gen to Gen‚ÇÅ ; _QRel,_===_ to _QRel,_===‚ÇÅ_) using ()
  Gen‚ÇÇ = Gen‚ÇÅ
  open Sim renaming (_QRel,_===_ to _QRel,_===‚ÇÇ_) using ()
  open Symplectic-GroupLike renaming (grouplike to grouplike‚ÇÅ) using ()
  open Clifford-GroupLike renaming (grouplike to grouplike‚ÇÇ) using ()


  f-well-defined : let open PB (n QRel,_===‚ÇÇ_) renaming (_‚âà_ to _‚âà‚ÇÇ_) in
    ‚àÄ {w v} -> n QRel, w ===‚ÇÅ v -> id w ‚âà‚ÇÇ id v
  f-well-defined {n} order-S = PB.axiom Sim.order-S
  f-well-defined {‚ÇÅ‚Çä n} order-H = lemma-order-H
    where
    open Lemmas1 n
  f-well-defined {‚ÇÅ‚Çä n} order-SH = lemma-order-SH
    where
    open Lemmas1 n
  f-well-defined {‚ÇÅ‚Çä n} comm-HHS = lemma-comm-HHS
    where
    open Lemmas1b n
  f-well-defined {‚ÇÅ‚Çä n} (M-mul x y) = lemma-M-mul x y
    where
    open Lemmas1 n
  f-well-defined {‚ÇÅ‚Çä n} (semi-MS x) = lemma-semi-MS x
    where
    open Lemmas1 n
  f-well-defined {‚ÇÇ‚Çä n} (semi-M‚ÜëCZ x) = lemma-semi-M‚ÜëCZ x
    where
    open Lemmas2 n
  f-well-defined {‚ÇÇ‚Çä n} (semi-M‚ÜìCZ x) = lemma-semi-M‚ÜìCZ x
    where
    open Lemmas2 n
  f-well-defined {n} order-CZ = PB.axiom Sim.order-CZ
  f-well-defined {n} comm-CZ-S‚Üì = PB.axiom Sim.comm-CZ-S‚Üì
  f-well-defined {n} comm-CZ-S‚Üë = PB.axiom Sim.comm-CZ-S‚Üë
  f-well-defined {n} selinger-c10 = PB.axiom Sim.selinger-c10
  f-well-defined {n} selinger-c11 = PB.axiom Sim.selinger-c11
  f-well-defined {n} selinger-c12 = PB.axiom Sim.selinger-c12
  f-well-defined {n} selinger-c13 = PB.axiom Sim.selinger-c13
  f-well-defined {n} selinger-c14 = PB.axiom Sim.selinger-c14
  f-well-defined {n} selinger-c15 = PB.axiom Sim.selinger-c15
  f-well-defined {n} comm-H = PB.axiom Sim.comm-H
  f-well-defined {n} comm-S = PB.axiom Sim.comm-S
  f-well-defined {n} comm-CZ = PB.axiom Sim.comm-CZ
  f-well-defined {n} (cong‚Üë eq) = lemma-cong‚Üë _ _ (f-well-defined eq)
    where
    open Lemmas-Clifford
  
  g-well-defined : let open PB (n QRel,_===‚ÇÅ_) renaming (_‚âà_ to _‚âà‚ÇÅ_) in
    ‚àÄ {u t} -> n QRel, u ===‚ÇÇ t -> id u ‚âà‚ÇÅ id t
  g-well-defined Sim.order-S = PB.axiom _QRel,_===‚ÇÅ_.order-S
  g-well-defined {‚ÇÅ‚Çä n} Sim.order-H = lemma-HH-M-1
    where
    open Lemmas0 n
  g-well-defined {‚ÇÅ‚Çä n} (Sim.M-power k) = begin
    (Mg^ k) ‚â°‚ü® auto ‚ü©
    Mg ^ to‚Ñï k ‚âà‚ü® lemma-^-cong (Mg) (M g‚Ä≤) (to‚Ñï k) (refl) ‚ü©
    M g‚Ä≤ ^ to‚Ñï k ‚âà‚ü® lemma-M-power g‚Ä≤ (to‚Ñï k) ‚ü©
    M (g^ k) ‚âà‚ü® refl ‚ü©
    (M (g^ k)) ‚àé
    where
    open PB ((‚ÇÅ‚Çä n) QRel,_===‚ÇÅ_)
    open PP ((‚ÇÅ‚Çä n) QRel,_===‚ÇÅ_)
    open SR word-setoid
    open Lemmas0 n
    open Sim

    
  g-well-defined {‚ÇÅ‚Çä n} Sim.semi-MS = PB.axiom (_QRel,_===‚ÇÅ_.semi-MS ((g , g‚â†0)))
  g-well-defined Sim.semi-M‚ÜëCZ = PB.axiom (_QRel,_===‚ÇÅ_.semi-M‚ÜëCZ ((g , g‚â†0)))
  g-well-defined Sim.semi-M‚ÜìCZ = PB.axiom (_QRel,_===‚ÇÅ_.semi-M‚ÜìCZ ((g , g‚â†0)))
  g-well-defined Sim.order-CZ = PB.axiom _QRel,_===‚ÇÅ_.order-CZ
  g-well-defined Sim.comm-CZ-S‚Üì = PB.axiom _QRel,_===‚ÇÅ_.comm-CZ-S‚Üì
  g-well-defined Sim.comm-CZ-S‚Üë = PB.axiom _QRel,_===‚ÇÅ_.comm-CZ-S‚Üë
  g-well-defined Sim.selinger-c10 = PB.axiom _QRel,_===‚ÇÅ_.selinger-c10
  g-well-defined Sim.selinger-c11 = PB.axiom _QRel,_===‚ÇÅ_.selinger-c11
  g-well-defined Sim.selinger-c12 = PB.axiom _QRel,_===‚ÇÅ_.selinger-c12
  g-well-defined Sim.selinger-c13 = PB.axiom _QRel,_===‚ÇÅ_.selinger-c13
  g-well-defined Sim.selinger-c14 = PB.axiom _QRel,_===‚ÇÅ_.selinger-c14
  g-well-defined Sim.selinger-c15 = PB.axiom _QRel,_===‚ÇÅ_.selinger-c15
  g-well-defined Sim.comm-H = PB.axiom _QRel,_===‚ÇÅ_.comm-H
  g-well-defined Sim.comm-S = PB.axiom _QRel,_===‚ÇÅ_.comm-S
  g-well-defined Sim.comm-CZ = PB.axiom _QRel,_===‚ÇÅ_.comm-CZ
  g-well-defined (Sim.cong‚Üë eq) = lemma-cong‚Üë _ _ (g-well-defined eq)
    where
    open Lemmas-Sym


  open import Algebra.Bundles using (Group)
  open import Algebra.Morphism.Structures using (module GroupMorphisms)

  open GroupMorphisms


  Theorem-Sym-iso-Sim : ‚àÄ {n} ->
    let
    module G1 = Group-Lemmas (Gen‚ÇÅ n) (n QRel,_===‚ÇÅ_) grouplike‚ÇÅ
    module G2 = Group-Lemmas (Gen‚ÇÇ n) (n QRel,_===‚ÇÇ_) grouplike‚ÇÇ
    in
    IsGroupIsomorphism (Group.rawGroup G1.‚Ä¢-Œµ-group) (Group.rawGroup G2.‚Ä¢-Œµ-group) id
  Theorem-Sym-iso-Sim {n}  = StarGroupIsomorphism.isGroupIsomorphism f-well-defined g-well-defined
    where
    open import Presentation.MorphismId (n QRel,_===‚ÇÅ_) (n QRel,_===‚ÇÇ_)
    open GroupMorphs (grouplike‚ÇÅ {n}) (grouplike‚ÇÇ {n})



  Theorem-Sym-iso-Sim' : ‚àÄ {n} ->
    let
    module G1 = Group-Lemmas (Gen‚ÇÅ n) (n QRel,_===‚ÇÅ_) grouplike‚ÇÅ
    module G2 = Group-Lemmas (Gen‚ÇÇ n) (n QRel,_===‚ÇÇ_) grouplike‚ÇÇ
    in
    IsGroupIsomorphism (Group.rawGroup G2.‚Ä¢-Œµ-group) (Group.rawGroup G1.‚Ä¢-Œµ-group)  id
  Theorem-Sym-iso-Sim' {n} = StarGroupIsomorphism.isGroupIsomorphism g-well-defined f-well-defined
    where
    open import Presentation.MorphismId  (n QRel,_===‚ÇÇ_) (n QRel,_===‚ÇÅ_)
    open GroupMorphs (grouplike‚ÇÇ {n}) (grouplike‚ÇÅ {n}) 

-}
-}
